<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"novav.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Simon Shi的小站">
<meta property="og:url" content="https://novav.github.io/page/16/index.html">
<meta property="og:site_name" content="Simon Shi的小站">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Simon Shi">
<meta property="article:tag" content="AI,Machine Learning, Deep Learning">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://novav.github.io/page/16/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Simon Shi的小站</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Simon Shi的小站</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">人工智能，机器学习， 强化学习，大模型，自动驾驶</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://novav.github.io/2022/05/23/Tools/Tools_conda/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Simon Shi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Simon Shi的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/23/Tools/Tools_conda/" class="post-title-link" itemprop="url">Conda 常用命令手册</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-23 12:09:09" itemprop="dateCreated datePublished" datetime="2022-05-23T12:09:09+00:00">2022-05-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-06 08:16:40" itemprop="dateModified" datetime="2025-08-06T08:16:40+00:00">2025-08-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/dev/" itemprop="url" rel="index"><span itemprop="name">dev</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/dev/conda/" itemprop="url" rel="index"><span itemprop="name">conda</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Env-创建"><a href="#Env-创建" class="headerlink" title="Env 创建"></a>Env 创建</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">conda create -n XXX python=3.8</span><br><span class="line">conda create -n XXX --<span class="built_in">clone</span> oldXXX</span><br><span class="line">conda remove -n oldXXX --all</span><br></pre></td></tr></table></figure>

<p>修改环境名字</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">直接修改conda环境下的目录名即可</span><br><span class="line"><span class="comment"># conda environments:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">base                     /root/anaconda3</span><br><span class="line">torch_1.4.0_cu100        /root/anaconda3/envs/torch_1.4.0_cu100</span><br><span class="line">torch_1.4.1                 /root/anaconda3/envs/torch_1.4.1</span><br></pre></td></tr></table></figure>

<h2 id="一、镜像"><a href="#一、镜像" class="headerlink" title="一、镜像"></a>一、镜像</h2><h3 id="1-镜像源添加方法"><a href="#1-镜像源添加方法" class="headerlink" title="1.镜像源添加方法"></a>1.镜像源添加方法</h3><p>首先是一些常用命令，帮你诊断目前你的conda源的情况，如果是新装的conda，可以不用管。<br>第一步：查看并还原默认镜像源</p>
<h4 id="1-1-首先，看一下目前conda源都有哪些内容"><a href="#1-1-首先，看一下目前conda源都有哪些内容" class="headerlink" title="1.1 首先，看一下目前conda源都有哪些内容"></a>1.1 首先，看一下目前conda源都有哪些内容</h4><p>conda info</p>
<h4 id="1-2-然后，删除并恢复默认的conda源"><a href="#1-2-然后，删除并恢复默认的conda源" class="headerlink" title="1.2 然后，删除并恢复默认的conda源"></a>1.2 然后，删除并恢复默认的conda源</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda config --remove-key channels </span><br></pre></td></tr></table></figure>

<p>下面是几个常用命令：后面会用到，这里不用管</p>
<h4 id="1-3-添加指定源"><a href="#1-3-添加指定源" class="headerlink" title="1.3 添加指定源"></a>1.3 添加指定源</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda config --add channels *（*指代你要添加的源）</span><br></pre></td></tr></table></figure>

<h4 id="1-4-设置安装包时，显示镜像来源，建议显示"><a href="#1-4-设置安装包时，显示镜像来源，建议显示" class="headerlink" title="1.4 设置安装包时，显示镜像来源，建议显示"></a>1.4 设置安装包时，显示镜像来源，建议显示</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda config --<span class="built_in">set</span> show_channel_urls <span class="built_in">yes</span> </span><br></pre></td></tr></table></figure>

<h4 id="1-5-删除指定源"><a href="#1-5-删除指定源" class="headerlink" title="1.5 删除指定源"></a>1.5 删除指定源</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda config --remove channels *(*代表你要删除的源）</span><br></pre></td></tr></table></figure>

<h3 id="2-找到你要用的源"><a href="#2-找到你要用的源" class="headerlink" title="2.找到你要用的源"></a>2.找到你要用的源</h3><p>首先，我们进入国内几家镜像源的网站（这里以清华园为例，基本上可以涵盖所有镜像）<br>清华镜像源 一般够用 ：<a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/">https://mirrors.tuna.tsinghua.edu.cn/</a></p>
<p>中科大源<a target="_blank" rel="noopener" href="https://mirrors.ustc.edu.cn/">https://mirrors.ustc.edu.cn/</a></p>
<p>常用的其他源汇总</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#为了方便大家快速添加，我们把conda自身默认的镜像源的替换代码，写好放在这里，方便大家直接替换使用，大家逐条复制添加即可，下述链接更新时间为2022.3.10，可以通过前面的方法先判断一下镜像源对不对：</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r/</span><br><span class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/</span><br><span class="line">conda config --set show_channel_urls yes</span><br></pre></td></tr></table></figure>

<h2 id="二、Conda-Env环境（linux"><a href="#二、Conda-Env环境（linux" class="headerlink" title="二、Conda Env环境（linux)"></a>二、Conda Env环境（linux)</h2><h3 id="环境备份"><a href="#环境备份" class="headerlink" title="环境备份"></a>环境备份</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">路径：&lt;user home&gt;/.conda/envs/</span><br><span class="line"></span><br><span class="line">导出环境备份：</span><br><span class="line">conda env export --name your_env_name &gt; environment.yml</span><br><span class="line"></span><br><span class="line">导出环境备份（批量）：</span><br><span class="line">for env in $(conda env list | awk &#x27;&#123;print $1&#125;&#x27; | tail -n +3); do conda env export --name $env &gt; ~/.conda/envs/$env.yml; done</span><br><span class="line"></span><br><span class="line">重建环境</span><br><span class="line">conda env create -f environment.yml</span><br></pre></td></tr></table></figure>

<h3 id="2-2-在Linux环境下修改Anaconda的默认虚拟环境安装位置"><a href="#2-2-在Linux环境下修改Anaconda的默认虚拟环境安装位置" class="headerlink" title="2.2  在Linux环境下修改Anaconda的默认虚拟环境安装位置"></a>2.2  在Linux环境下修改Anaconda的默认虚拟环境安装位置</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1 check</span></span><br><span class="line">conda info</span><br><span class="line"></span><br><span class="line">package cache : /home/sxw/anaconda3/pkgs</span><br><span class="line">                /home/sxw/.conda/pkgs</span><br><span class="line">envs directories : /home/sxw/anaconda3/envs</span><br><span class="line">                   /home/sxw/.conda/envs</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2 change</span></span><br><span class="line">conda config --add envs_dirs /home/username/Software/anaconda3/</span><br><span class="line">or </span><br><span class="line">sudo vim ~/.condarc</span><br><span class="line">   pkgs_dirs:</span><br><span class="line">     - /dataraid/apps/appdata/pkgs</span><br><span class="line">   envs_dirs:</span><br><span class="line">     - /dataraid/apps/appdata/envs</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4 check</span></span><br></pre></td></tr></table></figure>

<h4 id="Windows-Env-配置"><a href="#Windows-Env-配置" class="headerlink" title="Windows Env 配置"></a>Windows Env 配置</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">channels:</span><br><span class="line">  - https://mirrors.aliyun.com/anaconda/miniconda/</span><br><span class="line">  - defaults</span><br><span class="line">  - https://mirrors.ustc.edu.cn/anaconda/pkgs/main/</span><br><span class="line">  - https://mirrors.ustc.edu.cn/anaconda/pkgs/free/</span><br><span class="line">  - https://mirrors.ustc.edu.cn/anaconda/cloud/conda-forge/</span><br><span class="line">  - https://mirrors.ustc.edu.cn/anaconda/cloud/pytorch/</span><br><span class="line">ssl_verify: true</span><br><span class="line">envs_dirs:</span><br><span class="line">- D:\AppData\Anaconda\envs</span><br><span class="line">pkgs_dirs:</span><br><span class="line">- D:\AppData\Anaconda\pkgs</span><br></pre></td></tr></table></figure>

<h2 id="三、PIP镜像"><a href="#三、PIP镜像" class="headerlink" title="三、PIP镜像"></a>三、PIP镜像</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure>

<h3 id="1、永久使用pip源-此时，我们可以把源改为清华源，具体操作如下："><a href="#1、永久使用pip源-此时，我们可以把源改为清华源，具体操作如下：" class="headerlink" title="1、永久使用pip源 此时，我们可以把源改为清华源，具体操作如下："></a>1、永久使用pip源 此时，我们可以把源改为清华源，具体操作如下：</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure>

<p>如果set多次，似乎只能保存最后一次set的镜像源。</p>
<h3 id="2、临时更换pip源-如果仅是临时更换可以使用以下命令"><a href="#2、临时更换pip源-如果仅是临时更换可以使用以下命令" class="headerlink" title="2、临时更换pip源 如果仅是临时更换可以使用以下命令"></a>2、临时更换pip源 如果仅是临时更换可以使用以下命令</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pip install -r requirement.txt</span><br><span class="line">pip install torch -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line">pip install torch -i http://mirrors.aliyun.com/pypi/simple/</span><br><span class="line"></span><br><span class="line">此时，我们再用pip安装软件就会比较快了</span><br></pre></td></tr></table></figure>

<h3 id="3、查看pip源"><a href="#3、查看pip源" class="headerlink" title="3、查看pip源"></a>3、查看pip源</h3><p>pip config list </p>
<h3 id="4、删除pip源"><a href="#4、删除pip源" class="headerlink" title="4、删除pip源"></a>4、删除pip源</h3><p> pip config unset global.index-url </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">[global]</span><br><span class="line">no-cache-dir = true</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">index-url = https://pypi.org/simple</span></span><br><span class="line">index-url = https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line">            </span><br><span class="line">extra-index-url =</span><br><span class="line">                  https://pypi.ngc.nvidia.com</span><br><span class="line">trusted-host = mirrors.aliyun.com</span><br><span class="line">               pypi.ngc.nvidia.com</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[global]</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">index-url = http://mirrors.aliyun.com/pypi/simple/</span></span><br><span class="line">trusted-host = mirrors.aliyun.com</span><br><span class="line">               pypi.ngc.nvidia.com</span><br><span class="line">no-cache-dir = true</span><br><span class="line">extra-index-url =</span><br><span class="line">                  https://pypi.ngc.nvidia.com</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root@ubuntu8125:~# pip config list</span><br><span class="line">            global.extra-index-url=&#x27;\nhttps://pypi.ngc.nvidia.com&#x27;</span><br><span class="line">            global.index-url=&#x27;https://pypi.org/simple&#x27;</span><br><span class="line">            global.no-cache-dir=&#x27;true&#x27;</span><br><span class="line">            global.trusted-host=&#x27;\npypi.ngc.nvidia.com&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/etc/pip.conf</span><br><span class="line"></span><br><span class="line">    [global]</span><br><span class="line">    no-cache-dir = true</span><br><span class="line">    # index-url = https://pypi.org/simple</span><br><span class="line">    index-url = http://mirrors.aliyun.com/pypi/simple/</span><br><span class="line">    extra-index-url = https://pypi.ngc.nvidia.com</span><br><span class="line">    trusted-host = mirrors.aliyun.com</span><br><span class="line">                   pypi.ngc.nvidia.com</span><br><span class="line"></span><br><span class="line">/root/.pip/pip.conf</span><br><span class="line"></span><br><span class="line">/root/anaconda3/pip.conf</span><br><span class="line"></span><br><span class="line">    [global]</span><br><span class="line">    #index-url = http://mirrors.aliyun.com/pypi/simple/</span><br><span class="line">    trusted-host = mirrors.aliyun.com</span><br><span class="line">                   pypi.ngc.nvidia.com</span><br><span class="line">    no-cache-dir = true</span><br><span class="line">    extra-index-url =</span><br><span class="line">                  https://pypi.ngc.nvidia.com</span><br></pre></td></tr></table></figure>

<h3 id="Pip多个源头："><a href="#Pip多个源头：" class="headerlink" title="Pip多个源头："></a>Pip多个源头：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">no-cache-dir = <span class="literal">true</span></span><br><span class="line">extra-index-url =</span><br><span class="line">        https://pypi.ngc.nvidia.com </span><br><span class="line">        https://mirrors.aliyun.com/pypi/simple</span><br><span class="line">trusted-host =</span><br><span class="line">        pypi.ngc.nvidia.com mirrors.aliyun.com</span><br><span class="line">index-url = </span><br><span class="line">        https://pypi.org/simple</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://novav.github.io/2022/05/21/AI/RL/RL_DQN/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Simon Shi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Simon Shi的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/21/AI/RL/RL_DQN/" class="post-title-link" itemprop="url">RL - DQN 理论etc</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-21 00:00:00" itemprop="dateCreated datePublished" datetime="2022-05-21T00:00:00+00:00">2022-05-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-06 08:16:38" itemprop="dateModified" datetime="2025-08-06T08:16:38+00:00">2025-08-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AI/" itemprop="url" rel="index"><span itemprop="name">AI</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AI/RL/" itemprop="url" rel="index"><span itemprop="name">RL</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://shuyuan.hzmedia.com.cn/ebookrdr?uuid=378872d4-69a3-4208-958a-4bc3c48e0287_1&chapterid=1">book 深度强化学习：学术前沿 华章书院电子书</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/376737524">zhihu-Torch在倒立摆（CartPole）游戏中实现强化学习</a></p>
<ul>
<li>算法：DDQN、Duelling Network以及优先经验回放</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44018458/article/details/108038507">CSDN tensorflow2.0 实现 DQN</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_46133643/article/details/121845874">CSND 深度强化学习-DQN算法原理与代码</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_49708196/article/details/120099556">DDQN与DQN算法用tensorflow2.0实现</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/indigoLovee/DQN">github DQN Pytorch </a></p>
<p>一些讨论：</p>
<ul>
<li><p>GAN是RL理论的一种实现。</p>
</li>
<li><p>RL是一个理论框架，GAN是在RL理论上开发的一种模型训练方法，但GAN更高明的一点是，生成式的网络和判别网络互为Environment，而RL则定义了机器根据环境的奖励后改变模型，然后来决定下一步action，再得到奖励来改变模型。所以GAN可以看成是一种双向强化学习。</p>
</li>
<li><p>正强化学习有环境学策略，逆强化学习就是反过来学环境</p>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/110620815">三维可视化助你直观理解DQN算法[DQN理论篇] zhihu </a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://novav.github.io/2022/05/20/Sub_Language/DL_Train/Pytorch/inference_demo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Simon Shi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Simon Shi的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/20/Sub_Language/DL_Train/Pytorch/inference_demo/" class="post-title-link" itemprop="url">C++ 调用 Torch pt文件</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-20 13:00:00" itemprop="dateCreated datePublished" datetime="2022-05-20T13:00:00+00:00">2022-05-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-06 08:16:40" itemprop="dateModified" datetime="2025-08-06T08:16:40+00:00">2025-08-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/DNN-platform/" itemprop="url" rel="index"><span itemprop="name">DNN_platform</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/DNN-platform/pytorch/" itemprop="url" rel="index"><span itemprop="name">pytorch</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/DNN-platform/pytorch/c/" itemprop="url" rel="index"><span itemprop="name">c++</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>[TOC]</p>
<p>install </p>
<p><a target="_blank" rel="noopener" href="https://pytorch.org/get-started/previous-versions/">https://pytorch.org/get-started/previous-versions/</a></p>
<p><a target="_blank" rel="noopener" href="https://pytorch.org/tutorials/beginner/saving_loading_models.html#save-load-entire-model">https://pytorch.org/tutorials/beginner/saving_loading_models.html#save-load-entire-model</a></p>
<p>python库 <a target="_blank" rel="noopener" href="https://download.pytorch.org/whl/cu101/torch_stable.html">https://download.pytorch.org/whl/cu101/torch_stable.html</a></p>
<h3 id="example-app-cpp"><a href="#example-app-cpp" class="headerlink" title="example-app.cpp"></a>example-app.cpp</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;torch/torch.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  torch::Tensor tensor = torch::<span class="built_in">rand</span>(&#123;<span class="number">2</span>, <span class="number">3</span>&#125;);</span><br><span class="line">  std::cout &lt;&lt; tensor &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Cmakelists-xml"><a href="#Cmakelists-xml" class="headerlink" title="Cmakelists.xml"></a>Cmakelists.xml</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.0</span> FATAL_ERROR)</span><br><span class="line"><span class="keyword">project</span>(example-app)</span><br><span class="line"><span class="keyword">find_package</span>(Torch REQUIRED)</span><br><span class="line"><span class="keyword">add_executable</span>(example-app example-app.cpp)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(example-app <span class="string">&quot;$&#123;TORCH_LIBRARIES&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">set_property</span>(<span class="keyword">TARGET</span> example-app PROPERTY CXX_STANDARD <span class="number">11</span>)</span><br></pre></td></tr></table></figure>

<h3 id="1-pth-2-pt"><a href="#1-pth-2-pt" class="headerlink" title="1| pth-2-pt"></a>1| pth-2-pt</h3><p>官方jit文档</p>
<p>​    <a target="_blank" rel="noopener" href="https://pytorch.org/docs/1.5.1/jit.html">https://pytorch.org/docs/1.5.1/jit.html</a></p>
<p>​    <a target="_blank" rel="noopener" href="https://pytorch.org/docs/stable/generated/torch.jit.trace_module.html">https://pytorch.org/docs/stable/generated/torch.jit.trace_module.html</a></p>
<ul>
<li><p>模型里面要严格遵守函数在init初始化，forward来使用</p>
<p>看下面这个例子：</p>
</li>
<li><p>对比torch.jit.trace功能，此处foward函数里面有依赖于输入数据的控制流，故必须使用torch.jit.script功能。</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">torch.jit.script(obj)</span><br><span class="line">torch.jit.trace(obj, (args...))</span><br><span class="line">torch.jit.trace_module()</span><br></pre></td></tr></table></figure>

<h4 id="torch-jit-trace"><a href="#torch-jit-trace" class="headerlink" title="torch.jit.trace:"></a>torch.jit.trace:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torchvision.models <span class="keyword">as</span> models</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"></span><br><span class="line"><span class="comment"># 载⼊预训练的型</span></span><br><span class="line">model = models.squeezenet1_1(pretrained=<span class="literal">False</span>)</span><br><span class="line">model.classifier[<span class="number">1</span>] = nn.Conv2d(in_channels=<span class="number">512</span>, out_channels=<span class="number">2</span>, kernel_size=(<span class="number">1</span>, <span class="number">1</span>), stride=(<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">model.num_classes = <span class="number">2</span></span><br><span class="line">model.load_state_dict(torch.load(<span class="string">&#x27;./model/model_squeezenet_utk_face_20.pth&#x27;</span>, map_location=<span class="string">&#x27;cpu&#x27;</span>))</span><br><span class="line">model.<span class="built_in">eval</span>()</span><br><span class="line"><span class="built_in">print</span>(model)</span><br><span class="line"><span class="comment"># model = models.resnet18(pretrained=True)</span></span><br><span class="line"><span class="comment"># print(model)</span></span><br><span class="line"></span><br><span class="line">example = torch.rand(<span class="number">1</span>, <span class="number">3</span>, <span class="number">224</span>, <span class="number">224</span>)</span><br><span class="line">traced_script_module = torch.jit.trace(model, example)</span><br><span class="line"></span><br><span class="line">output = traced_script_module(torch.ones(<span class="number">1</span>, <span class="number">3</span>, <span class="number">224</span>, <span class="number">224</span>))</span><br><span class="line"><span class="built_in">print</span>(output)</span><br><span class="line"><span class="comment"># ----------------------------------</span></span><br><span class="line">traced_script_module.save(<span class="string">&quot;./model/model_squeezenet_utkface.pt&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="2-c-load-pt"><a href="#2-c-load-pt" class="headerlink" title="2| c++ load pt"></a>2| c++ load pt</h3><p>由于涉及到图像的加载与处理，本⼈使⽤opencv进⾏读取和处理。<br>Tips:<br>训练过程中，采⽤PIL.Iamge加载图像(3通道 RGB)，然后Resize到224 x 224⼤⼩， 之后再进⾏ToTensor。因此使⽤C++ libTorch时候也需要按照上述过程对图像进⾏预处理。</p>
<ol>
<li>cv::imread()默认读取为三通道BGR，需要进⾏B&#x2F;R通道交换，这⾥采⽤cv::cvtColor() 实现。</li>
<li>缩放cv::resize() 实现。</li>
<li>opencv读取的图像矩阵存储形式：H x W x C, 但是pytorch中 Tensor的存储为：N x C x H x W, 因此需要进⾏变换，就是np.transpose()操作，这⾥使⽤tensor.permut({2,0,1})实现，效果是⼀样的。</li>
<li>数据归⼀化，采⽤tensor.div(255)实现。</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;torch/script.h&gt;</span> <span class="comment">// One-stop header.</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;memory&gt;</span></span></span><br><span class="line"><span class="comment">//https://pytorch.org/tutorials/advanced/cpp_export.html</span></span><br><span class="line"><span class="built_in">string</span> image_path = <span class="string">&quot;/home/weipenghui/Project-dev/Cpp/testLibTorch2/image&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span>* argv[])</span> &#123;</span><br><span class="line">    <span class="comment">// Deserialize the ScriptModule from a file using torch::jit::load().</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;torch::jit::script::Module&gt; module = torch::jit::load(<span class="string">&quot;model/model_squeezenet_utkface.pt&quot;</span>);</span><br><span class="line">    assert(module != nullptr);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;ok\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//输⼊图像</span></span><br><span class="line">    <span class="keyword">auto</span> image = cv::imread(image_path +<span class="string">&quot;/&quot;</span>+ <span class="string">&quot;7.jpg&quot;</span>,cv::ImreadModes::IMREAD_COLOR);</span><br><span class="line">    cv::Mat image_transfomed;</span><br><span class="line">    cv::resize(image, image_transfomed, cv::Size(<span class="number">224</span>, <span class="number">224</span>));</span><br><span class="line">    cv::cvtColor(image_transfomed, image_transfomed, cv::COLOR_BGR2RGB);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 图像转换为Tensor</span></span><br><span class="line">    torch::Tensor tensor_image = torch::from_blob(image_transfomed.data, &#123;image_transfomed.rows, image_transfomed.cols,<span class="number">3</span>&#125;,torch::kByte);</span><br><span class="line">    tensor_image = tensor_image.permute(&#123;<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>&#125;);</span><br><span class="line">    tensor_image = tensor_image.toType(torch::kFloat);</span><br><span class="line">    tensor_image = tensor_image.div(<span class="number">255</span>);</span><br><span class="line">    tensor_image = tensor_image.unsqueeze(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ⽹络前向计算</span></span><br><span class="line">    <span class="comment">// Execute the model and turn its output into a tensor.</span></span><br><span class="line">    at::Tensor output = module-&gt;forward(&#123;tensor_image&#125;).toTensor();</span><br><span class="line">    <span class="keyword">auto</span> max_result = output.max(<span class="number">1</span>,<span class="literal">true</span>);</span><br><span class="line">    <span class="keyword">auto</span> max_index = <span class="built_in">std</span>::get&lt;<span class="number">1</span>&gt;(max_result).item&lt;<span class="type">float</span>&gt;();</span><br><span class="line">    <span class="keyword">if</span> (max_index == <span class="number">0</span>)&#123;</span><br><span class="line">        cv::putText(image, <span class="string">&quot;male&quot;</span>, cv::Point(<span class="number">50</span>, <span class="number">50</span>), <span class="number">1</span>, <span class="number">1</span>,cv::Scalar(<span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        cv::putText(image, <span class="string">&quot;female&quot;</span>, cv::Point(<span class="number">50</span>, <span class="number">50</span>), <span class="number">1</span>, <span class="number">1</span>,cv::Scalar(<span class="number">0</span>, <span class="number">255</span>, <span class="number">255</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    cv::imwrite(<span class="string">&quot;./result7.jpg&quot;</span>, image);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//cv::imshow(&quot;image&quot;, image);</span></span><br><span class="line">    <span class="comment">//cv::waitKey(0);</span></span><br><span class="line">    <span class="comment">//    at::Tensor prob = torch::softmax(output,1);</span></span><br><span class="line">    <span class="comment">//    auto prediction = torch::argmax(output, 1);</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">//    auto aa = prediction.slice(/*dim=*/0, /*start=*/0, /*end=*/2).item();</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">//    std::cout &lt;&lt; output.slice(/*dim=*/1, /*start=*/0, /*end=*/2) &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">    <span class="comment">//    std::cout &lt;&lt; prob.slice(/*dim=*/1, /*start=*/0, /*end=*/2) &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line">    <span class="comment">//</span></span><br></pre></td></tr></table></figure>

<h3 id="3-CMakeList"><a href="#3-CMakeList" class="headerlink" title="3| CMakeList"></a>3| CMakeList</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cmake_minimum_required</span>(VERSION <span class="number">3.0</span> FATAL_ERROR)</span><br><span class="line"><span class="keyword">project</span>(custom_ops)</span><br><span class="line"><span class="comment">#include_directories(./opencv-3.4.3/build/install_cv/include)</span></span><br><span class="line"><span class="comment"># set(CMAKE_PREFIX_PATH &quot;./opencv-3.4.3/build/install_cv&quot;)</span></span><br><span class="line"><span class="keyword">find_package</span>(OpenCV REQUIRED)</span><br><span class="line"><span class="keyword">set</span>(CMAKE_PREFIX_PATH</span><br><span class="line">        ./libtorch</span><br><span class="line">        ./opencv-<span class="number">3.4</span>.<span class="number">3</span>/build/install_cv)</span><br><span class="line"><span class="keyword">find_package</span>(Torch REQUIRED)</span><br><span class="line"><span class="keyword">add_executable</span>(example-app main.cpp)</span><br><span class="line"><span class="keyword">target_link_libraries</span>(example-app <span class="variable">$&#123;TORCH_LIBRARIES&#125;</span> <span class="variable">$&#123;OpenCV_LIBS&#125;</span>)</span><br><span class="line"><span class="keyword">set_property</span>(<span class="keyword">TARGET</span> example-app PROPERTY CXX_STANDARD <span class="number">11</span>)</span><br></pre></td></tr></table></figure>

<h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3><p><a target="_blank" rel="noopener" href="https://pytorch.org/cppdocs/installing.html#">1、环境配置Pytorch Offical libtorch make demo</a></p>
<p><a target="_blank" rel="noopener" href="https://pytorch.org/tutorials/advanced/cpp_export.html#step-1-converting-your-pytorch-model-to-torch-script">2、 模型转换 model To torchScript </a></p>
<p><a target="_blank" rel="noopener" href="https://pytorch.org/tutorials/advanced/cpp_export.html#step-3-loading-your-script-module-in-c">3、模型调用LOADING A TORCHSCRIPT MODEL IN C++</a></p>
<p><a target="_blank" rel="noopener" href="https://wenku.baidu.com/view/c623ae43551252d380eb6294dd88d0d233d43ca2.html">C++ 调用libtorch，推理模型，very全面</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44220689/article/details/123228426">VS2017 C++调用torch模型——libtorch </a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/jiaken2660/article/details/105966439/">libtroch部署之torch.jit.script Module踩坑之旅</a></p>
<h2 id="Demos"><a href="#Demos" class="headerlink" title="Demos"></a>Demos</h2><h3 id="行人重识别PCB"><a href="#行人重识别PCB" class="headerlink" title="行人重识别PCB"></a>行人重识别PCB</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;torch/torch.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;torch/script.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">torch::jit::script::Module module = torch::jit::load(<span class="string">&quot;pt模型路径&quot;</span>, torch::kCUDA); <span class="comment">//模型加载到cuda上</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;模型加载成功&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">torch::NoGradGuard no_grad_guard;</span><br><span class="line"></span><br><span class="line">cv::Mat image = cv::imread(<span class="string">&quot;1.jpg&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//图片预处理，保证跟pytorch训练时的预处理一样的</span></span><br><span class="line">cv::resize(image, image, cv::Size(<span class="number">128</span>, <span class="number">384</span>));</span><br><span class="line">cv::cvtColor(image, image, cv::COLOR_BGR2RGB);</span><br><span class="line"><span class="comment">//输入数据移到cuda上</span></span><br><span class="line">torch::Tensor img_tensor = torch::from_blob(image.data, &#123; <span class="number">1</span>, image.rows, image.cols, <span class="number">3</span> &#125;, torch::kByte).to(torch::kCUDA); </span><br><span class="line">img_tensor = img_tensor.permute(&#123; <span class="number">0</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span> &#125;);</span><br><span class="line">img_tensor = img_tensor.toType(torch::kFloat);</span><br><span class="line">img_tensor = img_tensor.div(<span class="number">255</span>);</span><br><span class="line">img_tensor[<span class="number">0</span>][<span class="number">0</span>] = img_tensor[<span class="number">0</span>][<span class="number">0</span>].sub_(<span class="number">0.485</span>).div_(<span class="number">0.229</span>);</span><br><span class="line">img_tensor[<span class="number">0</span>][<span class="number">1</span>] = img_tensor[<span class="number">0</span>][<span class="number">1</span>].sub_(<span class="number">0.456</span>).div_(<span class="number">0.224</span>);</span><br><span class="line">img_tensor[<span class="number">0</span>][<span class="number">2</span>] = img_tensor[<span class="number">0</span>][<span class="number">2</span>].sub_(<span class="number">0.406</span>).div_(<span class="number">0.225</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;torch::jit::IValue&gt; inputs;</span><br><span class="line">inputs.push_back(img_tensor);</span><br><span class="line">torch::Tensor output = module.forward(inputs).toTensor();</span><br><span class="line"></span><br><span class="line">torch::Tensor features = output.contiguous().view(&#123; <span class="number">1</span>, <span class="number">-1</span> &#125;);</span><br><span class="line"></span><br><span class="line">torch::Tensor fnorm = features.norm(<span class="number">2</span>, <span class="number">1</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">torch::Tensor norm_feature = features.div(fnorm.unsqueeze(<span class="number">1</span>)).to(torch::kCPU);</span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">float</span>&gt; <span class="title function_">vec_feature_ouput</span><span class="params">(norm_feature.data&lt;<span class="type">float</span>&gt;(), norm_feature.data&lt;<span class="type">float</span>&gt;() + norm_feature.numel())</span>;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\n&quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://novav.github.io/2022/05/14/AI/RL/RL_info/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Simon Shi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Simon Shi的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/14/AI/RL/RL_info/" class="post-title-link" itemprop="url">RL 概念 + RL算法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-14 21:29:00" itemprop="dateCreated datePublished" datetime="2022-05-14T21:29:00+00:00">2022-05-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-06 08:16:38" itemprop="dateModified" datetime="2025-08-06T08:16:38+00:00">2025-08-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AI/" itemprop="url" rel="index"><span itemprop="name">AI</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AI/RL/" itemprop="url" rel="index"><span itemprop="name">RL</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Contents:</p>
<p>[TOC]</p>
<h1 id="Naikai-RL"><a href="#Naikai-RL" class="headerlink" title="Naikai RL"></a>Naikai RL</h1><h2 id="1、基本原理，概念"><a href="#1、基本原理，概念" class="headerlink" title="1、基本原理，概念"></a>1、基本原理，概念</h2><p><strong>依赖模型：</strong></p>
<ul>
<li><p><strong>基于模型</strong>的强化学习算法：用数据先学习系统模型，然后基于模型得到最优策略</p>
</li>
<li><p><strong>无模型</strong>的强化学习算法：直接通过交互数据得到最优策略</p>
</li>
</ul>
<p><strong>策略更新方法：</strong></p>
<ul>
<li>基于值函数的强化学习， </li>
<li>基于直接策略搜索的强化学习，</li>
<li>Actor-Critic的方法。</li>
</ul>
<p>根据<strong>回报函数</strong>是否已知分为：正向强化学习和逆向强化学习</p>
<ul>
<li><p>正向强化学习：从回报(reward)学到最优策略</p>
</li>
<li><p>逆向强化学习：从专家示例中学到回报函数</p>
</li>
</ul>
<p>根据任务大小和多少分为：分层强化学习、元强化学习、多智能体强化学习、迁移学习等</p>
<h3 id="发展趋势"><a href="#发展趋势" class="headerlink" title="发展趋势"></a>发展趋势</h3><p>\1. 贝叶斯强化学习</p>
<p>​        融合推理能力，可解决POMDP问题</p>
<p>\2. 分层强化学习</p>
<p>​        解决大规模学习问题</p>
<p>\3. 元强化学习</p>
<p>​        解决对任务学习</p>
<p>\4. 多智能体强化学习</p>
<p>​        博弈：合作，竞争，混合</p>
<h3 id="路线图"><a href="#路线图" class="headerlink" title="路线图"></a>路线图</h3><p>强化学习课程的路线图</p>
<p>\1. 搞清楚<strong>马尔科夫决策过程</strong>的概念</p>
<p>\2. 抓住强化学习的基本迭代过程：策略评估和策略改善</p>
<p>\3. 掌握强化学习最常用的两种方法：基于值函数的方法和基于直接策略搜索的方法</p>
<p>\4. 强化学习的其他方法：AC框架，基于模型的强化学习，基于记忆的强化学习等等</p>
<h3 id="置信度算法"><a href="#置信度算法" class="headerlink" title="置信度算法"></a>置信度算法</h3><p>多臂赌博机：UCB <a target="_blank" rel="noopener" href="https://blog.csdn.net/chenxy_bwave/article/details/121715210">https://blog.csdn.net/chenxy_bwave/article/details/121715210</a></p>
<h2 id="2、马尔可夫决策过程"><a href="#2、马尔可夫决策过程" class="headerlink" title="2、马尔可夫决策过程"></a>2、马尔可夫决策过程</h2><p>有限马尔可夫决策问题的三种基本方法：</p>
<ul>
<li>动态规划，</li>
<li>蒙特卡洛方法</li>
<li>时序差分学习。</li>
</ul>
<h3 id="马尔科夫性"><a href="#马尔科夫性" class="headerlink" title="马尔科夫性"></a>马尔科夫性</h3><p>马尔科夫性： 系统的下一个状态只与当前状态有关，与以前状态无关。<br>定义：一个状态St是马尔科夫的，当且仅当：</p>
<p>$$<br>𝑃 [𝑆_{𝑡+1 }| 𝑆_𝑡] &#x3D; 𝑃 [𝑆{𝑡+1}|𝑆_1, ⋯ , 𝑆_𝑡]<br>$$</p>
<ol>
<li>当前状态蕴含所有相关的历史信息</li>
<li>一旦当前状态已知，历史信息将会被抛弃</li>
</ol>
<h3 id="马尔可夫决策过程（MDP"><a href="#马尔可夫决策过程（MDP" class="headerlink" title="马尔可夫决策过程（MDP)"></a>马尔可夫决策过程（MDP)</h3><p>MDP：带有决策和回报的马尔科夫过程：<br>定义：马尔科夫决策过程由元组： $(𝑆, 𝐴, 𝑃, 𝑅, \gamma)$ 描述S为有限的状态集,A为有限的行为集,P为状态转<br>移概率,R为回报函数,𝛾为折扣因子 ;</p>
<p>随机变量 s’,r的分布由条件概率定义：</p>
<p>$$<br>p(s’, r| s,a) &#x3D; Pr{ S_t&#x3D;s’, R&#x3D;r|S_{t-1}&#x3D;s, A_{t-1} &#x3D; a }<br>$$</p>
<h3 id="值函数与策略"><a href="#值函数与策略" class="headerlink" title="值函数与策略"></a>值函数与策略</h3><p>状态s的好坏：值函数 V(s ) （状态的函数）。  </p>
<p>值函数跟策略有关，不同的策略对应不同的值函数  </p>
<p>策略的定义：  </p>
<p>一个策略 𝜋是给定状态s时，动作集上的一个分布：</p>
<p>$$<br>\pi(𝑎|𝑠) &#x3D; 𝑝[𝐴_𝑡 &#x3D; 𝑎 | 𝑆_𝑡 &#x3D; 𝑠]<br>$$</p>
<h3 id="策略的定义"><a href="#策略的定义" class="headerlink" title="策略的定义"></a>策略的定义</h3><img src="/2022/05/14/AI/RL/RL_info/image-20220514220120535.png" title alt="image-20220514220120535" width="296">

<img title src="/2022/05/14/AI/RL/RL_info/image-20220514220139656.png" alt="image-20220514220139656" style="zoom: 80%;" width="333">

<h3 id="值函数的定义"><a href="#值函数的定义" class="headerlink" title="值函数的定义"></a>值函数的定义</h3><img src="/2022/05/14/AI/RL/RL_info/image-20220514222618432.png" title alt="image-20220514222618432" width="586">

<h3 id="马尔科夫决策过程：贝尔曼方程"><a href="#马尔科夫决策过程：贝尔曼方程" class="headerlink" title="马尔科夫决策过程：贝尔曼方程"></a>马尔科夫决策过程：贝尔曼方程</h3><p>$$<br>v_{\pi}(s) &#x3D; \sum_{a\in A} \pi(a|s)(R_s^a + r\sum_{s’\in S} P_{ss’}^a v_{\pi}(s’) )<br>$$</p>
<img title src="/2022/05/14/AI/RL/RL_info/image-20220514230945730.png" alt="image-20220514230945730" style="zoom: 67%;" width="484">

<h3 id="最优价值函数和最优状态-动作值函数"><a href="#最优价值函数和最优状态-动作值函数" class="headerlink" title="最优价值函数和最优状态-动作值函数"></a>最优价值函数和最优状态-动作值函数</h3><p><img src="/2022/05/14/AI/RL/RL_info/image-20220514231308060.png" alt="image-20220514231308060"></p>
<h2 id="3、动态规划到强化学习"><a href="#3、动态规划到强化学习" class="headerlink" title="3、动态规划到强化学习"></a>3、动态规划到强化学习</h2><p>单阶段决策：数学规划</p>
<p>多阶段决策：动态规划</p>
<p>动态规划的本质：将多阶段决策问题通过贝尔曼方程转化为多个单阶段的决策问题  </p>
<p>离散贝尔曼方程：</p>
<p>连续贝尔曼方程：</p>
<p>微分动态规划方法</p>
<h3 id="DP-RL"><a href="#DP-RL" class="headerlink" title="DP -&gt; RL"></a>DP -&gt; RL</h3><p><strong>控制领域集中于连续高维问题</strong></p>
<p>最优控制：模型已知，立即回报解析地给出，状态空间小。</p>
<p>近似动态规划：利用机器学习方法学习值函数，解决维数灾难  </p>
<p>计算机领域：<strong>集中于离散大规模问题</strong></p>
<p>以马尔科夫决策过程为基础，强化学习  无模型，回报函数不解，状态空间无穷</p>
<p>动态规划： <strong>策略评估（估计值函数）</strong> ，策略改进</p>
<p>所有强化学习算法都可以看成是动态规划算法，只是用更少的计算，并且没有假设完美模型  </p>
<h3 id="策略评估-Prediction"><a href="#策略评估-Prediction" class="headerlink" title="策略评估(Prediction)"></a>策略评估(Prediction)</h3><img src="/2022/05/14/AI/RL/RL_info/image-20220515011248768.png" title alt="image-20220515011248768" width="515">

<img src="/2022/05/14/AI/RL/RL_info/image-20220515011317445.png" title alt="image-20220515011317445" width="516">

<h3 id="策略改进"><a href="#策略改进" class="headerlink" title="策略改进"></a>策略改进</h3><img src="/2022/05/14/AI/RL/RL_info/image-20220515011413638.png" title alt="image-20220515011413638" width="404">

<img src="/2022/05/14/AI/RL/RL_info/image-20220515011510658.png" title alt="image-20220515011510658" width="527">

<p><img src="/2022/05/14/AI/RL/RL_info/2023-08-10-18-50-52-image.png"></p>
<h3 id="值函数迭代"><a href="#值函数迭代" class="headerlink" title="值函数迭代"></a>值函数迭代</h3><img title src="/2022/05/14/AI/RL/RL_info/image-20220515011034529.png" alt="image-20220515011034529" width="588">

<img title src="/2022/05/14/AI/RL/RL_info/2023-08-10-18-51-45-image.png" alt width="587">

<h2 id="4、MC-TD"><a href="#4、MC-TD" class="headerlink" title="4、MC &amp; TD"></a>4、MC &amp; TD</h2><img src="/2022/05/14/AI/RL/RL_info/image-20220515011639271.png" title alt="image-20220515011639271" width="543">

<p><strong>值函数：</strong></p>
<p>$$<br>v_{\pi}(s) &#x3D; E_{\pi} [G_t|S_t&#x3D;s]&#x3D; E_{\pi}[\sum_{k&#x3D;0}^{\infty} r^kR_{t+k+1} | S_t&#x3D;s]<br>$$</p>
<p><strong>状态-行为值函数：</strong></p>
<p>$$<br>q_{\pi} &#x3D; \sum_{a\in A} \pi(a|s)\Big(R_s^a + r\sum_{s’ \in S} P_{ss’}^a v_{\pi}(s’)\Big)<br>$$</p>
<h1 id="RL-Sutton"><a href="#RL-Sutton" class="headerlink" title="RL_Sutton"></a>RL_Sutton</h1><h2 id="2、Multi-armed-Bandits"><a href="#2、Multi-armed-Bandits" class="headerlink" title="2、Multi-armed Bandits"></a>2、Multi-armed Bandits</h2><h2 id="3、Finite-Markov-Decision-Processes"><a href="#3、Finite-Markov-Decision-Processes" class="headerlink" title="3、Finite Markov Decision Processes"></a>3、Finite Markov Decision Processes</h2><h2 id="4、DP"><a href="#4、DP" class="headerlink" title="4、DP"></a>4、DP</h2><h2 id="5、MC"><a href="#5、MC" class="headerlink" title="5、MC"></a>5、MC</h2><p><img src="/2022/05/14/AI/RL/RL_info/2024-02-07-16-27-57-image.png"></p>
<h3 id="5-3-MC-ES"><a href="#5-3-MC-ES" class="headerlink" title="5.3 MC (ES)"></a>5.3 MC (ES)</h3><ul>
<li>On-Policy</li>
</ul>
<p><img src="/2022/05/14/AI/RL/RL_info/2024-02-07-16-29-31-image.png"></p>
<h3 id="5-4-On-Policy"><a href="#5-4-On-Policy" class="headerlink" title="5.4  On-Policy"></a>5.4  On-Policy</h3><p>On-policy methods attempt to evaluate or improve the policy that is used to make decisions;</p>
<p>off-policy methods evaluate or improve a policy different from that used to generate the data.</p>
<p>基于experience replay的方法基本上都是off-policy的。</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2024-02-07-16-45-28-image.png"></p>
<h3 id="5-5-Off-policy"><a href="#5-5-Off-policy" class="headerlink" title="5.5 Off-policy"></a>5.5 Off-policy</h3><p><strong>target policy</strong> : to learned</p>
<p><strong>behavior policy</strong> : to generate behavior</p>
<ul>
<li>行为策略(behavior policy):agent与environment交互使用的策略，用来产生数据来改进agent的行为。因为需要有探索性，这个策略是随机的。</li>
<li>目标策略(target policy): 学成以后用于应用的策略。这个时候agent根据这个策略来采取行动。</li>
</ul>
<p>on-policy 是Off-policy的一种特例（same）</p>
<h3 id="5-6-Incremental-Implementation"><a href="#5-6-Incremental-Implementation" class="headerlink" title="5.6 Incremental Implementation"></a>5.6 Incremental Implementation</h3><p><img src="/2022/05/14/AI/RL/RL_info/2024-02-07-16-46-22-image.png"></p>
<ul>
<li><p>b : is the behavior policy</p>
</li>
<li><p>$\pi$ : target policy</p>
</li>
<li><p>state-transition概率p&#x3D;$\frac{\pi}{b}$</p>
</li>
</ul>
<h2 id="6、TD"><a href="#6、TD" class="headerlink" title="6、TD"></a>6、TD</h2><h3 id="TD-0"><a href="#TD-0" class="headerlink" title="TD(0)"></a>TD(0)</h3><p><img src="/2022/05/14/AI/RL/RL_info/2023-08-31-14-17-07-image.png"></p>
<h3 id="Sarsa-on-policy-TD"><a href="#Sarsa-on-policy-TD" class="headerlink" title="Sarsa(on-policy TD)"></a>Sarsa(on-policy TD)</h3><p>TD(0)学习的是状态价值函数V(s)，这里因为（），所以需要学习动作价值函数Q(s,a)；</p>
<p>五元组$（S_t, A_t, R_{t+1}, S_{t+1}, A_{t+1}）$</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-08-31-14-16-52-image.png"></p>
<h3 id="Q-learning-off-policy-TD"><a href="#Q-learning-off-policy-TD" class="headerlink" title="Q-learning (off-policy TD)"></a>Q-learning (off-policy TD)</h3><p><img src="/2022/05/14/AI/RL/RL_info/2023-08-31-14-17-27-image.png"></p>
<h3 id="Double-Q-learning"><a href="#Double-Q-learning" class="headerlink" title="Double Q-learning"></a>Double Q-learning</h3><p><img src="/2022/05/14/AI/RL/RL_info/2023-08-31-14-17-42-image.png"></p>
<h2 id="7、n-step-Bootstrapping"><a href="#7、n-step-Bootstrapping" class="headerlink" title="7、n-step Bootstrapping"></a>7、n-step Bootstrapping</h2><h3 id="7-1-n-step-TD"><a href="#7-1-n-step-TD" class="headerlink" title="7.1 n-step TD"></a>7.1 n-step TD</h3><img title src="/2022/05/14/AI/RL/RL_info/2023-09-06-10-07-17-image.png" alt width="478"> 

<p>各个算法的更新目标（回报）</p>
<p>$$<br>\begin{align*}<br>&amp; MC: G_t &#x3D; R_{t+1} + \gamma R_{t+2} + \gamma^2 R_{t+3} + … + \gamma^{T-t-1} R_T \</p>
<p>&amp; TD(0): G_{t:t+1} &#x3D;  R_{t+1} + \gamma V(S_{t+1}) \<br>&amp; \gamma V(S_{t+1})&#x3D;  \gamma R_{t+2} + \gamma^2 R_{t+3} + … + \gamma^{T-t-1} R_T\</p>
<p>&amp; TD(2): G_{t:t+1} &#x3D;  R_{t+1} + \gamma R_{t+2}+ \gamma^2 V(S_{t+2})  \</p>
<p>&amp; TD(n): G_{t:t+n} &#x3D;  R_{t+1} + \gamma R_{t+2}+ …<br>      + \gamma^{n-1} R_{t+n} + \gamma^{n} V_{t+n-1}(S_{t+n})  \tag{7.1}<br>\end{align*}<br>$$</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-08-31-14-18-05-image.png"></p>
<h3 id="n-step-Sarsa"><a href="#n-step-Sarsa" class="headerlink" title="n-step Sarsa"></a>n-step Sarsa</h3><p><img src="/2022/05/14/AI/RL/RL_info/2023-08-31-14-28-14-image.png"></p>
<h3 id="n-step-Sarsa-Off-policy"><a href="#n-step-Sarsa-Off-policy" class="headerlink" title="n-step Sarsa(Off-policy)"></a>n-step Sarsa(Off-policy)</h3><img title src="/2022/05/14/AI/RL/RL_info/2023-08-31-14-44-11-image.png" alt data-align="inline">

<h3 id="n-step-Tree-Backup"><a href="#n-step-Tree-Backup" class="headerlink" title="n-step Tree Backup"></a>n-step Tree Backup</h3><p><img src="/2022/05/14/AI/RL/RL_info/2023-08-31-14-58-23-image.png"></p>
<h2 id="8、-Planning-and-Learning-with-Tabular-Methods"><a href="#8、-Planning-and-Learning-with-Tabular-Methods" class="headerlink" title="8、 Planning and Learning with Tabular Methods"></a>8、 Planning and Learning with Tabular Methods</h2><h2 id="9-On-Policy-Prediction"><a href="#9-On-Policy-Prediction" class="headerlink" title="9 On-Policy Prediction"></a>9 On-Policy Prediction</h2><h3 id="9-1-Value-function-Approximation"><a href="#9-1-Value-function-Approximation" class="headerlink" title="9.1 Value-function Approximation"></a>9.1 Value-function Approximation</h3><p>$$<br>\begin{align*}<br>&amp; MC: S_t \rightarrow G_t \<br>&amp; TD(0): S_t \rightarrow R_{t+1} + \gamma\hat{v}(S_{t+1}, W_t) \<br>&amp; TD: S_t \rightarrow G_{t:t+n} \<br>&amp; DP: S_t \rightarrow E_\pi[R_{t+1} + \gamma\hat{v}(S_{t+1}, W_t) | S_t &#x3D; s]<br>\end{align*}<br>% &amp; 左对齐<br>$$</p>
<h3 id="9-2-The-Prediction-Objective"><a href="#9-2-The-Prediction-Objective" class="headerlink" title="9.2 The Prediction Objective"></a>9.2 The Prediction Objective</h3><p>预测目标： Mean Squared  Value Error 均方差</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-09-05-17-22-34-image.png"></p>
<h3 id="9-3-Stochastic-gradient-and-Semi-gradient-TD-0-Methods"><a href="#9-3-Stochastic-gradient-and-Semi-gradient-TD-0-Methods" class="headerlink" title="9.3 Stochastic-gradient and Semi-gradient TD(0) Methods"></a>9.3 Stochastic-gradient and Semi-gradient TD(0) Methods</h3><p>随机梯度与半梯度方法</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-09-05-17-23-04-image.png"></p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-09-05-17-25-04-image.png"></p>
<h3 id="9-4-Linear-Methods-n-step-Semi-Graditent-TD"><a href="#9-4-Linear-Methods-n-step-Semi-Graditent-TD" class="headerlink" title="9.4 Linear Methods(n-step Semi-Graditent TD)"></a>9.4 Linear Methods(n-step Semi-Graditent TD)</h3><p>n-step Semi-Graditent TD</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-09-05-17-18-14-image.png"></p>
<img title src="/2022/05/14/AI/RL/RL_info/2023-09-05-17-18-28-image.png" alt width="607" data-align="inline"> 

<h3 id="9-5-Feature-Construction-for-Linear-Methods"><a href="#9-5-Feature-Construction-for-Linear-Methods" class="headerlink" title="9.5 Feature Construction for Linear Methods"></a>9.5 Feature Construction for Linear Methods</h3><p>Polynomials 多项式</p>
<p>Radial Basis Functions 径向基函数 </p>
<p>    与其说 ，特征0，1；不如说是区间[0，1]之间的任何东西，反应特征存在的不同程度；</p>
<p>RBF特征采用高斯表示，当前状态s和中心(原型)状态ci之间的举例表示；</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2024-02-08-16-42-37-image.png"></p>
<h3 id="9-7-ANN-非线性函数逼近"><a href="#9-7-ANN-非线性函数逼近" class="headerlink" title="9.7 ANN (非线性函数逼近)"></a>9.7 ANN (非线性函数逼近)</h3><h3 id="9-8-LSTD"><a href="#9-8-LSTD" class="headerlink" title="9.8 LSTD"></a>9.8 LSTD</h3><p>Least-Squares TD</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2024-02-08-16-48-45-image.png"></p>
<h3 id="9-11-Looking-Deeper-at-On-Policy-Learning-Interest-and-Emphasis"><a href="#9-11-Looking-Deeper-at-On-Policy-Learning-Interest-and-Emphasis" class="headerlink" title="9.11 Looking Deeper at On-Policy  Learning : Interest and Emphasis"></a>9.11 Looking Deeper at On-Policy  Learning : Interest and Emphasis</h3><p>(9.15)引入强调值Mt</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-09-05-17-30-34-image.png"></p>
<h2 id="10-On-Policy-Control"><a href="#10-On-Policy-Control" class="headerlink" title="10 On-Policy Control"></a>10 On-Policy Control</h2><h3 id="10-1-Episodic-Semi-gradient-Control"><a href="#10-1-Episodic-Semi-gradient-Control" class="headerlink" title="10.1 Episodic Semi-gradient Control"></a>10.1 Episodic Semi-gradient Control</h3><p><img src="/2022/05/14/AI/RL/RL_info/2023-09-05-19-52-35-image.png"></p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-09-05-19-52-11-image.png"></p>
<h3 id="10-2-Semi-gradient-n-step-Sarsa"><a href="#10-2-Semi-gradient-n-step-Sarsa" class="headerlink" title="10.2 Semi-gradient n-step Sarsa"></a>10.2 Semi-gradient n-step Sarsa</h3><p><img src="/2022/05/14/AI/RL/RL_info/2023-09-05-20-08-10-image.png"></p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-09-05-20-07-20-image.png"></p>
<h3 id="10-3-Average-Reward-A-New-Problem-Setting-for-Continuing-Tasks"><a href="#10-3-Average-Reward-A-New-Problem-Setting-for-Continuing-Tasks" class="headerlink" title="10.3 Average Reward: A New Problem Setting for  Continuing Tasks"></a>10.3 Average Reward: A New Problem Setting for  Continuing Tasks</h3><p><img src="/2022/05/14/AI/RL/RL_info/2023-09-05-20-23-02-image.png"></p>
<img title src="/2022/05/14/AI/RL/RL_info/2023-09-05-20-23-29-image.png" alt width="588">

<p><img src="/2022/05/14/AI/RL/RL_info/2023-09-05-21-10-10-image.png"></p>
<h3 id="10-4-Deprecating-the-Discounted-Setting"><a href="#10-4-Deprecating-the-Discounted-Setting" class="headerlink" title="10.4 Deprecating the Discounted Setting"></a>10.4 Deprecating the Discounted Setting</h3><h3 id="10-5-Differential-Semi-gradient-n-step-Sarsa"><a href="#10-5-Differential-Semi-gradient-n-step-Sarsa" class="headerlink" title="10.5 Differential Semi-gradient n-step Sarsa"></a>10.5 Differential Semi-gradient n-step Sarsa</h3><p><img src="/2022/05/14/AI/RL/RL_info/2023-09-05-21-11-39-image.png"></p>
<h2 id="11-Off-Policy-Methods"><a href="#11-Off-Policy-Methods" class="headerlink" title="11 Off-Policy Methods"></a>11 Off-Policy Methods</h2><h2 id="12-Eligibility-Traces-资格迹"><a href="#12-Eligibility-Traces-资格迹" class="headerlink" title="12 Eligibility Traces 资格迹"></a>12 Eligibility Traces 资格迹</h2><h3 id="12-1-gamma-回报"><a href="#12-1-gamma-回报" class="headerlink" title="12.1 $\gamma 回报$"></a>12.1 $\gamma 回报$</h3><p>参数化的函数逼近：</p>
<p>$$<br>G_{t:t+n} &#x3D;  R_{t+1} + \gamma R_{t+2}+ …<br>      + \gamma^{n-1} R_{t+n} + \gamma^{n} V_{t+n-1}(S_{t+n}, W_{t+n-1}) \tag{12.1}<br>$$</p>
<p>$\lambda$ 回报:</p>
<p>$$<br>G_t^{\lambda} &#x3D; (1- \lambda) \sum_{n&#x3D;1}^{\infty} \lambda^{n-1}G_{t:t+n} \tag{12.2}<br>$$</p>
<p>提取终止项：</p>
<p>$$<br>G_t^{\lambda} &#x3D; (1- \lambda) \sum_{n&#x3D;1}^{T-t-1} \lambda^{n-1}G_{t:t+n}<br>    + \lambda^{T-t-1}G_{t} \tag{12.3}<br>$$</p>
<p>更新目标：</p>
<p>$$<br>w_{t+1} &#x3D; w_{t} + \alpha[ G_{t}^{\lambda} - \hat{v}(S_t, w_t)]<br>    \nabla \hat{v}(S_t, w_t),     t&#x3D;0,…,T-1  \tag{12.4}<br>$$</p>
<h3 id="12-2-TD-lambda"><a href="#12-2-TD-lambda" class="headerlink" title="12.2 TD($\lambda$)"></a>12.2 TD($\lambda$)</h3><ul>
<li><p>每一步都更新权重向量（原本是结束时更新）</p>
</li>
<li><p>计算平均分布在整个时间轴，而不是结束时</p>
</li>
<li><p>也适用于持续性问题，（episode更不用说了）</p>
</li>
</ul>
<p>资格迹$z_t$，短期记忆；是一个和权值向量w_t同维度的向量；</p>
<ul>
<li>唯一作用：影响权值向量，进而权值向量影响估计值v；</li>
</ul>
<p>权值向量$w_t$：长期的记忆</p>
<p>$$<br>\begin{align*}<br>&amp; z_{-1} &#x3D; 0,\<br>&amp; z_t &#x3D; \gamma \lambda z_{t-1} + \nabla \hat{v}(S_t, w_t), 0 \leqslant t \leqslant T<br>\tag{12.5}<br>\end{align*}<br>$$</p>
<p>$$<br>\begin{align*}<br>&amp; \delta_t &#x3D; R_{t+1} + \gamma \hat{v}(S_{t+1}, w_t) - \hat{v}(S_t, w_t) \tag{12.6}    \</p>
<p>&amp; w_{t+1} &#x3D; w + \alpha \delta_t z_t  \tag{12.7}<br>\end{align*}<br>$$</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-09-06-11-23-48-image.png"></p>
<h3 id="12-3-n-step-Truncated-lambda-return-Methods"><a href="#12-3-n-step-Truncated-lambda-return-Methods" class="headerlink" title="12.3 n-step Truncated $\lambda$-return Methods"></a>12.3 n-step Truncated $\lambda$-return Methods</h3><h3 id="12-7-Sarsa"><a href="#12-7-Sarsa" class="headerlink" title="12.7 Sarsa()"></a>12.7 Sarsa()</h3><p>Sarsa: TD metod for action values;</p>
<p>extend eligibility-traces to action-value methods.</p>
<p>learn approximate action values,  qˆ(s, a, w), rather than approximate state values, vˆ(s,w)</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-09-06-15-14-32-image.png"></p>
<img title src="/2022/05/14/AI/RL/RL_info/2023-09-06-15-14-47-image.png" alt width="536">

<p><img src="/2022/05/14/AI/RL/RL_info/2023-09-06-15-18-41-image.png"></p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-09-06-15-16-40-image.png"></p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-09-06-15-21-14-image.png"></p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-09-06-15-22-40-image.png"></p>
<h3 id="12-8-Variable-lambda-and-gamma"><a href="#12-8-Variable-lambda-and-gamma" class="headerlink" title="12.8 Variable  $\lambda$ and $\gamma$"></a>12.8 Variable  $\lambda$ and $\gamma$</h3><h2 id="13-Policy-Gradient-Methods"><a href="#13-Policy-Gradient-Methods" class="headerlink" title="13 Policy Gradient Methods"></a>13 Policy Gradient Methods</h2><p>参数化的策略方法；价值函数仍可用于学习策略的参数，但是对于动作选择而言，就不是必须了。</p>
<p>梯度上升：gradient  ascent in J。</p>
<p>$$<br>\theta_{t+1} &#x3D; \theta_t + \alpha \widehat{ \nabla J(\theta_t) } \tag{13.1}<br>$$</p>
<p>同时学习策略和值函数的近似值的方法通常称为 <mark>演员-评论家</mark>方法，其中“演员”是指所学策略，而“评论家”是指所学习的值函数，通常是状态价值函数。</p>
<h3 id="1-Policy-Approximation-and-its-Advantages"><a href="#1-Policy-Approximation-and-its-Advantages" class="headerlink" title="1. Policy Approximation and its Advantages"></a>1. Policy Approximation and its Advantages</h3><p><em>动作偏好soft-max</em> （soft-max in action preferences）</p>
<p>例如在扑克中诈(bluffing)。 动作值方法没有找到随机最优策略的自然方法，而策略逼近方法却可以，如示例13.1所示。</p>
<p>相比于动作值参数化，策略参数化可能具有的最简单的优势是策略可能是一种做近似更简单的函数。 问题的策略和行动价值函数的复杂性各不相同。</p>
<ul>
<li><p>对于某些来说，动作值函数更简单，因此更容易近似。</p>
</li>
<li><p>对于其他，策略更简单。 在后一种情况下，基于策略的方法通常将学习得更快， 并产生更好的渐近策略 （如俄罗斯方块；请参见Şimşek, Algórta和Kothiyal，2016年）。</p>
</li>
</ul>
<p>优势1：近似策略接近于一个确定策略；</p>
<p>优势2：可以以任意概率选择动作；</p>
<ul>
<li>例如，在信息不完美的纸牌游戏中，最佳玩法通常是用特定的概率做两件不同的事情，比如在扑克中虚张声势。</li>
</ul>
<h3 id="2-The-Policy-Gradient-Theorem-定理"><a href="#2-The-Policy-Gradient-Theorem-定理" class="headerlink" title="2. The Policy Gradient Theorem(定理)"></a>2. The Policy Gradient Theorem(定理)</h3><p>策略参数化选择动作的概率会平滑的变化，这很大程度上导致了其更强的收敛保证。</p>
<p>特定（非随机）状态下开始:</p>
<p>$$<br>J(\theta) &#x3D; v_{\pi_\theta}(s_0)<br>$$</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-08-11-09-56-50-image.png"></p>
<h3 id="3-REINFORCE-Monte-Carlo-Policy-Gradient"><a href="#3-REINFORCE-Monte-Carlo-Policy-Gradient" class="headerlink" title="3. REINFORCE: Monte Carlo Policy Gradient"></a>3. REINFORCE: Monte Carlo Policy Gradient</h3><p>回想我们前几节提到的梯度上升，我们只需要一种获取样本的获取方法，让采样样本的梯度近似或者等于策略梯度：</p>
<ul>
<li>样本梯度的期望 正比于 实际梯度（作为参数的函数的性能度量）</li>
</ul>
<p>策略梯度定理公式：</p>
<img title src="/2022/05/14/AI/RL/RL_info/2023-08-14-20-39-30-image.png" alt width="320">

<p>这时我们可以应用梯度上升算法（13.1）：</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-09-07-15-08-17-image.png"></p>
<p>由于更新涉及了所有的动作，因此被称为<strong>全部动作算法</strong>，不过，我们更关注在时刻t被采样的动作，因此需要用策略对动作进行期望加权： </p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-08-14-20-39-06-image.png"></p>
<p>使用这个算法进行梯度上升，就可以得到我们想要的Reinforce算法：</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-08-14-20-39-18-image.png">（13.8）</p>
<p>综合起来，就可以写出算法伪代码：</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-08-14-20-40-45-image.png"></p>
<p>$$<br>\nabla ln(x) &#x3D; \frac{\nabla x}{x}<br>$$</p>
<h3 id="4、带有baseline的Reinforce"><a href="#4、带有baseline的Reinforce" class="headerlink" title="4、带有baseline的Reinforce"></a>4、带有baseline的Reinforce</h3><p>可以在动作价值函数后加一个对比的baseline（v(s)）以推广策略梯度定理，只要不随动作a变化就行：</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-08-14-20-55-12-image.png"></p>
<p>为什么可以这么做呢？因为对策略求和的梯度为0：</p>
<img title src="/2022/05/14/AI/RL/RL_info/2023-08-14-20-55-20-image.png" alt width="402">

<p><img src="/2022/05/14/AI/RL/RL_info/2023-08-15-12-02-14-image.png"></p>
<p>比较自然的一个baseline就是状态价值函数了。这样做的好处在于，在不改变期望的前提下，大大降低了方差。</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-09-07-16-04-04-image.png"></p>
<h3 id="5-Actor–Critic-Methods"><a href="#5-Actor–Critic-Methods" class="headerlink" title="5. Actor–Critic Methods"></a>5. Actor–Critic Methods</h3><p>尽管带baseline的强化学习方法学习了一个状态价值函数，我们也不能说它是演员评论家（actor critic）方法，因为状态价值函数仅仅当做baseline，而不是Critic。<mark>没有被用作自举</mark>（bootstrapping，根据后续状态的估计值更新状态的值估计）。</p>
<p>然而，和所有MC方法一样，这种方法收敛很慢，而且难以在线实现。</p>
<p>use actor–critic methods with  a bootstrapping critic.</p>
<p>为了解决这个问题，我们引入TD（0）方法与演员评论家方法：</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-08-14-20-56-18-image.png"></p>
<p>这是一个online、增量式的算法，所有收集到的数据只会在第一次使用，之后就弃用：</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-08-15-15-31-44-image.png"></p>
<p> n-step (+资格迹)<img src="/2022/05/14/AI/RL/RL_info/2023-08-15-15-33-44-image.png"></p>
<h3 id="6、持续性问题的策略梯度"><a href="#6、持续性问题的策略梯度" class="headerlink" title="6、持续性问题的策略梯度"></a>6、持续性问题的策略梯度</h3><p>Policy Gradient for Continuing Problems</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-08-15-16-03-46-image.png"></p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-08-15-16-05-34-image.png"></p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-08-15-16-17-41-image.png"></p>
<h3 id="7、Policy-Parameterization-for-Continuous-Actions"><a href="#7、Policy-Parameterization-for-Continuous-Actions" class="headerlink" title="7、Policy Parameterization for Continuous Actions"></a>7、Policy Parameterization for Continuous Actions</h3><p>通过学习概率分布的统计量，而不是每一个动作的概率，我们能够解决连续动作空间的任务正态分布的概率密度函数：<img src="/2022/05/14/AI/RL/RL_info/2023-08-15-16-24-41-image.png"></p>
<p>为了得到参数化的策略函数，我们不如把策略定义为正态分布的概率密度：</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-08-15-16-48-48-image.png"></p>
<p>我们分别用均值和标准差来近似策略参数向量，由于标准差为正数，所以得用指数形式：</p>
<p><img src="/2022/05/14/AI/RL/RL_info/2023-08-15-16-52-07-image.png"></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p>《南开大学–强化学习课程PPT》</p>
<p>《强化学习 Sutton》</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/543356115">★★★★十二、Policy Gradient Methods 策略梯度方法</a></p>
<p><a target="_blank" rel="noopener" href="https://mofanpy.com/tutorials/machine-learning/reinforcement-learning/">强化学习 (Reinforcement Learning) | 莫烦Python</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://novav.github.io/2022/05/10/Sub_Language/CPlus/CPlus_Performance/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Simon Shi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Simon Shi的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/10/Sub_Language/CPlus/CPlus_Performance/" class="post-title-link" itemprop="url">C++ 性能优化</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-10 12:30:00" itemprop="dateCreated datePublished" datetime="2022-05-10T12:30:00+00:00">2022-05-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-06 08:16:40" itemprop="dateModified" datetime="2025-08-06T08:16:40+00:00">2025-08-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/dev/" itemprop="url" rel="index"><span itemprop="name">dev</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/dev/c/" itemprop="url" rel="index"><span itemprop="name">c++</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://wenku.baidu.com/view/3247ec153a68011ca300a6c30c2259010202f3cf.html">C++类（五）——重新审视auto、比较三种for循环的效率、</a></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> ids[] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// auto 方法最快</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> v: ids)&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; v;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i&lt; <span class="keyword">sizeof</span>(ids)/<span class="keyword">sizeof</span>(<span class="type">int</span>); i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ids[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 每次都要求group.size(), 并还需要找group[i]的位置</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; group;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">size_t</span> i=<span class="number">0</span>; i&lt; group.size(); i++)&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; group[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 每次求iter！=end(), 并且要提取相应位置的值</span></span><br><span class="line"><span class="keyword">for</span> (iter= group.begin(); iter != group.end(); iter++)&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; *iter</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> v: group)&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; v;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://novav.github.io/2022/05/06/Sub_Language/CPlus/CPlus_Vector/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Simon Shi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Simon Shi的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/06/Sub_Language/CPlus/CPlus_Vector/" class="post-title-link" itemprop="url">C++ 容器</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-06 12:00:00" itemprop="dateCreated datePublished" datetime="2022-05-06T12:00:00+00:00">2022-05-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-06 08:16:40" itemprop="dateModified" datetime="2025-08-06T08:16:40+00:00">2025-08-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/dev/" itemprop="url" rel="index"><span itemprop="name">dev</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/dev/c/" itemprop="url" rel="index"><span itemprop="name">c++</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>[TOC]</p>
<p>c++ STL </p>
<h3 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h3><ul>
<li><p>序列容器</p>
<ul>
<li><p>vector</p>
</li>
<li><p>array</p>
</li>
<li><p>queue</p>
</li>
<li><p>deque</p>
</li>
<li><p>list</p>
</li>
<li><p>forward_list</p>
</li>
</ul>
</li>
<li><p>关联容器</p>
<ul>
<li><p>map</p>
</li>
<li><p>set</p>
</li>
<li><p>unordered_map</p>
</li>
<li><p>multimap</p>
</li>
<li><p>unordered_multimap</p>
</li>
<li><p>multiset</p>
</li>
<li><p>unordered_multiset</p>
</li>
</ul>
</li>
</ul>
<h3 id="1-vector"><a href="#1-vector" class="headerlink" title="1. vector"></a>1. vector</h3><p>初始化</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">    vector&lt;<span class="type">int</span>&gt; vec1;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">float</span>&gt; <span class="title">vec2</span><span class="params">(<span class="number">3</span>)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">char</span>&gt; <span class="title">vec3</span><span class="params">(<span class="number">3</span>,<span class="string">&#x27;a&#x27;</span>)</span></span>;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">char</span>&gt; <span class="title">vec4</span><span class="params">(vec3)</span></span>;</span><br><span class="line">    vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">vecNN</span>(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//&lt;1&gt; 第一个是空的整形vector，我们没有给他添加任何元素。</span></span><br><span class="line"><span class="comment">//&lt;2&gt;第二个初始化了一个有3个元素的vector，由于并没有指定初始 值，将会使用编译器默认的初始值。</span></span><br><span class="line"><span class="comment">//&lt;3&gt;第三个初始化了含有3个a的字符vector，括号中第二个值代表着所有元素的指定值。</span></span><br><span class="line"><span class="comment">//&lt;4&gt;第四个vector通过拷贝vec3中的元素初始化vec4，它们的元素会一模一样。</span></span><br></pre></td></tr></table></figure>

<h4 id="push-back"><a href="#push-back" class="headerlink" title="push_back()"></a>push_back()</h4><p>insert()</p>
<p>size()</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line">vector&lt;<span class="type">int</span>&gt; vect1,vect2;</span><br><span class="line"></span><br><span class="line"><span class="comment">//# push_back</span></span><br><span class="line">vect<span class="number">1.</span><span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">vect<span class="number">1.</span><span class="built_in">push_back</span>(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">vect<span class="number">2.</span><span class="built_in">push_back</span>(<span class="number">8</span>);</span><br><span class="line">vect<span class="number">2.</span><span class="built_in">push_back</span>(<span class="number">9</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//# insert</span></span><br><span class="line">vect<span class="number">2.</span><span class="built_in">insert</span>(vect<span class="number">2.</span><span class="built_in">end</span>(),vect<span class="number">1.</span><span class="built_in">begin</span>(),vect<span class="number">1.</span><span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">//# size</span></span><br><span class="line">vect<span class="number">2.</span><span class="built_in">size</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; vect<span class="number">2.</span><span class="built_in">size</span>(); i++)</span><br><span class="line">&#123;</span><br><span class="line">    cout&lt;&lt;vect2[i]&lt;&lt;endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Delete ~ ~Erase()</p>
<ol>
<li><code>erase</code>返回一个迭代器，指向被删除元素之后的位置。</li>
<li>如果尝试删除超出向量范围的索引，<code>erase</code>将抛出<code>std::out_of_range</code>异常。</li>
<li>在删除元素后，所有后续元素的索引都会减少。例如，如果你删除了索引为2的元素，索引为3的元素会变成索引为2的元素。</li>
<li><code>erase</code>会释放被删除元素占用的内存。</li>
<li>使用<code>erase</code>后，向量的长度会减少。</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">    std::vector&lt;<span class="type">int</span>&gt; vec = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;  </span><br><span class="line"></span><br><span class="line">    <span class="comment">// 删除索引为2的元素（即数字3）  </span></span><br><span class="line">    vec.<span class="built_in">erase</span>(vec.<span class="built_in">begin</span>() + <span class="number">2</span>);  </span><br><span class="line"></span><br><span class="line">    <span class="comment">// 输出修改后的向量  </span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num : vec) &#123;  </span><br><span class="line">        std::cout &lt;&lt; num &lt;&lt; <span class="string">&quot; &quot;</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">    std::cout &lt;&lt; std::endl;  </span><br><span class="line"></span><br><span class="line">vect.<span class="built_in">erase</span>(std::<span class="built_in">remove</span>(vect.<span class="built_in">begin</span>(), vect.<span class="built_in">end</span>(), id), vect.<span class="built_in">end</span>());</span><br></pre></td></tr></table></figure>

<h4 id="find"><a href="#find" class="headerlink" title="find"></a>find</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//# find</span></span><br><span class="line"><span class="keyword">auto</span> iter = <span class="built_in">find</span>(vec<span class="number">2.</span><span class="built_in">begin</span>(), vec<span class="number">2.</span><span class="built_in">end</span>(), <span class="number">9</span>);</span><br><span class="line"><span class="keyword">if</span> (iter != vec<span class="number">2.</span><span class="built_in">end</span>())</span><br><span class="line">&#123;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Find IT!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>replace</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">std::vector&lt;<span class="type">int</span>&gt; vec = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;  </span><br><span class="line">vec[<span class="number">2</span>] = <span class="number">10</span>; <span class="comment">// 将索引为2的元素替换为10</span></span><br></pre></td></tr></table></figure>

<p>find + delete (删除找到的第一个元素)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; vec = &#123;<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">4</span>&#125;;</span><br><span class="line"><span class="keyword">auto</span> iter = <span class="built_in">find</span>(vec.<span class="built_in">begin</span>(), vec.<span class="built_in">end</span>(), <span class="number">4</span>);</span><br><span class="line">vec.<span class="built_in">erase</span>(iter);</span><br></pre></td></tr></table></figure>

<p>find + replace</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">std::vector&lt;<span class="type">int</span>&gt; vec = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;  </span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span>&amp; num : vec) &#123;  </span><br><span class="line">    <span class="keyword">if</span> (num == <span class="number">3</span>) &#123;  </span><br><span class="line">        num = <span class="number">10</span>; <span class="comment">// 将值为3的元素替换为10  </span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="max"><a href="#max" class="headerlink" title="max"></a>max</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; a = &#123; <span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">2</span> &#125;;</span><br><span class="line"><span class="keyword">auto</span> maxPosition = max_element(a.begin(), a.end());</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; *maxPosition &lt;&lt; <span class="string">&quot; at the postion of &quot;</span> &lt;&lt; maxPosition - a.begin() &lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="comment">//cout &lt;&lt; a[maxPosition - a.begin()] &lt;&lt; &quot; at the postion of &quot; &lt;&lt; distance(a.begin(), maxPosition) &lt;&lt; endl;</span></span><br></pre></td></tr></table></figure>

<h4 id="vector-TO-数组"><a href="#vector-TO-数组" class="headerlink" title="vector TO 数组"></a>vector TO 数组</h4><h5 id="1：memcpy"><a href="#1：memcpy" class="headerlink" title="1：memcpy"></a>1：memcpy</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1 vector to arr</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="type">char</span>&gt; <span class="title function_">vec</span><span class="params">(<span class="number">10</span>, <span class="string">&#x27;c&#x27;</span>)</span>; <span class="comment">// 10个c字符</span></span><br><span class="line"><span class="type">char</span> charray[<span class="number">10</span>];</span><br><span class="line"><span class="built_in">memcpy</span>(charray, &amp;vec[<span class="number">0</span>], vec.size()*<span class="keyword">sizeof</span>(vec[<span class="number">0</span>])); <span class="comment">// 注意数组越界--数据超长</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. arr to vector</span></span><br><span class="line"><span class="comment">// 2.1 直接赋值-init</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="type">char</span>&gt; <span class="title function_">v</span><span class="params">(arr, arr+<span class="keyword">sizeof</span>(arr))</span></span><br><span class="line"><span class="comment">// 2.2 copy    </span></span><br><span class="line"><span class="title function_">memcpy</span><span class="params">(&amp;vec[<span class="number">0</span>], arr, <span class="keyword">sizeof</span>(arr))</span>;</span><br></pre></td></tr></table></figure>

<p>ref <a target="_blank" rel="noopener" href="https://wenku.baidu.com/view/d54c10d3740bf78a6529647d27284b73f24236c1.html">baidu wenku</a></p>
<h5 id="2：-std-copy-vector-to-arr"><a href="#2：-std-copy-vector-to-arr" class="headerlink" title="2： std::copy  vector to arr"></a>2： std::copy  vector to arr</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; <span class="title function_">input</span><span class="params">(&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;)</span>;</span><br><span class="line"><span class="type">int</span> arr[input.size()];</span><br><span class="line"><span class="comment">//Copies the range [first,last) into result.</span></span><br><span class="line"><span class="built_in">std</span>::copy(input.begin(), input.end(), arr);</span><br></pre></td></tr></table></figure>

<p>ref:: <a target="_blank" rel="noopener" href="https://www.techiedelight.com/convert-vector-to-array-cpp/">https://www.techiedelight.com/convert-vector-to-array-cpp/</a></p>
<h4 id="max-1"><a href="#max-1" class="headerlink" title="max"></a>max</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; a = &#123; <span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">2</span> &#125;;</span><br><span class="line"><span class="keyword">auto</span> maxPosition = max_element(a.begin(), a.end());</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; *maxPosition &lt;&lt; <span class="string">&quot; at the postion of &quot;</span> &lt;&lt; maxPosition - a.begin() &lt;&lt;<span class="built_in">endl</span>;##<span class="meta"># map</span></span><br></pre></td></tr></table></figure>

<h4 id="vector-切片"><a href="#vector-切片" class="headerlink" title="vector 切片"></a>vector 切片</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 方法1</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; <span class="built_in">vector</span>&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>&#125;;</span><br><span class="line"><span class="comment">// 截取[0,4]</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;::const_iterator first1 = <span class="built_in">vector</span>.begin();</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;::const_iterator last1  = <span class="built_in">vector</span>.begin() + <span class="number">4</span>;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; <span class="title function_">cut1_vector</span><span class="params">(first1, last1)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 截取[-4,]</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;::const_iterator first2 = <span class="built_in">vector</span>.end() - <span class="number">4</span>;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;::const_iterator last2  = <span class="built_in">vector</span>.end();</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; <span class="title function_">cut2_vector</span><span class="params">(first2, last2)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 方法2</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; Arrs &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>&#125;; <span class="comment">// 假设有这么个数组,要截取中间第二个元素到第四个元素：2，3，4</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;::const_iterator Fist = Arrs.begin() + <span class="number">1</span>; <span class="comment">// 找到第二个迭代器</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;::const_iterator Second = Arrs.begin() + <span class="number">2</span>; <span class="comment">// 找到第三个迭代器</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; Arr2;</span><br><span class="line">Arr2.assign(First,Second); <span class="comment">//使用assign() 成员函数将Arrs对应位置的值存入Arrs2数组中</span></span><br></pre></td></tr></table></figure>

<h4 id="去重"><a href="#去重" class="headerlink" title="去重"></a>去重</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; vec = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>&#125;;</span><br><span class="line"><span class="built_in">set</span>&lt;<span class="type">int</span>&gt; <span class="title function_">s</span><span class="params">(vec.begin(), vec.end())</span>;</span><br><span class="line">vec.assign(s.begin(), s.end());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; vec = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>&#125;;</span><br><span class="line">sort(vec.begin(), vec.end());</span><br><span class="line">vec.erase(unique(vec.begin(), vec.end()), vec.end());</span><br><span class="line"><span class="comment">// unique函数将重复的元素放到 vector 的尾部，然后返回指向第一个重复元素的迭代器</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3 remove 删除所有的7</span></span><br><span class="line"><span class="keyword">auto</span> ret = <span class="built_in">std</span>::remove(vec.begin(), vec.end(), <span class="number">7</span>);</span><br><span class="line">vec.erase(ret, vec.end());</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="2-Map"><a href="#2-Map" class="headerlink" title="2. Map"></a>2. Map</h3><p>存放的元素都是K-V键值对，并且Key是不能重复的。</p>
<h4 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">map</span>&lt;<span class="type">int</span>, <span class="built_in">string</span>&gt; mapStudent;  </span><br></pre></td></tr></table></figure>

<h4 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mapStudent.<span class="built_in">insert</span>(<span class="built_in">pair</span>&lt;<span class="type">int</span>, string&gt;(<span class="number">1</span>, <span class="string">&quot;student_one&quot;</span>));             <span class="comment">//pair&lt;&gt;()函数</span></span><br><span class="line">mapStudent.<span class="built_in">insert</span>(map&lt;<span class="type">int</span>, string&gt;::<span class="built_in">value_type</span> (<span class="number">1</span>, <span class="string">&quot;student_one&quot;</span>)); <span class="comment">//map&lt;&gt;::value_type</span></span><br><span class="line">mapStudent.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">1</span>, <span class="string">&quot;student_one&quot;</span>));                     <span class="comment">//make_pair()函数</span></span><br><span class="line">mapStudent[<span class="number">1</span>] = <span class="string">&quot;student_one&quot;</span>;                                      <span class="comment">//数组方式</span></span><br></pre></td></tr></table></figure>

<h4 id="查找"><a href="#查找" class="headerlink" title="查找"></a>查找</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">iter = mapStudent.<span class="built_in">find</span>(<span class="number">1</span>); <span class="comment">// find(key)</span></span><br><span class="line"><span class="keyword">if</span> (iter != mapStudent.<span class="built_in">end</span>())</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Find &quot;</span> &lt;&lt; iter-&gt;second ;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Dont not find&quot;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="遍历"><a href="#遍历" class="headerlink" title="遍历"></a>遍历</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">map&lt;<span class="type">int</span>, CString&gt;  maps;      <span class="comment">// 或者map &lt; int, 结构体名&gt;   maps;</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i =<span class="number">0</span>; i &lt; maps.<span class="built_in">size</span>(); i++)</span><br><span class="line">&#123;</span><br><span class="line">     CString s=maps[ i ];</span><br><span class="line">&#125;   </span><br><span class="line"></span><br><span class="line">map&lt;CString, 结构体名&gt; maps;</span><br><span class="line">map&lt;CString, 结构体名&gt;::iterator iter;   <span class="comment">//迭代器遍历 如vector 也可使用</span></span><br><span class="line"><span class="keyword">for</span>(  iter=maps.<span class="built_in">begin</span>();     iter!=maps.<span class="built_in">end</span>();   iter++)</span><br><span class="line">&#123;</span><br><span class="line">    CString a = iter - &gt; first;</span><br><span class="line">    结构体名 p = iter - &gt; second;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="删除与清空元素"><a href="#删除与清空元素" class="headerlink" title="删除与清空元素"></a>删除与清空元素</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 迭代器删除</span></span><br><span class="line">iter = mapStudent.<span class="built_in">find</span>(<span class="string">&quot;123&quot;</span>);</span><br><span class="line">mapStudent.<span class="built_in">erase</span>(iter);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 关键字删除</span></span><br><span class="line"><span class="type">int</span> n = mapStudent.<span class="built_in">erase</span>(<span class="string">&quot;123&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 清空map</span></span><br><span class="line">mapStudent.<span class="built_in">erase</span>(mapStudent.<span class="built_in">begin</span>(), mapStudent.<span class="built_in">end</span>())</span><br></pre></td></tr></table></figure>

<h4 id="大小"><a href="#大小" class="headerlink" title="大小"></a>大小</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> mSize = mapStudent.<span class="built_in">size</span>();</span><br></pre></td></tr></table></figure>

<p>原文链接：<a target="_blank" rel="noopener" href="https://blog.csdn.net/bandaoyu/article/details/87775533">https://blog.csdn.net/bandaoyu/article/details/87775533</a></p>
<h3 id="3-unordered-map"><a href="#3-unordered-map" class="headerlink" title="3. unordered_map"></a>3. unordered_map</h3><p>存放的元素都是K-V键值对，并且Key是不能重复的。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="comment">// 如果C++的版本低于C++11,则会报错：[Error] ‘unordered_map’ was not declared in this scope</span></span><br><span class="line"><span class="comment">// 则需要将头文件改为</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;tr1/unordered_map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std::tr1;</span><br></pre></td></tr></table></figure>

<h4 id="建立Hashmap"><a href="#建立Hashmap" class="headerlink" title="建立Hashmap"></a><strong>建立Hashmap</strong></h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">unordered_map&lt;<span class="type">int</span>,<span class="type">int</span>&gt; Hashmap;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// **建立迭代器**</span></span><br><span class="line">unordered_map&lt;<span class="type">int</span>,<span class="type">int</span>&gt;::iterator it;</span><br><span class="line"></span><br><span class="line"><span class="comment">//插入键值对</span></span><br><span class="line"><span class="comment">// insert函数</span></span><br><span class="line">Hashmap.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>&lt;<span class="type">int</span>,<span class="type">int</span>&gt;(<span class="number">1</span>,<span class="number">3</span>));</span><br><span class="line">Hashmap.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">1</span>,<span class="number">3</span>));</span><br><span class="line"><span class="comment">// 通过键添加</span></span><br><span class="line">Hashmap[<span class="number">3</span>]=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//其他函数</span></span><br><span class="line">it = Hashmap.<span class="built_in">begin</span>() <span class="comment">//指向哈希表的第一个容器</span></span><br><span class="line">it = Hashmap.<span class="built_in">end</span>() <span class="comment">//指向哈希表的最后一个容器，实则超出了哈希表的范围，为空</span></span><br><span class="line">Hashmap.<span class="built_in">size</span>() <span class="comment">//返回哈希表的大小</span></span><br><span class="line">Hashmap.<span class="built_in">empty</span>() <span class="comment">//判断哈希表是否为空，返回值为true/false</span></span><br><span class="line">Hashmap.<span class="built_in">clear</span>() <span class="comment">//清空哈希表</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过key值查找键值对</span></span><br><span class="line">it = Hashmap.<span class="built_in">find</span>(<span class="number">2</span>) <span class="comment">//查找key为2的键值对是否存在 ,若没找到则返回Hashmap.end()</span></span><br><span class="line"><span class="keyword">if</span>(Hashmap.<span class="built_in">find</span>(<span class="number">2</span>)!=Hashmap.<span class="built_in">end</span>()) <span class="comment">//判断找到了key为2的键值对</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//通过key值查找该key值下的键值对对数</span></span><br><span class="line">Hashmap.<span class="built_in">count</span>(<span class="number">1</span>) <span class="comment">//返回 1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//swap交换两个Hashmap的键值对</span></span><br><span class="line">Hashmap<span class="number">1.</span><span class="built_in">swap</span>(Hashmap2);</span><br><span class="line"><span class="built_in">swap</span>(Hashmap1,Hashmap2);</span><br></pre></td></tr></table></figure>

<h4 id="遍历Map"><a href="#遍历Map" class="headerlink" title="遍历Map"></a>遍历Map</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//第一种</span></span><br><span class="line">unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; Hashmap;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> p : Hashmap) &#123;</span><br><span class="line">    <span class="type">int</span> front = p.first;   <span class="comment">//key</span></span><br><span class="line">    <span class="type">int</span> end = p.second;   <span class="comment">//value</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//第二种</span></span><br><span class="line">unordered_map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; Hashmap;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> it=Hashmap.<span class="built_in">begin</span>();it!=Hashmap.<span class="built_in">end</span>();it++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> front = it-&gt;first;   <span class="comment">//key</span></span><br><span class="line">    <span class="type">int</span> end = it-&gt;second;   <span class="comment">//value</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//第三种</span></span><br><span class="line">unordered_map&lt;<span class="type">int</span>,<span class="type">int</span>&gt; hash;</span><br><span class="line">unordered_map&lt;<span class="type">int</span>,<span class="type">int</span>&gt;::iterator it;</span><br><span class="line">it = hash.<span class="built_in">begin</span>();</span><br><span class="line"><span class="keyword">while</span>(it != hash.<span class="built_in">end</span>())</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> front= it-&gt;first;   <span class="comment">//key</span></span><br><span class="line">    <span class="type">int</span> end = it-&gt;second;   <span class="comment">//value</span></span><br><span class="line">    it++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="辨析-map-VS-unordered-map"><a href="#辨析-map-VS-unordered-map" class="headerlink" title="辨析.map VS unordered_map"></a>辨析.map VS unordered_map</h3><p>内部实现机理不同<br><strong>map</strong>： map内部实现了⼀个红⿊树（红⿊树是⾮严格平衡⼆叉搜索树，⽽AVL是严格平衡⼆叉搜索树），红⿊树具有⾃动排序的功能，因此map内部的所有元素都是有序的，红⿊树的每⼀个节点都代表着map的⼀个元素。因此，对于map进⾏的查找，删除，添加等⼀系列的操作都相当于是对红⿊树进⾏的操作。map中的元素是按照⼆叉搜索树（⼜名⼆叉查找树、⼆叉排序树，特点就是左⼦树上所有节点的键值都⼩于根节点的键值，右⼦树所有节点的键值都⼤于根节点的键值）存储的，使⽤中序遍历可将键值按照从⼩到⼤遍历出来。</p>
<p><strong>unordered_map</strong>: 内部实现了⼀个哈希表（也叫散列表，通过把关键码值映射到Hash表中⼀个位置来访问记录，查找的时间复杂度可达到O(1)，其在海量数据处理中有着⼴泛应⽤）。因此，其元素的排列顺序是⽆序的。</p>
<p>map</p>
<table>
<thead>
<tr>
<th></th>
<th>特点</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>map</td>
<td>有序性，这是map结构最⼤的优点，其元素的有序性在很多应⽤中都会简化很多的操作<br>红⿊树，内部实现⼀个红⿊书使得map的很多操作在lgn的时间复杂度下就可以实现，因此效率⾮常的⾼<br>缺点： 空间占⽤率⾼，因为map内部实现了红⿊树，虽然提⾼了运⾏效率，但是因为每⼀个节点都需要额外保存⽗节点、孩⼦节点和红&#x2F;⿊<br>性质，使得每⼀个节点都占⽤⼤量的空间<br>适⽤处：对于那些有顺序要求的问题，⽤map会更⾼效⼀些<br></td>
<td></td>
</tr>
<tr>
<td>unorder_map</td>
<td>优点： 因为内部实现了哈希表，因此其查找速度⾮常的快<br>缺点： 哈希表的建⽴⽐较耗费时间<br>适⽤处：对于查找问题，unordered_map会更加⾼效⼀些，因此遇到查找问题，常会考虑⼀下⽤unordered_map<br></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h4 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h4><p><strong>内存占有率的问题</strong>就转化成红⿊树 VS hash表 , 还是unorder_map占⽤的内存要⾼。</p>
<ul>
<li>但是unordered_map执⾏效率要⽐map⾼很多</li>
<li>对于unordered_map或unordered_set容器，其遍历顺序与创建该容器时输⼊的顺序不⼀定相同，因为遍历是按照哈希表从前往后依次遍历的</li>
</ul>
<p><strong>map和unordered_map的使⽤</strong></p>
<ul>
<li>unordered_map的⽤法和map是⼀样的，提供了 insert，size，count等操作，并且⾥⾯的元素也是以pair类型来存贮的。</li>
<li>其底层实现是完全不同的，上⽅已经解释了，但是就外部使⽤来说却是⼀致的。</li>
</ul>
<h3 id="4-set"><a href="#4-set" class="headerlink" title="4. set"></a>4. set</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// init</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">set</span>&lt;<span class="type">int</span>&gt; myset&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line"><span class="comment">// init 2</span></span><br><span class="line"><span class="type">int</span> arr[] = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">set</span>&lt;<span class="type">int</span>&gt; <span class="title function_">myset</span><span class="params">(arr, arr+<span class="number">5</span>)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// insert</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">set</span>&lt;<span class="type">int</span>&gt; myset;</span><br><span class="line">myset.insert(<span class="number">1</span>);</span><br><span class="line">myset.insert(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// delete</span></span><br><span class="line"><span class="keyword">auto</span> cnt = myset.erase(<span class="number">2</span>); <span class="comment">// 返回删除几个元素，0个，1个</span></span><br><span class="line"><span class="comment">// clear</span></span><br><span class="line">myset.clear();</span><br><span class="line"></span><br><span class="line"><span class="comment">// for </span></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">std</span>::<span class="built_in">set</span>&lt;<span class="type">int</span>&gt;::iterator it = myset.begin(); it != myset.end(); it++) &#123;</span><br><span class="line"><span class="comment">// or</span></span><br><span class="line"><span class="comment">// for (auto it = myset.begin(); it != myset.end(); it++) &#123;</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// for 逆序</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> it = myset.rbegin(); it != myset.rend(); it++) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// count 元素查询</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">set</span>&lt;<span class="type">int</span>&gt; myset;</span><br><span class="line">myset.insert(<span class="number">2</span>);</span><br><span class="line">myset.insert(<span class="number">4</span>);</span><br><span class="line">myset.insert(<span class="number">6</span>);</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; myset.count(<span class="number">4</span>) &lt;&lt; <span class="string">&quot;\n&quot;</span>; <span class="comment">// 1</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; myset.count(<span class="number">8</span>) &lt;&lt; <span class="string">&quot;\n&quot;</span>; <span class="comment">// 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// find 元素查询</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">set</span>&lt;<span class="type">int</span>&gt; myset = &#123;<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>&#125;;</span><br><span class="line"><span class="keyword">auto</span> search = myset.find(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">if</span> (search != myset.end()) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Found &quot;</span> &lt;&lt; *search &lt;&lt; <span class="string">&quot;\n&quot;</span>; <span class="comment">// Found 2</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Not found\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// empty </span></span><br><span class="line"><span class="keyword">if</span> (myset.empty())</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;empty set &quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://shengyu7697.github.io/std-set/">https://shengyu7697.github.io/std-set/</a></p>
<h3 id="排列组合"><a href="#排列组合" class="headerlink" title="排列组合"></a>排列组合</h3><p><a target="_blank" rel="noopener" href="https://codeantenna.com/a/Z0YeOt7gu4">算法-递归法实现排列组合C++</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wangdeqiang2007/article/details/78975216">通用 排列&#x2F;组合 函数(c++实现)</a></p>
<h4 id="全排列-stl"><a href="#全排列-stl" class="headerlink" title="全排列(stl)"></a>全排列(stl)</h4><p>从n个不同元素中任取m（m≤n）个元素，按照一定的顺序排列起来，叫做从n个不同元素中取出m个元素的一个排列。当m&#x3D;n时所有的排列情况叫<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E5%85%A8%E6%8E%92%E5%88%97&spm=1001.2101.3001.7020">全排列</a>。如果这组数有n个，那么全排列数为n!个。</p>
<p>比如a，b，c的全排列一共有3！&#x3D; 6 种 分别是{a, b, c}、{a, c, b}、{b, a, c}、{b, c, a}、{c, a, b}、{c, b, a}。</p>
<p>api:</p>
<p><code>prev_permutation</code></p>
<p><code>next_permutation</code></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> arr[] = &#123;<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>&#125;;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;用prev_permutation对3 2 1的全排列&quot;</span>&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; arr[<span class="number">0</span>] &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; arr[<span class="number">1</span>] &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; arr[<span class="number">2</span>]&lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">prev_permutation</span>(arr,arr<span class="number">+3</span>) );      </span><br><span class="line">    <span class="comment">///获取上一个较大字典序排列，如果3改为2，只对前两个数全排列</span></span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> arr1[] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;用next_permutation对1 2 3的全排列&quot;</span>&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; arr1[<span class="number">0</span>] &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; arr1[<span class="number">1</span>] &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; arr1[<span class="number">2</span>] &lt;&lt;<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">next_permutation</span>(arr1,arr1<span class="number">+3</span>) );      </span><br><span class="line">    <span class="comment">///获取下一个较大字典序排列，如果3改为2，只对前两个数全排列</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">///注意数组顺序，必要时要对数组先进行排序</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="全排列递归思路"><a href="#全排列递归思路" class="headerlink" title="全排列递归思路"></a><strong>全排列递归思路</strong></h5><p>我们可以将这个排列问题画成图形表示，即排列枚举树，比如下图为{1,2,3}的排列枚举树，此树和我们这里介绍的算法完全一致；</p>
<p> <img src="/2022/05/06/Sub_Language/CPlus/CPlus_Vector/image-20220507112024363.png" alt="image-20220507112024363"></p>
<p>算法思路：</p>
<p>(1)n个元素的全排列&#x3D;（n-1个元素的全排列）+（另一个元素作为前缀）；</p>
<p>(2)出口：如果只有一个元素的全排列，则说明已经排完，则输出数组；</p>
<p>(3)不断将每个元素放作第一个元素，然后将这个元素作为前缀，并将其余元素继续全排列，等到出口，出口出去后还需要还原数组；</p>
<h4 id="排列（递归）"><a href="#排列（递归）" class="headerlink" title="排列（递归）"></a>排列（递归）</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** permutaion: 排列。</span></span><br><span class="line"><span class="comment"> * 从n个数中选出m个数的方式，若不考虑顺序Cn(m)，若考虑顺序An(m)</span></span><br><span class="line"><span class="comment"> */</span><span class="comment">/* 问题：密码破解</span></span><br><span class="line"><span class="comment"> * 假设有一个 4 位字母密码，每位密码是 a～e 之间的小写字。</span></span><br><span class="line"><span class="comment"> * 编写代码暴力破解密码。</span></span><br><span class="line"><span class="comment"> * 提示：根据可重复排列的规律，生成所有可能的 4 位密码。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Permutation</span> &#123;</span>  </span><br><span class="line">  private:  </span><br><span class="line">    <span class="type">int</span> resultCount_ = <span class="number">0</span>;  </span><br><span class="line">  public:</span><br><span class="line">  <span class="comment">/** Details: 根据输入字母列表，获得所有的排列方式。</span></span><br><span class="line"><span class="comment">   *  params: result- 当前排列形式， candidate- 未排列字母表。</span></span><br><span class="line"><span class="comment">   *  return: null</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="type">void</span> <span class="title function_">breakPassword</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; result, <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; candidate)</span> &#123;    </span><br><span class="line">    <span class="type">int</span> len = candidate.size();    </span><br><span class="line">    <span class="keyword">if</span> (<span class="number">0</span> == len) &#123;      </span><br><span class="line">    <span class="comment">// 无字母剩余，输出排列结果</span></span><br><span class="line">      outputResult(result);</span><br><span class="line">      resultCount_++;      </span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;      </span><br><span class="line">      <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; resultNew;</span><br><span class="line">      <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; candidateLeft;</span><br><span class="line">      <span class="comment">// 读取排列字母</span></span><br><span class="line">      resultNew = result;</span><br><span class="line">      resultNew.push_back(candidate[i]);      </span><br><span class="line">      <span class="comment">// 获得剩余字母表</span></span><br><span class="line">      candidateLeft = candidate;   </span><br><span class="line">      <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;::iterator it = candidateLeft.begin();</span><br><span class="line">      candidateLeft.erase(it + i);      </span><br><span class="line">      <span class="comment">// 递归</span></span><br><span class="line">      breakPassword(resultNew, candidateLeft);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;  </span><br><span class="line">  <span class="comment">// 输出结果  </span></span><br><span class="line">  <span class="type">void</span> <span class="title function_">outputResult</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; result)</span> &#123;    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">int</span> i = <span class="number">0</span>; i &lt; result.size(); i++) &#123;</span><br><span class="line">      <span class="built_in">cout</span> &lt;&lt; result[i];</span><br><span class="line">    &#125;    </span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  &#125;  </span><br><span class="line">  <span class="comment">// 获得所有可能密码总数    </span></span><br><span class="line">  <span class="type">int</span> <span class="title function_">getResultCount</span><span class="params">()</span> &#123;    </span><br><span class="line">    <span class="keyword">return</span> resultCount_;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">  <span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> &#123;  </span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; fourAlphabetString = &#123;<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;e&quot;</span>&#125;;  </span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; res;</span><br><span class="line">    Permutation test;</span><br><span class="line">    test.breakPassword(res, fourAlphabetString);  </span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;可能的密码形式：&quot;</span>;  </span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; test.getResultCount() &lt;&lt; <span class="string">&quot;种&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h4 id="组合-数组"><a href="#组合-数组" class="headerlink" title="组合(数组)"></a>组合(数组)</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; &amp;<span class="title function_">combination</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; &amp;res, <span class="type">const</span> <span class="type">size_t</span> &amp;choose, <span class="built_in">string</span> &amp;working, <span class="type">const</span> <span class="type">size_t</span> &amp;pos)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (choose &gt; working.size() - pos)</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = pos; i != working.size(); ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        working[i] = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (choose == <span class="number">0</span> || pos == working.size())</span><br><span class="line">    &#123;</span><br><span class="line">        res.push_back(working);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    working[pos] = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">    combination(res, choose - <span class="number">1</span>, working, pos + <span class="number">1</span>);</span><br><span class="line">    working[pos] = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    combination(res, choose, working, pos + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; res;</span><br><span class="line">    <span class="type">const</span> <span class="type">size_t</span> choose = <span class="number">3</span>;</span><br><span class="line">    <span class="built_in">string</span> <span class="title function_">working</span><span class="params">(<span class="number">5</span>, <span class="string">&#x27;0&#x27;</span>)</span>;</span><br><span class="line">    combination(res, choose, working, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i != res.size(); ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; res[i] &lt;&lt; <span class="string">&#x27;\t&#x27;</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">size_t</span> j = <span class="number">0</span>; j != working.size(); ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (res[i][j] == <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">cout</span> &lt;&lt; j + <span class="number">1</span> &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="组合-stl-vector"><a href="#组合-stl-vector" class="headerlink" title="组合(stl, vector)"></a>组合(stl, vector)</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;boost/assign.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;boost/function.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line">using namespace boost;</span><br><span class="line">using namespace boost::assign;</span><br><span class="line"></span><br><span class="line"><span class="keyword">inline</span> <span class="type">void</span> <span class="title function_">print_</span><span class="params">(<span class="type">int</span> t)</span>&#123;<span class="built_in">cout</span>&lt;&lt;t&lt;&lt;<span class="string">&quot; &quot;</span>;&#125;</span><br><span class="line"><span class="keyword">inline</span> <span class="type">void</span> <span class="title function_">print</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;&amp; vec)</span></span><br><span class="line">&#123;</span><br><span class="line">    for_each(vec.begin(),vec.end(),print_);</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//! 全排列测试</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">test1</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; vec;</span><br><span class="line">    vec += <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>;</span><br><span class="line">    sort(vec.begin(),vec.end());</span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">       print(vec);</span><br><span class="line">       i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(next_permutation(vec.begin(),vec.end()));</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>&lt;&lt;i&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;<span class="comment">//40320</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//! 组合测试</span></span><br><span class="line"><span class="type">size_t</span> <span class="title function_">test2</span><span class="params">(<span class="type">int</span> n,<span class="type">int</span> m,boost::function&lt;<span class="type">void</span>(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;&amp; vec)&gt; fn)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; p,<span class="built_in">set</span>;</span><br><span class="line">    p.insert(p.end(),m,<span class="number">1</span>);</span><br><span class="line">    p.insert(p.end(),n-m,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i != p.size();++i)</span><br><span class="line">        <span class="built_in">set</span>.push_back(i+<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; vec;</span><br><span class="line">    <span class="type">size_t</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i != p.size();++i)</span><br><span class="line">            <span class="keyword">if</span>(p[i])</span><br><span class="line">               vec.push_back(<span class="built_in">set</span>[i]);</span><br><span class="line">        fn(vec);</span><br><span class="line">        cnt ++;</span><br><span class="line">        vec.clear();</span><br><span class="line">    &#125;<span class="keyword">while</span>(prev_permutation(p.begin(), p.end()));</span><br><span class="line">    <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// test1();</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span>&lt;&lt;test2(<span class="number">20</span>,<span class="number">3</span>,print)&lt;&lt;<span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="组合（class，递归）"><a href="#组合（class，递归）" class="headerlink" title="组合（class，递归）"></a>组合（class，递归）</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"><span class="comment">// 组合</span></span><br><span class="line"><span class="comment">// 思想：从一些对象n中选出一部分m(1&lt;=m&lt;=n)，不考虑顺序，可能的形式有几种。</span></span><br><span class="line"><span class="comment">// 应用：队伍参赛排序。自然语言处理中，处理输入词。当输入词相同仅顺序不一致时，</span></span><br><span class="line"><span class="comment">// 可以采用组合的概念将其排序，并认定为意思相同。</span></span><br><span class="line"></span><br><span class="line">template&lt;typename T&gt; <span class="class"><span class="keyword">class</span> <span class="title">Combination</span> &#123;</span>  </span><br><span class="line">private:  </span><br><span class="line">  <span class="type">const</span> <span class="type">int</span> firstPrize;  </span><br><span class="line">  <span class="type">const</span> <span class="type">int</span> secondPrize;  </span><br><span class="line">  <span class="type">const</span> <span class="type">int</span> thirdPrize;  </span><br><span class="line">public:</span><br><span class="line">  Combination(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> z)</span><br><span class="line">      : firstPrize(x), secondPrize(y), thirdPrize(z) &#123;</span><br><span class="line">  &#125;  </span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * @description:</span></span><br><span class="line"><span class="comment">  * 从10个人中选出三等奖3人，二等奖2人，一等奖1人，不能重复获奖。</span></span><br><span class="line"><span class="comment">  * @param &#123;type&#125; rewardNum- 指定赏金数， result- 奖赏方式结果。</span></span><br><span class="line"><span class="comment">  * @return: null</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="type">void</span> <span class="title function_">rewardMethods</span><span class="params">(<span class="built_in">vector</span>&lt;T&gt; result, <span class="built_in">vector</span>&lt;T&gt; candidate)</span>&#123;    </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> len = thirdPrize + secondPrize + firstPrize;    </span><br><span class="line">    <span class="keyword">if</span> (result.size() == len) &#123;      </span><br><span class="line">      <span class="comment">// 输出结果</span></span><br><span class="line">      resultOutput(result);      </span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;      </span><br><span class="line">      <span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">int</span> i = <span class="number">0</span>; i &lt; candidate.size(); i++) &#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; resultNew = result;</span><br><span class="line">        resultNew.push_back(candidate[i]); </span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; candidateNew;</span><br><span class="line">        copyElem(candidate, candidateNew, i + <span class="number">1</span>);</span><br><span class="line">        rewardMethods(resultNew, candidateNew);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;  </span><br><span class="line">  <span class="comment">// 数据复制函数</span></span><br><span class="line">  <span class="type">void</span> <span class="title function_">copyElem</span><span class="params">(<span class="built_in">vector</span>&lt;T&gt;&amp; input, <span class="built_in">vector</span>&lt;T&gt;&amp; output, <span class="type">int</span> i)</span>&#123;    </span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt;::iterator it = input.begin() + i;    </span><br><span class="line">    <span class="keyword">for</span> (; it &lt; input.end(); it++) &#123;</span><br><span class="line">      output.push_back(*it);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;  </span><br><span class="line">  <span class="comment">// 输出结果</span></span><br><span class="line">  <span class="type">void</span> <span class="title function_">resultOutput</span><span class="params">(<span class="built_in">vector</span>&lt;T&gt; res)</span> &#123;    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">int</span> i = <span class="number">0</span>; i &lt; res.size(); i++) &#123;      </span><br><span class="line">      <span class="keyword">if</span> (i == thirdPrize) <span class="built_in">cout</span> &lt;&lt; <span class="string">&#x27;*&#x27;</span>;     </span><br><span class="line">      <span class="keyword">if</span> (i == thirdPrize + secondPrize) </span><br><span class="line">      <span class="built_in">cout</span> &lt;&lt; <span class="string">&#x27;*&#x27;</span>;      </span><br><span class="line">      <span class="built_in">cout</span> &lt;&lt; res[i] &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    &#125;    </span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">  <span class="comment">// test</span></span><br><span class="line">  <span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span> &#123;</span><br><span class="line">    Combination &lt;<span class="type">int</span>&gt; test(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);  </span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; res;  <span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; candidate;  </span><br><span class="line">    <span class="comment">// 输入</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">      candidate.push_back(i + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    test.rewardMethods(res, candidate);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h3 id="可重复组合（运行Pass）"><a href="#可重复组合（运行Pass）" class="headerlink" title="可重复组合（运行Pass）"></a>可重复组合（运行Pass）</h3><ul>
<li><p>允许元素重复的一类组合问题</p>
</li>
<li><p>用P(n, k)表示从n个元素中选出k个元素（允许重复）的组合问题，那么此问题可以分解为两个子问题：P(n, k-1)和P(n-1, k)，</p>
</li>
<li><p>解释如下：</p>
<ul>
<li><p>P(n, k)中n个元素的所有k元素组合可以分成两部分。</p>
</li>
<li><p>第一部分的每个组合均以第一个元素开始，再连接上k-1个元素的组合，即再连接上P(n,k-1)的每一个组合；</p>
</li>
<li><p>第二部分的每个组合不含有第一个元素，即P(n-1, k)中的每一个组合（此时元素为后n-1个元素）。</p>
</li>
<li><p>因此，P(n, k)分解为P(n, k-1)和P(n-1, k)。</p>
</li>
</ul>
</li>
</ul>
<p>如果用f(n, k)表示P(n, k)中的组合数，那么有：<br>（1）当k &#x3D; 1时，f(n, k) &#x3D; n<br>（2）当n &#x3D; 1时，f(n, k) &#x3D; 1<br>（3）当k &gt; 1且n &gt; 1时，f(n, k) &#x3D; f(n, k -1) + f(n-1, k)</p>
<p>此外，有公式f(n, k) &#x3D; C(n + k -1, k)（表示n+k-1选k的组合数，没有重复元素），这可以用归纳法证明，这里就不啰嗦了。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">template &lt;typename ElemType&gt;</span><br><span class="line"><span class="type">void</span> <span class="title function_">CalcRepeatableCombination</span><span class="params">(<span class="type">const</span> ElemType elements[], <span class="type">int</span> num, <span class="type">int</span> k, <span class="built_in">vector</span>&lt;ElemType&gt; &amp;pre, <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;ElemType&gt;&gt; &amp;result)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (k == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; num; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// copy(pre.begin(), pre.end(), ostream_iterator&lt;ElemType&gt;(cout));</span></span><br><span class="line">            <span class="comment">// cout &lt;&lt; elements[i];</span></span><br><span class="line">            <span class="comment">// cout &lt;&lt; endl;</span></span><br><span class="line">            <span class="built_in">vector</span>&lt;ElemType&gt; <span class="title function_">tmp</span><span class="params">(pre.begin(), pre.end())</span>;</span><br><span class="line">            tmp.push_back(elements[i]);</span><br><span class="line">            result.push_back(tmp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (num == <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// ostream_iterator&lt;ElemType&gt; outIter(cout);</span></span><br><span class="line">        <span class="comment">// outIter = copy(pre.begin(), pre.end(), outIter);</span></span><br><span class="line">        <span class="comment">// fill_n(outIter, k, elements[0]);</span></span><br><span class="line">        <span class="comment">// cout &lt;&lt; endl;</span></span><br><span class="line">        <span class="built_in">vector</span>&lt;ElemType&gt; <span class="title function_">tmp</span><span class="params">(pre.begin(), pre.end())</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; k; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            tmp.push_back(elements[<span class="number">0</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        result.push_back(tmp);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    pre.push_back(elements[<span class="number">0</span>]);</span><br><span class="line">    CalcRepeatableCombination(elements, num, k - <span class="number">1</span>, pre, result);</span><br><span class="line">    pre.pop_back();</span><br><span class="line"></span><br><span class="line">    CalcRepeatableCombination(elements + <span class="number">1</span>, num - <span class="number">1</span>, k, pre, result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">template &lt;typename ElemType&gt;</span><br><span class="line"><span class="type">void</span> <span class="title function_">CalcRepeatableCombination</span><span class="params">(<span class="type">const</span> ElemType elements[], <span class="type">int</span> num, <span class="type">int</span> k, <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;ElemType&gt;&gt; &amp;result)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; num=&quot;</span> &lt;&lt; num &lt;&lt; <span class="string">&quot; k=&quot;</span> &lt;&lt; k &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="comment">// assert(num &gt;= k &amp;&amp; k &gt;= 1);</span></span><br><span class="line">    assert(k &gt;= <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">vector</span>&lt;ElemType&gt; one;</span><br><span class="line">    CalcRepeatableCombination(elements, num, k, one, result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> elements[] = &#123;<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>&#125;;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="type">char</span>&gt; com_r;</span><br><span class="line">    CalcRepeatableCombination(elements, <span class="number">4</span>, <span class="number">3</span>, com_r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://novav.github.io/2022/05/04/Sub_Language/CPlus/CPlus_Eigne/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Simon Shi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Simon Shi的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/04/Sub_Language/CPlus/CPlus_Eigne/" class="post-title-link" itemprop="url">C++ Eigen矩阵库</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-04 12:00:00" itemprop="dateCreated datePublished" datetime="2022-05-04T12:00:00+00:00">2022-05-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-06 08:16:40" itemprop="dateModified" datetime="2025-08-06T08:16:40+00:00">2025-08-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/dev/" itemprop="url" rel="index"><span itemprop="name">dev</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/dev/c/" itemprop="url" rel="index"><span itemprop="name">c++</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>矩阵</p>
<p>[TOC]</p>
<p>官方文档</p>
<p><a target="_blank" rel="noopener" href="https://eigen.tuxfamily.org/dox/group__TutorialMatrixArithmetic.html">Offical Eigen Doc</a></p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p><a target="_blank" rel="noopener" href="https://gitlab.com/libeigen/eigen/-/releases">https://gitlab.com/libeigen/eigen/-/releases</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Ubuntu 系统默认版本安装</span></span><br><span class="line"><span class="built_in">sudo</span> apt-get install libeigen3-dev</span><br><span class="line"></span><br><span class="line">安装路径</span><br><span class="line">    /usr/include/eigen3</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> build</span><br><span class="line"><span class="built_in">cd</span> build</span><br><span class="line">cmake..</span><br><span class="line"><span class="built_in">sudo</span> make install</span><br><span class="line"></span><br><span class="line">安装路径</span><br><span class="line">    /usr/local/include/eigen3 </span><br><span class="line"><span class="comment"># </span></span><br><span class="line">make uninstall</span><br></pre></td></tr></table></figure>

<h2 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h2><h3 id="Map的定义："><a href="#Map的定义：" class="headerlink" title="Map的定义："></a>Map的定义：</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Map&lt; Matrix&lt;<span class="keyword">typename</span> Scalar, <span class="type">int</span> RowsAtCompileTime, <span class="type">int</span> ColsAtCompileTime&gt; &gt;</span><br></pre></td></tr></table></figure>

<p>在这种默认的定义中，Map只需要一个模板参数-Matrix。<br>为了构造Map变量，需要另两个信息：一个指针，该指针指向用于定义数组元素的内存区域；另一个是希望得到的matrix或vector的形状。</p>
<p>比如：定义一个float类型、动态尺寸大小的matrix：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Map&lt;MatrixXf&gt; <span class="title">mf</span><span class="params">(pf,rows,columns)</span></span>;</span><br></pre></td></tr></table></figure>

<p>其中pf是一个float *类型的指向数组内存的指针。</p>
<p>定义一个固定大小的、整形的、只读vector:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Map&lt;<span class="type">const</span> Vector4i&gt; <span class="title">mi</span><span class="params">(pi)</span></span>;</span><br></pre></td></tr></table></figure>

<p>其中，pi是一个int *类型的指针。在这个例子中不需要传递尺寸大小给构造函数，因为尺寸大小已经由Matrix&#x2F;Array类型确定了。</p>
<p>注意:Map没有默认的构造函数，你需要传递一个指针来初始化对象。</p>
<p>Map能够足够灵活地去容纳多种不同的数据表示，其他的两个模板参数：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;<span class="keyword">typename</span> MatrixType,</span><br><span class="line">    <span class="type">int</span> MapOptions,</span><br><span class="line">    <span class="keyword">typename</span> StrideType&gt;</span><br></pre></td></tr></table></figure>

<p>MapOptions标识指针是否是对齐的（Aligned or Unaligned），默认是Unaligned。<br>StrideType表示内存数组的组织方式：行列的步长。</p>
<h3 id="Map矩阵赋值-数组转mxtrix"><a href="#Map矩阵赋值-数组转mxtrix" class="headerlink" title="Map矩阵赋值(数组转mxtrix)"></a>Map矩阵赋值(数组转mxtrix)</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/whereismatrix/article/details/104468247">blog: Map class:连接Eigen与C++的数据</a></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//matrix_map1.cpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Eigen/Dense&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> Eigen;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> array[<span class="number">9</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">9</span>; ++i) array[i] = i;</span><br><span class="line"></span><br><span class="line">    <span class="function">Map&lt;VectorXi&gt;  <span class="title">vi</span><span class="params">(array,<span class="number">9</span>)</span></span>;</span><br><span class="line">    <span class="function">Map&lt;<span class="type">const</span> Vector4i&gt; <span class="title">fixed_v</span><span class="params">(array)</span></span>;    <span class="comment">// unknown type name &#x27;Vector5i&#x27; -- 这种模式size不能大于4</span></span><br><span class="line">    cout&lt;&lt; <span class="string">&quot;vector vi: &quot;</span>&lt;&lt; endl &lt;&lt; vi &lt;&lt; endl&lt;&lt; endl;</span><br><span class="line">    cout&lt;&lt; <span class="string">&quot;fixed-vector : &quot;</span>&lt;&lt; endl &lt;&lt; fixed_v &lt;&lt; endl&lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Column-major:\n&quot;</span> &lt;&lt; Map&lt;Matrix&lt;<span class="type">int</span>,<span class="number">2</span>,<span class="number">4</span>&gt; &gt;(array) &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Row-major:\n&quot;</span> &lt;&lt; Map&lt;Matrix&lt;<span class="type">int</span>,<span class="number">2</span>,<span class="number">4</span>,RowMajor&gt; &gt;(array) &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Row-major using stride:\n&quot;</span> &lt;&lt;</span><br><span class="line">        Map&lt;Matrix&lt;<span class="type">int</span>,<span class="number">2</span>,<span class="number">4</span>&gt;, Unaligned, Stride&lt;<span class="number">1</span>,<span class="number">4</span>&gt; &gt;(array) &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Matrix-to-c-数组"><a href="#Matrix-to-c-数组" class="headerlink" title="Matrix to c++数组"></a>Matrix to c++数组</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Matrix3d eigMat;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 法1</span></span><br><span class="line"><span class="type">double</span>* eigMatptr = eigMat.<span class="built_in">data</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 法2</span></span><br><span class="line"><span class="type">double</span>* eigMatptrnew = <span class="keyword">new</span> <span class="type">double</span>[eigMat.<span class="built_in">size</span>()];</span><br><span class="line"><span class="built_in">Map</span>&lt;MatrixXd&gt;(eigMatptrnew, eigMat.<span class="built_in">rows</span>(), eigMat.<span class="built_in">cols</span>()) = eigMat;</span><br></pre></td></tr></table></figure>

<h3 id="使用Map变量"><a href="#使用Map变量" class="headerlink" title="使用Map变量"></a>使用Map变量</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> Matrix&lt;<span class="type">float</span>,<span class="number">1</span>,Dynamic&gt; MatrixType;</span><br><span class="line"><span class="keyword">typedef</span> Map&lt;MatrixType&gt; MapType;</span><br><span class="line"><span class="keyword">typedef</span> Map&lt;<span class="type">const</span> MatrixType&gt; MapTypeConst;   <span class="comment">// a read-only map</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> n_dims = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">MatrixType <span class="title">m1</span><span class="params">(n_dims)</span>, <span class="title">m2</span><span class="params">(n_dims)</span></span>;</span><br><span class="line">m<span class="number">1.</span><span class="built_in">setRandom</span>();</span><br><span class="line">m<span class="number">2.</span><span class="built_in">setRandom</span>();</span><br><span class="line"><span class="type">float</span> *p = &amp;<span class="built_in">m2</span>(<span class="number">0</span>);  <span class="comment">// get the address storing the data for m2</span></span><br><span class="line"><span class="function">MapType <span class="title">m2map</span><span class="params">(p,m<span class="number">2.</span>size())</span></span>;   <span class="comment">// m2map shares data with m2</span></span><br><span class="line"><span class="function">MapTypeConst <span class="title">m2mapconst</span><span class="params">(p,m<span class="number">2.</span>size())</span></span>;  <span class="comment">// a read-only accessor for m2</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;m1: &quot;</span> &lt;&lt; m1 &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;m2: &quot;</span> &lt;&lt; m2 &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Squared euclidean distance: &quot;</span> &lt;&lt; (m1-m2).<span class="built_in">squaredNorm</span>() &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Squared euclidean distance, using map: &quot;</span> &lt;&lt;  (m1-m2map).<span class="built_in">squaredNorm</span>() &lt;&lt; endl;</span><br><span class="line"><span class="built_in">m2map</span>(<span class="number">3</span>) = <span class="number">7</span>;   <span class="comment">// this will change m2, since they share the same array</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Updated m2: &quot;</span> &lt;&lt; m2 &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;m2 coefficient 2, constant accessor: &quot;</span> &lt;&lt; <span class="built_in">m2mapconst</span>(<span class="number">2</span>) &lt;&lt; endl;</span><br><span class="line"><span class="comment">/* m2mapconst(2) = 5; */</span>   <span class="comment">// this yields a compile-time error</span></span><br></pre></td></tr></table></figure>

<h3 id="修改Map数组"><a href="#修改Map数组" class="headerlink" title="修改Map数组"></a>修改Map数组</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//matrix_map3.cpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Eigen/Dense&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> Eigen;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> data[] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>&#125;;</span><br><span class="line">    <span class="function">Map&lt;RowVectorXi&gt; <span class="title">ov</span><span class="params">(data,<span class="number">9</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Origin data: &quot;</span> &lt;&lt; ov &lt;&lt; endl; </span><br><span class="line"></span><br><span class="line">    <span class="function">Map&lt;RowVectorXi&gt; <span class="title">v</span><span class="params">(data,<span class="number">4</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;The mapped vector v is: &quot;</span> &lt;&lt; v &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// placement new </span></span><br><span class="line">    <span class="keyword">new</span> (&amp;v) <span class="built_in">Map</span>&lt;RowVectorXi&gt;(data<span class="number">+4</span>,<span class="number">5</span>);</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Changed, Now v is: &quot;</span> &lt;&lt; v &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Again origin data: &quot;</span> &lt;&lt; ov &lt;&lt; endl; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="矩阵拼接"><a href="#矩阵拼接" class="headerlink" title="矩阵拼接"></a>矩阵拼接</h3><p>1.<strong>cv::Mat</strong>矩阵拼接（注意在拼接方向上的维度应该相同）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cv::<span class="built_in">vconcat</span>(C, A, B); <span class="comment">//垂直拼接</span></span><br><span class="line">cv::<span class="built_in">hconcat</span>(C, A, B); <span class="comment">//水平拼接</span></span><br></pre></td></tr></table></figure>

<p>2.<strong>Eigen</strong>矩阵拼接（注意矩阵拼接之前必须要确定大小! 否则会报错）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">MatrixXd A;</span><br><span class="line">MatrixXd B;</span><br><span class="line">MatrixXd C;</span><br><span class="line">A.<span class="built_in">resize</span>(<span class="number">3</span>, <span class="number">3</span>);   <span class="comment">//注意矩阵拼接之前必须要确定大小，否则会报错</span></span><br><span class="line">B.<span class="built_in">resize</span>(<span class="number">3</span>, <span class="number">9</span>);   <span class="comment">//注意矩阵拼接之前必须要确定大小，否则会报错</span></span><br><span class="line">C.<span class="built_in">resize</span>(<span class="number">9</span>, <span class="number">3</span>);   <span class="comment">//注意矩阵拼接之前必须要确定大小，否则会报错</span></span><br><span class="line">    A &lt;&lt; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>,</span><br><span class="line">         <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>,</span><br><span class="line">         <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;A:&quot;</span>&lt;&lt;A&lt;&lt;endl;</span><br><span class="line">    B &lt;&lt; A,A,A; <span class="comment">//水平拼接</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;B:&quot;</span>&lt;&lt;B&lt;&lt;endl;</span><br><span class="line">  <span class="comment">//垂直拼接</span></span><br><span class="line">    C &lt;&lt; A,</span><br><span class="line">         A,</span><br><span class="line">         A;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;C:&quot;</span>&lt;&lt;C&lt;&lt;endl;</span><br></pre></td></tr></table></figure>

<h2 id="模块介绍"><a href="#模块介绍" class="headerlink" title="模块介绍"></a>模块介绍</h2><h3 id="向量运算（-T-Sum-Trace-Inverse…）"><a href="#向量运算（-T-Sum-Trace-Inverse…）" class="headerlink" title="向量运算（.T,Sum,Trace,Inverse…）"></a>向量运算（.T,Sum,Trace,Inverse…）</h3><p>Eigen库的矩阵(包括向量)运算时，需要声明头文件&lt;Eigen&#x2F;Core&gt;，矩阵执行常见的运算指令：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">matrix_33 = Matrix3d::<span class="built_in">Random</span>();                           <span class="comment">//生成一个3*3的随机矩阵</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;random matrix: \n&quot;</span>&lt;&lt; matrix_33 &lt;&lt; endl;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;transpose : \n&quot;</span>&lt;&lt; matrix_<span class="number">33.</span><span class="built_in">transpose</span>() &lt;&lt; endl;  <span class="comment">//转置</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;sum :&quot;</span> &lt;&lt; matrix_<span class="number">33.</span><span class="built_in">sum</span>() &lt;&lt; endl;                <span class="comment">//求和</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;trace : &quot;</span>&lt;&lt; matrix_<span class="number">33.</span><span class="built_in">trace</span>() &lt;&lt; endl;            <span class="comment">//求迹</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;time 10: \n&quot;</span>&lt;&lt; <span class="number">10</span> * matrix_33 &lt;&lt; endl;            <span class="comment">//数乘</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;inverse : \n&quot;</span>&lt;&lt; matrix_<span class="number">33.</span><span class="built_in">inverse</span>() &lt;&lt; endl;      <span class="comment">//求逆</span></span><br><span class="line">cout &lt;&lt; <span class="string">&quot;det : \n&quot;</span>&lt;&lt; matrix_<span class="number">33.</span><span class="built_in">determinant</span>() &lt;&lt; endl;      <span class="comment">//求行列式</span></span><br></pre></td></tr></table></figure>

<h3 id="几何模块（四元数，欧拉角，旋转等）"><a href="#几何模块（四元数，欧拉角，旋转等）" class="headerlink" title="几何模块（四元数，欧拉角，旋转等）"></a>几何模块（四元数，欧拉角，旋转等）</h3><p>使用Eigen库的几何模块时，需要声明头文件&lt;Eigen&#x2F;Geometry&gt;，此模块支持进行四元数、欧拉角和旋转矩阵的运算。各种常见形式的表达方式如下所示：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Eigen::Matrix3d      <span class="comment">//旋转矩阵（3*3）</span></span><br><span class="line">Eigen::AngleAxisd    <span class="comment">//旋转向量（3*1）</span></span><br><span class="line">Eigen::Vector3d      <span class="comment">//欧拉角（3*1）</span></span><br><span class="line">Eigen::Quaterniond   <span class="comment">//四元数（4*1）</span></span><br><span class="line">Eigen::Isometry3d    <span class="comment">//欧式变换矩阵（4*4）</span></span><br><span class="line">Eigen::Affine3d      <span class="comment">//放射变换矩阵（4*4）</span></span><br><span class="line">Eigen::Projective3d  <span class="comment">//射影变换矩阵（4*4）</span></span><br></pre></td></tr></table></figure>

<h3 id="eigenGeometry-Demo"><a href="#eigenGeometry-Demo" class="headerlink" title="eigenGeometry Demo"></a>eigenGeometry Demo</h3><ul>
<li>旋转</li>
<li>四元数</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Eigen/Core&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Eigen/Geometry&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Eigen/Geometry 模块提供了各种旋转和平移的表示</span></span><br><span class="line">    <span class="comment">// 3D 旋转矩阵直接使用 Matrix3d 或 Matrix3f</span></span><br><span class="line">    <span class="comment">//Identity() -&gt; 单位矩阵</span></span><br><span class="line">    Eigen::Matrix3f rotation_matrix = Eigen::Matrix3f::<span class="built_in">Identity</span>();</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;rotation matrix: \n&quot;</span> &lt;&lt; rotation_matrix &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 旋转向量使用 AngleAxis, 它底层不直接是Matrix，但运算可以当作矩阵（因为重载了运算符）</span></span><br><span class="line">    <span class="comment">//沿 Z 轴旋转 45 度</span></span><br><span class="line">    <span class="function">Eigen::AngleAxisf <span class="title">rotation_vector</span><span class="params">(M_PI/<span class="number">4</span>,Eigen::Vector3f(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>))</span></span>;</span><br><span class="line">    std::cout.<span class="built_in">precision</span>(<span class="number">3</span>);</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;rotation matrix: \n&quot;</span> &lt;&lt; rotation_vector.<span class="built_in">matrix</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    rotation_matrix = rotation_vector.<span class="built_in">toRotationMatrix</span>();</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;rotation matrix: \n&quot;</span> &lt;&lt; rotation_matrix &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 用 AngleAxis 可以进行坐标变换</span></span><br><span class="line">    <span class="function">Eigen::Vector3f <span class="title">v</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    Eigen::Vector3f v_rotated = rotation_vector * v;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;(1,0,0) after rotation (by angle axis) =   &quot;</span> &lt;&lt; v_rotated.<span class="built_in">transpose</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 用旋转矩阵</span></span><br><span class="line">    v_rotated = rotation_matrix * v;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;(1,0,0) after rotation (by matrix)     =   &quot;</span> &lt;&lt; v_rotated.<span class="built_in">transpose</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//欧拉角: 可以将旋转矩阵直接转换成欧拉角</span></span><br><span class="line">    <span class="comment">// ZYX顺序，即yaw-pitch-roll顺序</span></span><br><span class="line">    Eigen::Vector3f euler_angles = rotation_matrix.<span class="built_in">eulerAngles</span>(<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;yaw-pitch-roll = &quot;</span> &lt;&lt; euler_angles.<span class="built_in">transpose</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 欧氏变换矩阵使用 Eigen::Isometry</span></span><br><span class="line">    <span class="comment">// 虽然称为3d，实质上是4＊4的矩阵</span></span><br><span class="line">    Eigen::Isometry3f T = Eigen::Isometry3f::<span class="built_in">Identity</span>();</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Transform matrix = \n&quot;</span> &lt;&lt; T.<span class="built_in">matrix</span>() &lt;&lt; std::endl;</span><br><span class="line">    T.<span class="built_in">rotate</span>(rotation_vector);                                    <span class="comment">// 按照rotation_vector进行旋转</span></span><br><span class="line">    T.<span class="built_in">pretranslate</span>(Eigen::<span class="built_in">Vector3f</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>));         <span class="comment">// 把平移向量设成(1,3,4)</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Transform matrix = \n&quot;</span> &lt;&lt; T.<span class="built_in">matrix</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 用变换矩阵进行坐标变换</span></span><br><span class="line">    Eigen::Vector3f v_transformed = T * v;                       <span class="comment">// 相当于R*v+t</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;v tranformed = &quot;</span> &lt;&lt; v_transformed.<span class="built_in">transpose</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对于仿射和射影变换，使用 Eigen::Affine3d 和 Eigen::Projective3d 即可，略</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 四元数</span></span><br><span class="line">    <span class="comment">// 可以直接把AngleAxis赋值给四元数，反之亦然</span></span><br><span class="line">    Eigen::Quaternionf q = Eigen::<span class="built_in">Quaternionf</span>(rotation_vector);</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;quaternion from rotation vector = &quot;</span> &lt;&lt; q.<span class="built_in">coeffs</span>().<span class="built_in">transpose</span>()</span><br><span class="line">         &lt;&lt; std::endl;   <span class="comment">// 请注意coeffs的顺序是(x,y,z,w),w为实部，前三者为虚部</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 也可以把旋转矩阵赋给它</span></span><br><span class="line">    q = Eigen::<span class="built_in">Quaternionf</span>(rotation_matrix);</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;quaternion from rotation matrix = &quot;</span> &lt;&lt; q.<span class="built_in">coeffs</span>().<span class="built_in">transpose</span>()</span><br><span class="line">    &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    // 使用四元数旋转一个向量，使用重载的乘法即可</span></span><br><span class="line">    Eigen::Vector3f v_rotated1 =  q * v ;<span class="comment">// 注意数学上是qvq^&#123;-1&#125;</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;(1,0,0) after rotation (by Quaternion) =    &quot;</span> &lt;&lt; v_rotated<span class="number">1.</span><span class="built_in">transpose</span>() &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 用常规向量乘法表示，则应该如下计算</span></span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;should be equal to     = &quot;</span> &lt;&lt; (q * Eigen::<span class="built_in">Quaternionf</span>(<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>) * q.<span class="built_in">inverse</span>()).<span class="built_in">coeffs</span>().<span class="built_in">transpose</span>()</span><br><span class="line">    &lt;&lt; std::endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="参考资料链接："><a href="#参考资料链接：" class="headerlink" title="参考资料链接："></a>参考资料链接：</h2><ul>
<li><a target="_blank" rel="noopener" href="https://eigen.tuxfamily.org/dox/group__TutorialMatrixArithmetic.html">Offical Eigen Doc–Matrix and vector arithmetic</a></li>
<li><a target="_blank" rel="noopener" href="https://eigen.tuxfamily.org/dox/classEigen_1_1Map.html">Offical Eigen Map Doc</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_38009585/article/details/105709250">Eigen矩阵和CV::Mat的拼接方法</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_40378209/article/details/122082604">c++ Eigen（二）eigenGeometry </a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/111727894">C++学习笔记——6. Eigen入门（矩阵运算及几何模块）</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cxybb.com/article/hust_sheng/79647675">eigen稀疏矩阵拼接（基于块操作的二维拼接）的思考_hust_sheng的专栏-程序员宝宝</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43455581/article/details/116382073">Eigen3矩阵与数组的互相转换</a></li>
<li><a target="_blank" rel="noopener" href="http://t.zoukankan.com/VVingerfly-p-8037490.html">Eigen::Matrix与array数据转换</a></li>
<li><a target="_blank" rel="noopener" href="https://www.csdn.net/tags/MtjaYg1sMTU5MzUtYmxvZwO0O0OO0O0O.html">c++计算eigen随笔(5)-求转置</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/486294589">Eigen教程：一站式指南</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/yabin/p/6473654.html">Eigen子矩阵操作</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://novav.github.io/2022/04/26/Tools/Tools_Ressource/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Simon Shi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Simon Shi的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/26/Tools/Tools_Ressource/" class="post-title-link" itemprop="url">资源搜集</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-04-26 12:29:09" itemprop="dateCreated datePublished" datetime="2022-04-26T12:29:09+00:00">2022-04-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-06 08:16:40" itemprop="dateModified" datetime="2025-08-06T08:16:40+00:00">2025-08-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tools/" itemprop="url" rel="index"><span itemprop="name">Tools</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>PDF资源网站</p>
<ul>
<li><p>高等教育出版社（多是试读版）</p>
</li>
<li><p>zLibrary（外文书籍多）</p>
</li>
<li><p>鸠摩搜书（收费网站）</p>
</li>
<li><p>全国图书馆参考咨询联盟网（基本没用）</p>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://novav.github.io/2022/04/25/Course/AutomaticDrive/AutoDriver_09/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Simon Shi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Simon Shi的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/" class="post-title-link" itemprop="url">无人驾驶（9）预测系统</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-04-25 12:10:20" itemprop="dateCreated datePublished" datetime="2022-04-25T12:10:20+00:00">2022-04-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-06 08:16:39" itemprop="dateModified" datetime="2025-08-06T08:16:39+00:00">2025-08-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Autopilot/" itemprop="url" rel="index"><span itemprop="name">Autopilot</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Autopilot/%E5%85%A5%E9%97%A8%E6%8F%90%E9%AB%98/" itemprop="url" rel="index"><span itemprop="name">入门提高</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>CONTENTS:</p>
<p>[toc]</p>
<h3 id="1-PNC（Panning-and-Control）Overview"><a href="#1-PNC（Panning-and-Control）Overview" class="headerlink" title="1 PNC（Panning and Control）Overview"></a>1 PNC（Panning and Control）Overview</h3><p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426005824549.png" alt="image-20220426005824549"></p>
<p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426010020157.png" alt="image-20220426010020157"></p>
<p>难点：</p>
<ul>
<li>人和人之间的博弈–转换成–人和机器的博弈（路口会车情况）</li>
</ul>
<h3 id="2-Prediction-Task"><a href="#2-Prediction-Task" class="headerlink" title="2 Prediction Task"></a>2 Prediction Task</h3><p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426010433330.png" alt="image-20220426010433330"></p>
<h4 id="两种方法"><a href="#两种方法" class="headerlink" title="两种方法"></a>两种方法</h4><ul>
<li>Model-based</li>
<li>Trajectories轨迹预测</li>
</ul>
<p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426010827741.png" alt="image-20220426010827741"></p>
<h4 id="Recruit-Requirement"><a href="#Recruit-Requirement" class="headerlink" title="Recruit Requirement"></a>Recruit Requirement</h4><p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426011146498.png" alt="image-20220426011146498"></p>
<h3 id="3-Vehicle-Predict-车辆预测"><a href="#3-Vehicle-Predict-车辆预测" class="headerlink" title="3 Vehicle Predict (车辆预测)"></a>3 Vehicle Predict (车辆预测)</h3><p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426011425730.png" alt="image-20220426011425730"></p>
<h4 id="道路建模"><a href="#道路建模" class="headerlink" title="道路建模"></a>道路建模</h4><ul>
<li>连续空间–转换成–预测问题</li>
</ul>
<p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426011657015.png" alt="image-20220426011657015"></p>
<ul>
<li>非结构化数据（感知是结构化数据）</li>
</ul>
<p>lane Feature</p>
<ul>
<li><p>Lane S (前方)</p>
</li>
<li><p>Lane L (宽度)</p>
</li>
<li><p>reference lane</p>
</li>
<li><p>Curvature 曲率</p>
</li>
<li><p>Traffic law 交通信号</p>
</li>
</ul>
<p>Vehicle State</p>
<ul>
<li>Velocity （加速度）</li>
<li>Acc （速度）</li>
<li>Heading （）</li>
<li>Heading  rete（角度）</li>
<li>Type（车的类型，救护车，交通车）</li>
<li>Size</li>
</ul>
<p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426012003676.png" alt="image-20220426012003676"></p>
<h4 id="Lane-Model"><a href="#Lane-Model" class="headerlink" title="Lane Model"></a>Lane Model</h4><p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426012739621.png" alt="image-20220426012739621"></p>
<ul>
<li>Obstacle Statue 输入几秒的数据</li>
</ul>
<p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426012846986.png" alt="image-20220426012846986"></p>
<p>Squence Data Network</p>
<p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426013007183.png" alt="image-20220426013007183"></p>
<h4 id="Apollo-Model"><a href="#Apollo-Model" class="headerlink" title="Apollo Model"></a>Apollo Model</h4><p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426013338102.png" alt="image-20220426013338102"></p>
<h4 id="Data-Pipeline"><a href="#Data-Pipeline" class="headerlink" title="Data Pipeline"></a>Data Pipeline</h4><p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426015202905.png" alt="image-20220426015202905"></p>
<p>waygom 首席科学家</p>
<p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426015504496.png" alt="image-20220426015504496"></p>
<h4 id="Trajectory-builder"><a href="#Trajectory-builder" class="headerlink" title="Trajectory builder"></a>Trajectory builder</h4><ul>
<li>Kalman Filter 卡尔曼滤波</li>
<li>Polynomial 多项式</li>
<li>Velocity 动力学方式</li>
</ul>
<p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426015613613.png" alt="image-20220426015613613"></p>
<h4 id="STOA"><a href="#STOA" class="headerlink" title="STOA"></a>STOA</h4><ul>
<li>各家各的格式</li>
</ul>
<h5 id="Uber"><a href="#Uber" class="headerlink" title="Uber"></a>Uber</h5><p>—用图表示周围环境</p>
<ul>
<li>当成回归问题，解决</li>
</ul>
<p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426015841513.png" alt="image-20220426015841513"></p>
<h5 id="waymo"><a href="#waymo" class="headerlink" title="waymo"></a>waymo</h5><p>预测+规划 结合</p>
<p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426020111762.png" alt="image-20220426020111762"></p>
<p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426020145542.png" alt="image-20220426020145542"></p>
<p>用图的思想去预测</p>
<p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426020530774.png" alt="image-20220426020530774"></p>
<h3 id="4-Pedestrian-predict-行人预测"><a href="#4-Pedestrian-predict-行人预测" class="headerlink" title="4 Pedestrian predict (行人预测)"></a>4 Pedestrian predict (行人预测)</h3><p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426020549502.png" alt="image-20220426020549502"></p>
<p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426020608203.png" alt="image-20220426020608203"></p>
<p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426020710296.png" alt="image-20220426020710296"></p>
<p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426020753609.png" alt="image-20220426020753609"></p>
<p>思想：人+人的姿态信息 + 环境信息 + 【分割，识别】  &#x3D;&#x3D;&#x3D;形成一个感知预测的结合</p>
<p>输出： 要做的任务（而不是轨迹的预测）</p>
<p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426020842076.png" alt="image-20220426020842076"></p>
<h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426021108625.png" alt="image-20220426021108625"></p>
<p>HomeWork</p>
<p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_09/image-20220426021148390.png" alt="image-20220426021148390"></p>
<p>traffic Violation违规交通</p>
<p>博弈问题</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://novav.github.io/2022/04/25/Course/AutomaticDrive/AutoDriver_10/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Simon Shi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Simon Shi的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/04/25/Course/AutomaticDrive/AutoDriver_10/" class="post-title-link" itemprop="url">无人驾驶（10）路径规划</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-04-25 12:10:20" itemprop="dateCreated datePublished" datetime="2022-04-25T12:10:20+00:00">2022-04-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-06 08:16:39" itemprop="dateModified" datetime="2025-08-06T08:16:39+00:00">2025-08-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Autopilot/" itemprop="url" rel="index"><span itemprop="name">Autopilot</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Autopilot/%E5%85%A5%E9%97%A8%E6%8F%90%E9%AB%98/" itemprop="url" rel="index"><span itemprop="name">入门提高</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li><p>什么是规划</p>
<ul>
<li>规划的本质</li>
<li>如何解决一个规划问题</li>
</ul>
</li>
<li><p>传统的规划方法</p>
<ul>
<li>机器人学基础</li>
<li>经典算法</li>
</ul>
</li>
<li><p>无人车规划</p>
<ul>
<li>Routing</li>
<li>Planning</li>
<li>Lattice Palnner</li>
</ul>
</li>
<li><p>Apollo 如何求解规划问题</p>
<ul>
<li>EM Planner</li>
<li>DP， QP求解</li>
</ul>
</li>
</ul>
<p>[toc]</p>
<h3 id="What-is-motion-planning"><a href="#What-is-motion-planning" class="headerlink" title="What is motion planning?"></a>What is motion planning?</h3><ul>
<li>planning </li>
<li>本质是什么</li>
</ul>
<p>$$<br>argmin_xf(x)<br>$$</p>
<ul>
<li>搜索问题<ul>
<li>Google: Quary词，返回给最优结果。</li>
<li>无人车：当前环境和当前状态，当前库路径上最优选择。</li>
<li>什么是好规划？</li>
</ul>
</li>
<li>“好”其实就是个目标函数：f(x)<ul>
<li>f(x)的最优解</li>
</ul>
</li>
</ul>
<h3 id="Motion-Planning-的三个领域"><a href="#Motion-Planning-的三个领域" class="headerlink" title="Motion Planning 的三个领域"></a>Motion Planning 的三个领域</h3><ul>
<li>Robotics Fileds:(机器人领域)<ul>
<li>生成轨迹实现目标</li>
<li>常用方法： RRT，A*, D*, D*lite</li>
</ul>
</li>
<li>Control Theory:(控制领域)<ul>
<li>方式：动态系统理论实现目标状态</li>
<li>方法：MPC , LQR</li>
</ul>
</li>
<li>AI：生成状态和Action的映射<ul>
<li>Reinforcement learning， imitation learning<ul>
<li>Cited by motion planning by Steve Lavelle : <a target="_blank" rel="noopener" href="http://palnning.cs.uiuc.edu/par1.pdf">http://palnning.cs.uiuc.edu/par1.pdf</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="如何解决一个Motion-Panning-问题？"><a href="#如何解决一个Motion-Panning-问题？" class="headerlink" title="如何解决一个Motion Panning 问题？"></a>如何解决一个Motion Panning 问题？</h3><ul>
<li>找一个简单的突破口<ul>
<li>将问题转换成一个简单的问题：Path Finding Problem<ul>
<li>不关心速度，不关心走</li>
<li>周围固定</li>
</ul>
</li>
</ul>
</li>
<li>简言之就是，路径选择问题<ul>
<li>A sample shortest path example<ul>
<li><a target="_blank" rel="noopener" href="http://qiao.github.io/PathFinding.js/visual/">http://qiao.github.io/PathFinding.js/visual/</a></li>
</ul>
</li>
<li>什么样的path是最好的？这是重点<ul>
<li>路径最短<ul>
<li>BFS，DFS</li>
<li>Dijkstra</li>
</ul>
</li>
</ul>
</li>
<li>刚刚看到的Search属于non-information search 效率较低</li>
<li><em><em>A</em> search</em>*: 基于Dijkstra的改进算法【<strong>基础算法，很重要</strong>】<ul>
<li>大概知道了终点位置</li>
<li>Heuristic func（启发式）<ul>
<li><a target="_blank" rel="noopener" href="http://www.redblobgames.com/pathfinding/a-star/introduction.html">http://www.redblobgames.com/pathfinding/a-star/introduction.html</a></li>
</ul>
</li>
</ul>
</li>
<li>无人机中的规划和A* search相差多远？<ul>
<li>部分感知</li>
<li>动态障碍物</li>
<li>复杂环境: 交通规则，碰瓷</li>
<li>A*本身是一个Global Algorithm<ul>
<li>Global Routing</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="Partial-Observed-situation"><a href="#Partial-Observed-situation" class="headerlink" title="Partial Observed situation"></a>Partial Observed situation</h3><ul>
<li><p><strong>贪心算法</strong></p>
<ul>
<li>incremental search增量搜索：目前状态求解道最优</li>
</ul>
</li>
<li><p>p* star</p>
<ul>
<li>部分环境信息的一个Search</li>
<li>Apollo登月小车</li>
<li>改进版：D* lite</li>
</ul>
</li>
<li><p>可以求解全局最优？</p>
<ul>
<li><p>有难度</p>
</li>
<li><p>一定必要全局最优吗？</p>
<ul>
<li><blockquote>
<p>Stentz Anthony，“Optimal and Efficient Path Planing for Partially-Known Enviroments”, 1994</p>
</blockquote>
<ul>
<li>（统计学教授）通过部分最优，可以逼近全局最优</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Informative &amp; Non-informative Search</p>
<ul>
<li>Global &amp; Partial observed</li>
</ul>
</li>
<li><p>至此，我们已经有了如下几个方法：</p>
<ul>
<li>目标函数并且结合了平滑性和目标Cost</li>
<li>使用通用的Search方法来最小化Cost从而找到一个最优解</li>
<li>通过Partial observed information来做局部planning</li>
</ul>
</li>
<li><p>我们还缺什么？</p>
<ul>
<li>处理动态障碍物，动态环境</li>
<li>处理交通规则</li>
<li>实时计算 <ul>
<li>（100ms-150ms）</li>
<li>人一般反应时间300-500ms</li>
<li>有效时间内找到最优解</li>
<li>c++</li>
</ul>
</li>
</ul>
</li>
<li><p>给无人车motion planning下一个定义：</p>
<ul>
<li><p>Safely</p>
</li>
<li><p>Smoothly</p>
</li>
<li><p>Achieve to destination</p>
</li>
<li><p>X, Y, Time: 3D trajectory optimization problem</p>
</li>
<li><p>无人车硬件系统</p>
<ul>
<li>定位</li>
<li>感知</li>
</ul>
</li>
<li><p>无人车软件信息</p>
<ul>
<li>动态信息</li>
<li>静态信息<ul>
<li>HD Map<ul>
<li>实时性保证</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>如何设计出一个合理轨迹？</p>
<ul>
<li>路径Path</li>
<li>速度Speed</li>
</ul>
</li>
<li></li>
</ul>
</li>
</ul>
<h3 id="经典参考书籍"><a href="#经典参考书籍" class="headerlink" title="经典参考书籍"></a>经典参考书籍</h3><ul>
<li><blockquote>
<p>Steve Lavelle, Motion Planning Algorithms</p>
</blockquote>
</li>
<li><blockquote>
<p>Principles of Robot Motion: Theory, Algorithms and implementations</p>
</blockquote>
</li>
</ul>
<p>经典文献</p>
<ul>
<li><blockquote>
<p>A Review of Motion Planning for automated Vehivles</p>
</blockquote>
</li>
</ul>
<h2 id="基本Planning方法"><a href="#基本Planning方法" class="headerlink" title="基本Planning方法"></a>基本Planning方法</h2><ul>
<li><p>经典基于环境建模的方法</p>
<ul>
<li>RRT</li>
<li>Lattice</li>
</ul>
</li>
<li><p>现代无人车Planning方法</p>
<ul>
<li><p>Darpa</p>
</li>
<li><p>Lattice in Frenet Frame</p>
</li>
<li><p>Spiral polymial</p>
<blockquote>
<p>A Review of Motion Planning Techniques for Automated Vehicles</p>
</blockquote>
</li>
</ul>
</li>
<li><p>质点模型</p>
<ul>
<li>物体看车一个质点</li>
<li>点与点不相碰</li>
</ul>
</li>
<li><p>刚体问题</p>
<ul>
<li>BycicleModel</li>
<li>XY Heading</li>
<li>Collision</li>
</ul>
</li>
<li><p>Planning限制条件</p>
<ul>
<li>避免膨胀</li>
<li>边界阈值（跟车距离等）</li>
</ul>
</li>
<li><p>连续空间问题怎么解？</p>
<ul>
<li>离散化</li>
<li>网格化</li>
</ul>
</li>
</ul>
<h2 id="传统机器人基础"><a href="#传统机器人基础" class="headerlink" title="传统机器人基础"></a>传统机器人基础</h2><ul>
<li><p>PRM （Probabilistic Roadmap Planning）</p>
<ul>
<li>非常常用三维一个方法</li>
<li>连续空间离散化<ul>
<li>随机撒点</li>
<li>Obstacle上的点删除</li>
</ul>
</li>
<li>连续可行点，形成可行空间</li>
<li>A*</li>
</ul>
</li>
<li><p>RRT（Incremental version of PRM）PRM的增量式的版本</p>
<ul>
<li>使用增加搜索的方式来进行</li>
<li><ul>
<li>找附近可行点的最优点</li>
<li>F(x) 最小，Cost最小</li>
<li>走过车中也不能碰到障碍物</li>
<li>撒点距离不能太远<ul>
<li>一步一步的移动</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Lattice 方法</p>
<ul>
<li>改进了RRT的折线问题</li>
<li>给出Path的平滑曲线</li>
<li>网格化<ul>
<li>每个采样格中都是用曲线连接</li>
</ul>
</li>
<li>指数级别的一个搜索算法（NP-Hard)</li>
</ul>
</li>
<li><p>DP（动态规划）</p>
<ul>
<li>减少搜索空间<ul>
<li>服用已有结果</li>
</ul>
</li>
<li>Lattice DP的平滑度够吗？<ul>
<li>曲率连续</li>
<li>曲率导数不一定连续【此是大问题，–方向盘突然就打大的角度变化】</li>
</ul>
</li>
</ul>
</li>
<li><p>QP（二次规划）</p>
<ul>
<li><p>凸优化问题最优化求解</p>
</li>
<li><p>公式表达<br>$$<br>minimize \frac{1}{2} X^T QX+c^TX \<br>subject: Ex &#x3D; d , Fx \leqslant m<br>$$</p>
</li>
<li><p>性质：再凸优化中的图空间问题，用QP有最优解</p>
</li>
<li><p>QP如何找到平滑曲线</p>
<ul>
<li>$ min|f’|^2$</li>
<li>$ min|f’’|^2$</li>
<li>$ min|f’’’|^2$</li>
</ul>
</li>
<li><p>其它的平滑曲线方法还有贝塞尔曲线，样条插值方法</p>
</li>
</ul>
</li>
<li><p>刚体模型</p>
</li>
<li><p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_10/image-20220501021506769.png" alt="image-20220501021506769"></p>
<ul>
<li><p>前轮转向和Heading的关系</p>
<ul>
<li>前轮是沿着切线的方向行驶</li>
<li>前后轮是同一个旋转中心</li>
<li>左右轮的结构相同</li>
</ul>
</li>
<li><p>Bicycle Model</p>
</li>
<li><p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_10/image-20220501021446166.png" alt="image-20220501021446166"></p>
<ul>
<li>曲率公式<br>$$<br>\frac{1}{R} &#x3D; kappa &#x3D; (tan(\omega)) &#x2F; L<br>$$</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="无人车Planning"><a href="#无人车Planning" class="headerlink" title="无人车Planning"></a>无人车Planning</h2><ul>
<li><p>定义</p>
<p>从A点到B点，构建一个车辆运动归结，结合HD Map Localization 和Prediction</p>
<ul>
<li>输入</li>
<li>输出：可行是归家，有一系列点组成</li>
<li>两个层面，导航界面，运动轨迹层面</li>
</ul>
</li>
<li><p>Routing</p>
<ul>
<li>导航一条A到B的全局路径</li>
<li>输入：地图（路网信息，交通状态），当前位置，目的地（乘客定）</li>
<li>输出：可行驶道路的连接线</li>
<li>搜索：地图数据转化成图网络<ul>
<li>节点表示道路</li>
<li>边代表道路连接</li>
</ul>
</li>
</ul>
<p><img src="/2022/04/25/Course/AutomaticDrive/AutoDriver_10/image-20220501021924135.png" alt="image-20220501021924135"></p>
</li>
<li><p>A*经典算法</p>
<ul>
<li>最经典的路径查找算法</li>
<li>F(n) &#x3D; G(n) + H(n)</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/15/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><span class="page-number current">16</span><a class="page-number" href="/page/17/">17</a><span class="space">&hellip;</span><a class="page-number" href="/page/33/">33</a><a class="extend next" rel="next" href="/page/17/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Simon Shi</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">322</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">142</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">269</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:yourname@gmail.com" title="E-Mail → mailto:yourname@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Simon Shi</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  

</body>
</html>
