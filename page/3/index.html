<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"novav.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Simon Shi的小站">
<meta property="og:url" content="https://novav.github.io/page/3/index.html">
<meta property="og:site_name" content="Simon Shi的小站">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Simon Shi">
<meta property="article:tag" content="AI,Machine Learning, Deep Learning">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://novav.github.io/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Simon Shi的小站</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Simon Shi的小站</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">人工智能，机器学习， 强化学习，大模型，自动驾驶</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://novav.github.io/2024/10/12/Sub_Language/py_cplus/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Simon Shi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Simon Shi的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/10/12/Sub_Language/py_cplus/" class="post-title-link" itemprop="url">Python call CPlus</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-10-12 00:00:00" itemprop="dateCreated datePublished" datetime="2024-10-12T00:00:00+00:00">2024-10-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-06 08:16:40" itemprop="dateModified" datetime="2025-08-06T08:16:40+00:00">2025-08-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Pybind11-Python-C"><a href="#Pybind11-Python-C" class="headerlink" title="Pybind11 Python C++"></a>Pybind11 Python C++</h2><h3 id="环境安装"><a href="#环境安装" class="headerlink" title="环境安装"></a>环境安装</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda install pybind11 -c conda-forge</span><br></pre></td></tr></table></figure>

<h2 id="绑定一个c-的类"><a href="#绑定一个c-的类" class="headerlink" title="绑定一个c++的类"></a>绑定一个c++的类</h2><h3 id="文件结构"><a href="#文件结构" class="headerlink" title="文件结构"></a>文件结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">src/Person.cpp</span><br><span class="line">    /Person.h</span><br><span class="line">    /p_person.cpp  # pybind文件</span><br></pre></td></tr></table></figure>

<h4 id="Person-cpp"><a href="#Person-cpp" class="headerlink" title="Person.cpp"></a>Person.cpp</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Persion.cpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Person.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">Person::Person() &#123;</span><br><span class="line">    name = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    age = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person::Person(<span class="built_in">string</span> name, <span class="type">int</span> age) &#123;</span><br><span class="line">    this-&gt;name = name;</span><br><span class="line">    this-&gt;age = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person::~Person() &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">Person::say_hello</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello, my name is &quot;</span> + this-&gt;name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Person::set_name</span><span class="params">(<span class="built_in">string</span> name)</span> &#123;</span><br><span class="line">    this-&gt;name = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">Person::set_age</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">    this-&gt;age = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> <span class="title function_">Person::get_name</span><span class="params">()</span> <span class="type">const</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> this-&gt;name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">Person::get_age</span><span class="params">()</span> <span class="type">const</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> this-&gt;age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Person-h"><a href="#Person-h" class="headerlink" title="Person.h"></a>Person.h</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Persion.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> &#123;</span></span><br><span class="line">    public:</span><br><span class="line">        Person();</span><br><span class="line">        Person(<span class="built_in">string</span> name, <span class="type">int</span> age);</span><br><span class="line">        ~Person();</span><br><span class="line"></span><br><span class="line">        <span class="type">void</span> <span class="title function_">set_name</span><span class="params">(<span class="built_in">string</span> name)</span>;</span><br><span class="line">        <span class="type">void</span> <span class="title function_">set_age</span><span class="params">(<span class="type">int</span> age)</span>;</span><br><span class="line">        <span class="built_in">string</span> <span class="title function_">get_name</span><span class="params">()</span> <span class="type">const</span>;</span><br><span class="line">        <span class="type">int</span> <span class="title function_">get_age</span><span class="params">()</span> <span class="type">const</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">string</span> <span class="title function_">say_hello</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private:</span><br><span class="line">        <span class="built_in">string</span> name;</span><br><span class="line">        <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="p-person-cpp"><a href="#p-person-cpp" class="headerlink" title="p_person.cpp"></a>p_person.cpp</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pybind11/pybind11.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;pybind11/stl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Person.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">namespace py = pybind11;</span><br><span class="line"></span><br><span class="line">PYBIND11_MODULE(person, m) </span><br><span class="line">&#123;</span><br><span class="line">    m.doc() = <span class="string">&quot;Person module&quot;</span>; <span class="comment">// optional module docstring</span></span><br><span class="line"></span><br><span class="line">    py::class_&lt;Person&gt;(m, <span class="string">&quot;Person&quot;</span>)</span><br><span class="line">        .def(py::init&lt;&gt;())</span><br><span class="line">        .def(<span class="string">&quot;get_name&quot;</span>, &amp;Person::get_name)</span><br><span class="line">        .def(<span class="string">&quot;set_name&quot;</span>, &amp;Person::set_name)</span><br><span class="line">        .def(<span class="string">&quot;get_age&quot;</span>, &amp;Person::get_age)</span><br><span class="line">        .def(<span class="string">&quot;set_age&quot;</span>, &amp;Person::set_age)</span><br><span class="line">        <span class="comment">// .def(&quot;get_gender&quot;, &amp;Person::get_gender)</span></span><br><span class="line">        <span class="comment">// .def(&quot;set_gender&quot;, &amp;Person::set_gender)</span></span><br><span class="line">        .def(<span class="string">&quot;say_hello&quot;</span>, &amp;Person::say_hello);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="CMakeList-txt"><a href="#CMakeList-txt" class="headerlink" title="CMakeList.txt"></a>CMakeList.txt</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># CMakeLists.txt</span></span><br><span class="line">cmake_minimum_required(VERSION 3.10)</span><br><span class="line"></span><br><span class="line">project(PythonCPPExample)</span><br><span class="line"></span><br><span class="line"><span class="comment"># set(CMAKE_CXX_STANDARD 17)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># add_executable(PythonCPPExample main.cpp)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># find_package(&lt;PackageName&gt; [version] [EXACT] [QUIET] [MODULE]</span></span><br><span class="line">set(PYTHON_EXECUTABLE /root/anaconda3/envs/pytorch_1.7.1_cu92/bin/python3.8)</span><br><span class="line">set(PYTHON_INCLUDE_DIR /root/anaconda3/envs/pytorch_1.7.1_cu92/<span class="keyword">include</span>/python3.8)</span><br><span class="line">set(PYTHON_LIBRARY /root/anaconda3/envs/pytorch_1.7.1_cu92/lib/libpython3.8.so)</span><br><span class="line"></span><br><span class="line">find_package(PythonLibs 3 REQUIRED )</span><br><span class="line"><span class="comment"># 这个文件很重要</span></span><br><span class="line">set(pybind11_DIR /root/anaconda3/envs/pytorch_1.7.1_cu92/share/cmake/pybind11/ ) <span class="comment"># lib/python3.8/site-packages/pybind11 )</span></span><br><span class="line">find_package(pybind11 REQUIRED)</span><br><span class="line"></span><br><span class="line">message(STATUS <span class="string">&quot; -XX- LIb path: $&#123;PYTHON_INCLUDE_DIRS&#125;&quot;</span>)</span><br><span class="line">message(STATUS <span class="string">&quot; -XX- LIb path: $&#123;pybind11_DIR&#125;&quot;</span>)</span><br><span class="line">message(STATUS <span class="string">&quot; -XX- LIb path: $&#123;pybinSHARED &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># add_subdirectory(src)</span></span><br><span class="line"></span><br><span class="line">Pybind11_add_module(person</span><br><span class="line">            src/Person.cpp</span><br><span class="line">   d11_INCLUDE_DIRS&#125;<span class="string">&quot;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># .h 头文件路径</span></span><br><span class="line"><span class="string"># include_directories(</span></span><br><span class="line"><span class="string">#         $&#123;PYTHON_INCLUDE_DIRS&#125;</span></span><br><span class="line"><span class="string">#         &#x27;./src/&#x27;</span></span><br><span class="line"><span class="string">#         $&#123;pybind11_INCLUDE_DIRS&#125;</span></span><br><span class="line"><span class="string">#         )</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 库生成（动态SHARED，静态STATIC）</span></span><br><span class="line"><span class="string"># add_library(person          src/p_person.cpp)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 目标文件依赖库</span></span><br><span class="line"><span class="string"># target_link_libraries(person $&#123;PYTHON_LIBRARIES&#125; pybind11::pybind11)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># install(TARGETS person DESTINATION $&#123;PYTHON_INSTALL_DIR&#125;/site-packages/ )</span></span><br></pre></td></tr></table></figure>

<h3 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir build</span><br><span class="line">cd build</span><br><span class="line">cmake ..</span><br><span class="line">make</span><br></pre></td></tr></table></figure>

<p>最终得到文件</p>
<blockquote>
<p>person.cpython-38-x86_64-linux-gnu.so</p>
</blockquote>
<h2 id="python-Call"><a href="#python-Call" class="headerlink" title="python Call"></a>python Call</h2><ol>
<li>当前环境下 CMakefile的环境下运行</li>
</ol>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> person</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    a = person.Person()</span><br><span class="line">    <span class="comment"># a = person.Person(&#x27;Tom&#x27;, 18)</span></span><br><span class="line">    a.set_name(<span class="string">&quot;Tom&quot;</span>)</span><br><span class="line">    a.set_age(<span class="number">19</span>)</span><br><span class="line">    <span class="built_in">print</span>(a.say_hello())</span><br></pre></td></tr></table></figure>

<p>2、换个环境下运行</p>
<ul>
<li>（此demo）只需要python版本一致，即可运行</li>
</ul>
<h2 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_28087491/article/details/128305877">Python 中如何使用pybind11调用C++_pybind11 python调用c++-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_74083422/article/details/134680380">pybind11：实现Python调用C++代码（入门）-CSDN博客</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://novav.github.io/2024/09/20/Sub_Language/PythonDoc/Language-py-threads/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Simon Shi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Simon Shi的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/09/20/Sub_Language/PythonDoc/Language-py-threads/" class="post-title-link" itemprop="url">Python Thread etc</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-09-20 12:00:00" itemprop="dateCreated datePublished" datetime="2024-09-20T12:00:00+00:00">2024-09-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-06 08:16:40" itemprop="dateModified" datetime="2025-08-06T08:16:40+00:00">2025-08-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/dev/" itemprop="url" rel="index"><span itemprop="name">dev</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/dev/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Thread"><a href="#Thread" class="headerlink" title="Thread"></a>Thread</h2><h3 id="创建Thread方式"><a href="#创建Thread方式" class="headerlink" title="创建Thread方式"></a>创建Thread方式</h3><p><strong>1 实例化Thread类创建线程</strong><br>Thread类对象属性：</p>
<ul>
<li><p>name ：线程名。</p>
</li>
<li><p>ident ：线程标识符。</p>
</li>
<li><p>daemon ：布尔标志，表示这个线程是否是守护线程。</p>
</li>
</ul>
<p>Thread类的构造方法的参数如下：</p>
<p><code>Thread(self,group=None,target=None,name=None,args=(),kwargs=&#123;&#125;,*,daemon=None)</code></p>
<ul>
<li><p>group ：默认为None，该参数不必理会。</p>
</li>
<li><p>target ：指定线程要调用的方法或函数。</p>
</li>
<li><p>name ：指定线程的别名。</p>
</li>
<li><p>args ：指定target所指向的方法或者函数要用到的位置参数。</p>
</li>
<li><p>kwargs ：指定target所指向的方法或者函数要用到的关键字参数。</p>
</li>
<li><p>daemon ：指定线程是否为守护线程。<br>示例：</p>
</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">text</span>():</span><br><span class="line"> <span class="built_in">print</span>(<span class="string">&#x27;thread %s is running.&#x27;</span> % (threading.current_thread().name)</span><br><span class="line"> <span class="built_in">print</span>(<span class="string">&#x27;thread %s end.&#x27;</span> % (threading.current_thread().name))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;thread %s is running.&#x27;</span> % (threading.current_thread().name))</span><br><span class="line">t = threading.Thread(target=text)</span><br><span class="line">t.start()</span><br><span class="line">t.join()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;thread %s end.&#x27;</span> % (threading.current_thread().name))</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">thread MainThread is running.</span><br><span class="line">thread Thread-<span class="number">1</span> is running.</span><br><span class="line">thread Thread-<span class="number">1</span> end.</span><br><span class="line">thread MainThread end.</span><br></pre></td></tr></table></figure>

<p>&lt;分析&gt;</p>
<p>这个例子比较简单，只是简单的展示了创建线程的方法。每一个进程都有一个主线程，主线程是默认启动的，于是可以看到我们只实例化Thread类创建了一个线程，但运行结果却有两个线程。</p>
<p>另外可以发现每一个线程都有一个name，比方说MainThread(主线程)、Thread-1，这个name是哪来的呢？threading模块内有一个current_thread()函数，该函数总是返回当前线程的实例，那么current_thread().name不就是返回当前线程实例的name了么。另外，主线程默认的name就是MainThread，子线程如果没有在创建时指定，那么默认就是Thread-1、Thread-2…以此类推。</p>
<p>另外，启动一个线程的start()方法、用以表示现线程活动的run()方法、等待一个线程结束的join(timeout)方法，判断线程是否”存活”的is_alive()方法…这些方法都和进程中的这些方法完全类似，鉴于有关进程我已经在前两篇介绍过，这里就不再细说。</p>
<p>唯一提一点就是，进程中关于强制终止进程的terminate()方法不适用于Thread对象，唯独这一个不要在线程中去用。</p>
<p>最后，threading模块下除current_thread()之外的其他常用函数：</p>
<ul>
<li>threading.enumerate() ：返回一个包含正在运行的线程的list。</li>
<li>threading.activeCount() ：返回正在运行的线程数量。等价于len(threading.enumerate())。</li>
</ul>
<p>Thread类的一些其它方法：</p>
<ul>
<li><p>getName() : 返回线程名。</p>
</li>
<li><p>setName() ：设置线程名。</p>
</li>
<li><p>isDaemon() ：判断该线程是否是守护线程，是返回True。</p>
</li>
<li><p>setDaemon() ：设置线程的thread.daemon属性，该方法必须在线程start()之前调用。</p>
</li>
</ul>
<p>以上方法都已经不常用，在Python的新版本中，设定name或者daemon属性可以不借助方法直接设定。</p>
<h3 id="2-并发线程"><a href="#2-并发线程" class="headerlink" title="2 并发线程"></a>2 并发线程</h3><p><strong>进程和线程都可以并发执行，但线程由于划分尺度小，因此并发性相比于进程是要高的；另外，创建线程要更加简单，也更易于维护，由于多个线程共享进程的内存空间，这也使得线程更易于通信；除此之外，线程是Python直接支持的，这也简化了多线程的编程。</strong></p>
<p>Python中的多线程也并不全是优点，事实上，Python中的多线程只是表面上的多线程，它和C++或者java中的不同，由于全局解释器锁GIL的存在，Python在一个时刻只会有一个线程在运行，这只是并发而不是并行。所以同样是多线程，java可以充分利用CPU的多核，但Python自始至终只会用到一个核，这就像单核CPU系统的多进程一样，Python的多线程是名不副实的。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">text</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;thread %s is running &gt;&gt; %d&#x27;</span> % (threading.current_thread().name,i))</span><br><span class="line">        <span class="keyword">if</span> i == n-<span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;thread %s end.&#x27;</span> % (threading.current_thread().name))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        sleep(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;thread %s is running.&#x27;</span> % (threading.current_thread().name))</span><br><span class="line">t1 = threading.Thread(target=text,args=(<span class="number">4</span>,))</span><br><span class="line">t2 = threading.Thread(target=text,args=(<span class="number">4</span>,))</span><br><span class="line">t1.start()</span><br><span class="line">t2.start()</span><br><span class="line">t1.join()</span><br><span class="line">t2.join()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;thread %s end&#x27;</span> % (threading.current_thread().name))</span><br></pre></td></tr></table></figure>

<h3 id="3-继承Thread类创建线程"><a href="#3-继承Thread类创建线程" class="headerlink" title="3.继承Thread类创建线程"></a>3.继承Thread类创建线程</h3><p>通过继承Thread，重写Thread类的run()方法得到Thread类的子类，实例化子类也能创建线程。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Another_thread</span>(threading.Thread):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;thread %s is running.&#x27;</span> % (threading.current_thread().name))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;thread %s end.&#x27;</span> % (threading.current_thread().name))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;thread %s is running.&#x27;</span> % (threading.current_thread().name))</span><br><span class="line">t = Another_thread()</span><br><span class="line">t.start()</span><br><span class="line">t.join()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;thread %s end.&#x27;</span> % (threading.current_thread().name))</span><br></pre></td></tr></table></figure>

<p>如上，通过重写Thread类的run()方法，就可以在接下来直接使用Thread的子类创建一个线程，当然也可以重写Thread类的__init__()方法，得到一个令人满意、功能完备的Thread类的子类。这种创建线程的方式更加适合<strong>面向对象编程</strong>。</p>
<h3 id="4-实例化Thread，传入一个类实例"><a href="#4-实例化Thread，传入一个类实例" class="headerlink" title="4. 实例化Thread，传入一个类实例"></a>4. 实例化Thread，传入一个类实例</h3><p>我们一般更倾向于使用上面介绍的两种方法创建线程，在第一种方法中，我们实例化Thread类，并传给它一个函数，第二种方法通过继承Thread得到子类创建线程，而接下来介绍的第三种方法，你会发现<mark>传入一个可调用的类实例</mark>同样可以创建线程。</p>
<p>这种创建线程的方法更加接近于面向对象的多线程编程，相比于传入函数而言具有更高的灵活性。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line">loops = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyThread</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,func,args,name=<span class="string">&#x27;&#x27;</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.name = name</span><br><span class="line">        <span class="variable language_">self</span>.func = func</span><br><span class="line">        <span class="variable language_">self</span>.args = args</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.func(*<span class="variable language_">self</span>.args)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">text</span>(<span class="params">x,sp</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;thread %s is running &gt;&gt; %d.&#x27;</span> % (threading.current_thread().name,x))</span><br><span class="line">    sleep(sp)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;thread %s end.&#x27;</span> % (threading.current_thread().name))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;START!&#x27;</span>)</span><br><span class="line">    threads = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        t = threading.Thread(target=MyThread(text,(i,loops[i])))</span><br><span class="line">        threads.append(t)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        threads[i].start()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        threads[i].join()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;ALL END!&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>START!<br>thread Thread-1 is running &gt;&gt; 0.<br>thread Thread-2 is running &gt;&gt; 1.<br>thread Thread-3 is running &gt;&gt; 2.<br>thread Thread-1 end.<br>thread Thread-2 end.<br>thread Thread-3 end.<br>ALL END!</p>
<p>&lt;分析&gt;</p>
<p>这种创建线程的方法比起前两种应该稍微复杂了一点，但实际上也就是相比于传入函数改为传入一个类，类完全由我们自己定制，构造方法__init__()可以添加任何我们需要的参数，之后注意这个特殊方法__call__()，它调用传入类的函数，并使用我们传入类的参数。</p>
<p>如果我们力求逻辑清晰地快速创建一个线程，任务要求不高，我们倾向于使用第一种创建线程的方法；如果我们需要完全面向对象的多线程编程，我们倾向于使用继承Thread类、实例化子类创建线程的方法，所以这第三种方法的地位有点尴尬，它并不被常用，这里了解一下知道就好。</p>
<h3 id="ref"><a href="#ref" class="headerlink" title="ref:"></a>ref:</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/ckk727/article/details/99717895">Python 三种方法创建线程_python创建线程-CSDN博客</a></p>
<h2 id="asyncio"><a href="#asyncio" class="headerlink" title="asyncio"></a>asyncio</h2><p><code>asyncio</code> 是 Python 中的一个异步 I&#x2F;O 框架，它支持编写并发代码使用协程、多路复用 I&#x2F;O 访问操作以及高级别并发原语（如事件循环、锁、条件变量等）。<code>asyncio</code> 使得 Python 能够高效地处理 I&#x2F;O 密集型任务，如网络请求、文件 I&#x2F;O 等</p>
<ul>
<li><p>并发地 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3.12/library/asyncio-task.html#coroutine">运行 Python 协程</a> 并对其执行过程实现完全控制;</p>
</li>
<li><p>执行 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3.12/library/asyncio-stream.html#asyncio-streams">网络 IO 和 IPC</a>;</p>
</li>
<li><p>控制 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3.12/library/asyncio-subprocess.html#asyncio-subprocess">子进程</a>;</p>
</li>
<li><p>通过 <a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3.12/library/asyncio-queue.html#asyncio-queues">队列</a> 实现分布式任务;</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3.12/library/asyncio-sync.html#asyncio-sync">同步</a> 并发代码;</p>
</li>
</ul>
<h3 id="asyncio-的基本概念"><a href="#asyncio-的基本概念" class="headerlink" title="asyncio 的基本概念"></a>asyncio 的基本概念</h3><ol>
<li><p><strong>事件循环（Event Loop）</strong>：事件循环是 <code>asyncio</code> 的核心组件，它调度协程（coroutines）的执行。事件循环负责管理回调函数的注册和调度。</p>
</li>
<li><p><strong>协程（Coroutines）</strong>：协程是一种特殊的生成器函数，它可以暂停执行并恢复。协程在事件循环中被调度执行。</p>
</li>
<li><p><strong>Future</strong>：<code>Future</code> 是一个特殊类型的对象，代表了将来某个时刻可能会得到的结果。<code>Future</code> 对象可以用来挂起协程的执行，直到结果可用为止。</p>
</li>
<li><p><strong>Task</strong>：<code>Task</code> 是 <code>Future</code> 的子类，用于封装协程的执行。通过 <code>asyncio.create_task()</code> 或 <code>loop.create_task()</code> 创建 <code>Task</code> 对象。</p>
</li>
<li><p><strong>异步函数（Async Functions）</strong>：定义以 <code>async def</code> 开头的函数称为异步函数。异步函数可以使用 <code>await</code> 关键字来等待另一个协程的完成。</p>
</li>
</ol>
<h3 id="asyncio-的基本用法"><a href="#asyncio-的基本用法" class="headerlink" title="asyncio 的基本用法"></a>asyncio 的基本用法</h3><h4 id="创建事件循环"><a href="#创建事件循环" class="headerlink" title="创建事件循环"></a>创建事件循环</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">hello_world</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建事件循环</span></span><br><span class="line">loop = asyncio.get_event_loop()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 运行协程</span></span><br><span class="line">loop.run_until_complete(hello_world())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭事件循环</span></span><br><span class="line">loop.close()</span><br></pre></td></tr></table></figure>

<h4 id="使用-async-和-await"><a href="#使用-async-和-await" class="headerlink" title="使用 async 和 await"></a>使用 <code>async</code> 和 <code>await</code></h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">sleep_and_print</span>(<span class="params">seconds</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Sleeping for <span class="subst">&#123;seconds&#125;</span> seconds...&quot;</span>)</span><br><span class="line">    <span class="keyword">await</span> asyncio.sleep(seconds)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Done sleeping.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">await</span> sleep_and_print(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 运行协程</span></span><br><span class="line">asyncio.run(main())</span><br></pre></td></tr></table></figure>

<p>创建任务</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://novav.github.io/2024/09/08/Sub_Language/API_Web/Fastapi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Simon Shi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Simon Shi的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/09/08/Sub_Language/API_Web/Fastapi/" class="post-title-link" itemprop="url">FastAPI</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-09-08 12:00:00" itemprop="dateCreated datePublished" datetime="2024-09-08T12:00:00+00:00">2024-09-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-06 08:16:40" itemprop="dateModified" datetime="2025-08-06T08:16:40+00:00">2025-08-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/API/" itemprop="url" rel="index"><span itemprop="name">API</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/API/FastAPI/" itemprop="url" rel="index"><span itemprop="name">FastAPI</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>FastAPI 是一个现代、快速（高性能）的 Web 框架，用于构建 APIs，基于 Python 3.7+ 的类型提示。FastAPI 是一个非常流行的选择，因为它提供了很多现代 Web 开发所需的功能，同时保持了简洁性和易用性。</p>
<h3 id="FastAPI-的特点"><a href="#FastAPI-的特点" class="headerlink" title="FastAPI 的特点"></a>FastAPI 的特点</h3><ol>
<li><p><strong>声明式路由</strong>：</p>
<ul>
<li>使用装饰器来定义 API 路由，使代码更加清晰和易于维护。</li>
</ul>
</li>
<li><p><strong>自动文档生成</strong>：</p>
<ul>
<li>自动生成交互式文档（支持 Swagger UI 和 ReDoc），方便测试和文档编写。</li>
</ul>
</li>
<li><p><strong>异步支持</strong>：</p>
<ul>
<li>支持异步请求处理，利用 Python 的 <code>async/await</code> 语法提高性能。</li>
</ul>
</li>
<li><p><strong>类型提示</strong>：</p>
<ul>
<li>利用 Python 的类型提示来自动验证请求和响应数据。</li>
</ul>
</li>
<li><p><strong>依赖注入</strong>：</p>
<ul>
<li>强大的依赖注入系统，简化了服务和组件的管理和注入。</li>
</ul>
</li>
<li><p><strong>性能</strong>：</p>
<ul>
<li>快速响应时间和高吞吐量，适合构建高性能的 API。</li>
</ul>
</li>
</ol>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2024/09/08/Sub_Language/API_Web/Fastapi/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://novav.github.io/2024/09/03/Sub_Language/PythonDoc/Language-mp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Simon Shi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Simon Shi的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/09/03/Sub_Language/PythonDoc/Language-mp/" class="post-title-link" itemprop="url">Python Message Queue</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-09-03 19:00:00" itemprop="dateCreated datePublished" datetime="2024-09-03T19:00:00+00:00">2024-09-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-06 08:16:40" itemprop="dateModified" datetime="2025-08-06T08:16:40+00:00">2025-08-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>消息队列（Message Queue）是一种在分布式系统中进行异步通信的机制。它允许程序之间通过消息进行通信，而不需要直接调用对方。消息队列可以提高系统的可扩展性和容错能力，尤其是在处理高并发请求和异步任务时。</p>
<p>Python 中有几个常用的库可以用来实现消息队列，包括但不限于：</p>
<ol>
<li><strong>RabbitMQ</strong>：使用 AMQP 协议的消息中间件。</li>
<li><strong>Redis</strong>：使用 Redis 的发布&#x2F;订阅功能或列表数据结构实现消息队列。</li>
<li><strong>Kafka</strong>：高性能的分布式消息队列，常用于大数据处理。</li>
<li><strong>Celery</strong>：一个基于分布式消息传递的异步任务队列。</li>
</ol>
<h3 id="示例：使用-RabbitMQ"><a href="#示例：使用-RabbitMQ" class="headerlink" title="示例：使用 RabbitMQ"></a>示例：使用 RabbitMQ</h3><h4 id="安装-RabbitMQ"><a href="#安装-RabbitMQ" class="headerlink" title="安装 RabbitMQ"></a>安装 RabbitMQ</h4><p>首先，你需要安装 RabbitMQ 服务器。你可以从官方网站下载并安装 RabbitMQ，也可以使用包管理器（如 apt-get 或 yum）来安装。</p>
<h4 id="安装-Pika-库"><a href="#安装-Pika-库" class="headerlink" title="安装 Pika 库"></a>安装 Pika 库</h4><p>Pika 是一个 Python 库，用于与 RabbitMQ 交互。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pika</span><br></pre></td></tr></table></figure>

<h4 id="发送消息"><a href="#发送消息" class="headerlink" title="发送消息"></a>发送消息</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pika</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_message</span>(<span class="params">message</span>):</span><br><span class="line">    connection = pika.BlockingConnection(pika.ConnectionParameters(<span class="string">&#x27;localhost&#x27;</span>))</span><br><span class="line">    channel = connection.channel()</span><br><span class="line"></span><br><span class="line">    channel.queue_declare(queue=<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    channel.basic_publish(exchange=<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">                          routing_key=<span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">                          body=message)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot; [x] Sent %r&quot;</span> % message)</span><br><span class="line">    connection.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    send_message(<span class="string">&#x27;Hello World!&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="接收消息"><a href="#接收消息" class="headerlink" title="接收消息"></a>接收消息</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pika</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">receive_message</span>():</span><br><span class="line">    connection = pika.BlockingConnection(pika.ConnectionParameters(<span class="string">&#x27;localhost&#x27;</span>))</span><br><span class="line">    channel = connection.channel()</span><br><span class="line"></span><br><span class="line">    channel.queue_declare(queue=<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">callback</span>(<span class="params">ch, method, properties, body</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot; [x] Received %r&quot;</span> % body)</span><br><span class="line"></span><br><span class="line">    channel.basic_consume(queue=<span class="string">&#x27;hello&#x27;</span>,</span><br><span class="line">                          on_message_callback=callback,</span><br><span class="line">                          auto_ack=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27; [*] Waiting for messages. To exit press CTRL+C&#x27;</span>)</span><br><span class="line">    channel.start_consuming()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    receive_message()</span><br></pre></td></tr></table></figure>

<h3 id="示例：使用-Redis"><a href="#示例：使用-Redis" class="headerlink" title="示例：使用 Redis"></a>示例：使用 Redis</h3><h4 id="安装-Redis"><a href="#安装-Redis" class="headerlink" title="安装 Redis"></a>安装 Redis</h4><p>确保你已经安装了 Redis 服务器。</p>
<h4 id="安装-Redis-库"><a href="#安装-Redis-库" class="headerlink" title="安装 Redis 库"></a>安装 Redis 库</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install redis</span><br></pre></td></tr></table></figure>

<h4 id="发送消息-1"><a href="#发送消息-1" class="headerlink" title="发送消息"></a>发送消息</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_message</span>(<span class="params">message</span>):</span><br><span class="line">    r = redis.Redis(host=<span class="string">&#x27;localhost&#x27;</span>, port=<span class="number">6379</span>, db=<span class="number">0</span>)</span><br><span class="line">    r.lpush(<span class="string">&#x27;queue:messages&#x27;</span>, message)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot; [x] Sent %r&quot;</span> % message)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    send_message(<span class="string">&#x27;Hello World!&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="接收消息-1"><a href="#接收消息-1" class="headerlink" title="接收消息"></a>接收消息</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">receive_message</span>():</span><br><span class="line">    r = redis.Redis(host=<span class="string">&#x27;localhost&#x27;</span>, port=<span class="number">6379</span>, db=<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        message = r.rpop(<span class="string">&#x27;queue:messages&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> message:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot; [x] Received %r&quot;</span> % message.decode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    receive_message()</span><br></pre></td></tr></table></figure>

<h3 id="示例：使用-Celery"><a href="#示例：使用-Celery" class="headerlink" title="示例：使用 Celery"></a>示例：使用 Celery</h3><h4 id="安装-Celery"><a href="#安装-Celery" class="headerlink" title="安装 Celery"></a>安装 Celery</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install celery</span><br></pre></td></tr></table></figure>

<h4 id="配置-Celery"><a href="#配置-Celery" class="headerlink" title="配置 Celery"></a>配置 Celery</h4><p>创建一个配置文件 <code>celeryconfig.py</code>：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">broker_url = <span class="string">&#x27;redis://localhost:6379/0&#x27;</span></span><br><span class="line">result_backend = <span class="string">&#x27;redis://localhost:6379/0&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="定义任务"><a href="#定义任务" class="headerlink" title="定义任务"></a>定义任务</h4><p>创建一个任务文件 <code>tasks.py</code>：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> celery <span class="keyword">import</span> Celery</span><br><span class="line"></span><br><span class="line">app = Celery(<span class="string">&#x27;tasks&#x27;</span>, broker=<span class="string">&#x27;redis://localhost:6379/0&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.task</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="keyword">return</span> x + y</span><br></pre></td></tr></table></figure>

<h4 id="发送任务"><a href="#发送任务" class="headerlink" title="发送任务"></a>发送任务</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> tasks <span class="keyword">import</span> add</span><br><span class="line"></span><br><span class="line">result = add.delay(<span class="number">4</span>, <span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(result.ready())  <span class="comment"># False</span></span><br><span class="line"><span class="built_in">print</span>(result.get(timeout=<span class="number">1</span>))  <span class="comment"># 8</span></span><br></pre></td></tr></table></figure>

<h4 id="启动-Celery-工作者"><a href="#启动-Celery-工作者" class="headerlink" title="启动 Celery 工作者"></a>启动 Celery 工作者</h4><p>在命令行中启动 Celery 工作者：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">celery -A tasks worker --loglevel=info</span><br></pre></td></tr></table></figure>

<h3 id="示例：使用-Kafka"><a href="#示例：使用-Kafka" class="headerlink" title="示例：使用 Kafka"></a>示例：使用 Kafka</h3><h4 id="安装-Kafka"><a href="#安装-Kafka" class="headerlink" title="安装 Kafka"></a>安装 Kafka</h4><p>确保你已经安装了 Kafka 服务器。</p>
<h4 id="安装-Kafka-Python-库"><a href="#安装-Kafka-Python-库" class="headerlink" title="安装 Kafka-Python 库"></a>安装 Kafka-Python 库</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install kafka-python</span><br></pre></td></tr></table></figure>

<h4 id="发送消息-2"><a href="#发送消息-2" class="headerlink" title="发送消息"></a>发送消息</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> kafka <span class="keyword">import</span> KafkaProducer</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_message</span>(<span class="params">message</span>):</span><br><span class="line">    producer = KafkaProducer(bootstrap_servers=<span class="string">&#x27;localhost:9092&#x27;</span>,</span><br><span class="line">                             value_serializer=<span class="keyword">lambda</span> v: json.dumps(v).encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    future = producer.send(<span class="string">&#x27;my-topic&#x27;</span>, value=message)</span><br><span class="line">    result = future.get(timeout=<span class="number">60</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot; [x] Sent %r&quot;</span> % message)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    send_message(&#123;<span class="string">&#x27;key&#x27;</span>: <span class="string">&#x27;value&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="接收消息-2"><a href="#接收消息-2" class="headerlink" title="接收消息"></a>接收消息</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> kafka <span class="keyword">import</span> KafkaConsumer</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">receive_message</span>():</span><br><span class="line">    consumer = KafkaConsumer(<span class="string">&#x27;my-topic&#x27;</span>,</span><br><span class="line">                             bootstrap_servers=<span class="string">&#x27;localhost:9092&#x27;</span>,</span><br><span class="line">                             value_deserializer=<span class="keyword">lambda</span> m: json.loads(m.decode(<span class="string">&#x27;utf-8&#x27;</span>)))</span><br><span class="line">    <span class="keyword">for</span> message <span class="keyword">in</span> consumer:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot; [x] Received %r&quot;</span> % message.value)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    receive_message()</span><br></pre></td></tr></table></figure>

<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>以上是几个常用的消息队列实现示例。选择哪种消息队列取决于你的具体需求和场景：</p>
<ul>
<li><strong>RabbitMQ</strong>：适用于需要可靠的消息传递和复杂的路由规则的场景。</li>
<li><strong>Redis</strong>：适用于简单的消息队列，易于部署和使用。</li>
<li><strong>Kafka</strong>：适用于大数据处理和流式处理的场景。</li>
<li><strong>Celery</strong>：适用于异步任务队列和定时任务。</li>
</ul>
<p>如果你有其他具体的需求或问题，请告诉我，我可以进一步帮助你。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://novav.github.io/2024/08/29/AI/hug_download/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Simon Shi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Simon Shi的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/08/29/AI/hug_download/" class="post-title-link" itemprop="url">huggingface hub</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-08-29 12:00:00" itemprop="dateCreated datePublished" datetime="2024-08-29T12:00:00+00:00">2024-08-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-06 08:16:38" itemprop="dateModified" datetime="2025-08-06T08:16:38+00:00">2025-08-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="Download"><a href="#Download" class="headerlink" title="Download"></a>Download</h3><p>Qwen</p>
<p>StableDiffusion</p>
<ul>
<li><p><input checked disabled type="checkbox"> 
openai&#x2F;clip-vit-large-patch14</p>
</li>
<li><p><input checked disabled type="checkbox"> 
&#x2F;databig&#x2F;ddz&#x2F;sdiffusion&#x2F;stable-diffusion-main&#x2F;openai&#x2F;clip-vit-large-patch14&#x2F;</p>
</li>
</ul>
<p>StableDiffusion2</p>
<ul>
<li><input disabled type="checkbox"> stabilityai&#x2F;stable-diffusion-2</li>
</ul>
<p>SD-WebUI</p>
<p>ComfyUI</p>
<p>StoryDifusion</p>
<ul>
<li><p><input disabled type="checkbox"> 
“<a target="_blank" rel="noopener" href="https://weights.replicate.delivery/default/HVision_NKU/StoryDiffusion.tar">https://weights.replicate.delivery/default/HVision_NKU/StoryDiffusion.tar</a>“</p>
</li>
<li><p><input disabled type="checkbox"> 
TencentARC&#x2F;PhotoMaker</p>
<ul>
<li><p>stabilityai&#x2F;stable-diffusion-xl-base-1.0</p>
</li>
<li><p>[RealVision] SG161222&#x2F;RealVisXL_V4.0</p>
</li>
<li><p>[unstable] stablediffusionapi&#x2F;sdxl-unstable-diffusers-y</p>
</li>
</ul>
</li>
<li><p><input disabled type="checkbox"> 
TencentARC&#x2F;PhotoMaker-V2</p>
</li>
<li><p><input disabled type="checkbox"> </p>
</li>
</ul>
<p>Flux</p>
<ul>
<li><p><input disabled type="checkbox"> 
black-forest-labs&#x2F;FLUX.1-dev</p>
</li>
<li><p><input disabled type="checkbox"> 
black-forest-labs&#x2F;FLUX.1-schnell</p>
</li>
<li><p><input disabled type="checkbox"> 
google&#x2F;t5-v1_1-xxl   90G</p>
</li>
<li><p><input disabled type="checkbox"> 
openai&#x2F;clip-vit-large-patch14    6G</p>
</li>
</ul>
<h4 id="换脸"><a href="#换脸" class="headerlink" title="换脸"></a>换脸</h4><p>roop</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/s0md3v/roop">https://github.com/s0md3v/roop</a></li>
</ul>
<p>Deep-live-cam</p>
<ul>
<li>hacksider&#x2F;deep-live-cam</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://novav.github.io/2024/08/29/Sub_Language/API_Web/ComfyUI/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Simon Shi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Simon Shi的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/08/29/Sub_Language/API_Web/ComfyUI/" class="post-title-link" itemprop="url">ComfyUI Deploy</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-08-29 12:00:00" itemprop="dateCreated datePublished" datetime="2024-08-29T12:00:00+00:00">2024-08-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-06 08:16:40" itemprop="dateModified" datetime="2025-08-06T08:16:40+00:00">2025-08-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/662041596"># ComfyUI介绍(官方直译)详细部署教程和使用</a></p>
<p>从零开始教你玩转ComfyUI-保姆级部署教程-手把手带你ComfyUI工作流搭建</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_37863729/article/details/141216314">从零开始教你玩转ComfyUI-保姆级部署教程-手把手带你ComfyUI工作流搭建-CSDN博客</a></p>
<p>实战</p>
<p><a target="_blank" rel="noopener" href="https://www.esheep.com/app/5143?form=run_app&utm_source=draw_tab&post_id=65019">eSheep(内测中) -# 古风山水姓氏头像- 一站式的AIGC社区</a></p>
<p><a target="_blank" rel="noopener" href="https://www.1ai.net/17453.html">ComfyUI使用中文提示词，手把手教你用中文代替提示词 - ai,人工智能,1ai.net</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://novav.github.io/2024/08/27/AI_ROBOT/ROS_STM32/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Simon Shi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Simon Shi的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/08/27/AI_ROBOT/ROS_STM32/" class="post-title-link" itemprop="url">ROS 与 STM32 串口通信</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-08-27 12:00:00" itemprop="dateCreated datePublished" datetime="2024-08-27T12:00:00+00:00">2024-08-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-06 08:16:38" itemprop="dateModified" datetime="2025-08-06T08:16:38+00:00">2025-08-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id><a href="#" class="headerlink" title></a></h3><h3 id="Topic-Example"><a href="#Topic-Example" class="headerlink" title="Topic Example"></a>Topic Example</h3><p>STM32端</p>
<blockquote>
<p> D:\xx\projects\robot\Ackerman-Car\ackerman-car-ros1\STM32和ROS串口通信分享\ALIENTEK MINISTM32 实验3 串口实验</p>
<p>D:\xx\projects\robot\Ackerman-Car\Ackerman-Car-ROS2-Driver\</p>
</blockquote>
<p>ROS端</p>
<blockquote>
<p>D:\shixx\projects\robot\Ackerman-Car\ackerman-car-ros1\STM32和ROS串口通信分享\topic_example\include\topic_example</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd catkin_ws_test</span><br><span class="line">source devel/setup.bash</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">启动功能包节点</span></span><br><span class="line">rosrun topic_example publish_node</span><br><span class="line">rosrun topic_example publish_n</span><br></pre></td></tr></table></figure>

</blockquote>
<h3 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import serial</span><br><span class="line">dev=serial.Serial(&#x27;/dev/ttyUSB1&#x27;,115200,timeout=0.5)</span><br><span class="line">dev.readlines()</span><br></pre></td></tr></table></figure>



      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://novav.github.io/2024/08/26/AI_ROBOT/ROS2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Simon Shi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Simon Shi的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/08/26/AI_ROBOT/ROS2/" class="post-title-link" itemprop="url">ROS2</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-08-26 19:00:00" itemprop="dateCreated datePublished" datetime="2024-08-26T19:00:00+00:00">2024-08-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-06 08:16:38" itemprop="dateModified" datetime="2025-08-06T08:16:38+00:00">2025-08-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="install-ROS2"><a href="#install-ROS2" class="headerlink" title="install ROS2"></a>install ROS2</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update &amp;&amp; sudo apt install curl gnupg2 lsb-release</span><br><span class="line">curl -s https://raw.githubusercontent.com/ros/rosdistro/master/ros.asc | sudo apt-key add -</span><br><span class="line">sudo sh -c &#x27;echo &quot;deb [arch=$(dpkg --print-architecture)] http://packages.ros.org/ros2/ubuntu $(lsb_release -cs) main&quot; &gt; /etc/apt/sources.list.d/ros2-latest.list&#x27;</span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install ros-foxy-desktop</span><br><span class="line">echo &quot;source /opt/ros/foxy/setup.bash&quot; &gt;&gt; ~/.bashrc</span><br><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sudo apt install colcon-common-extensions</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">sudo</span> apt install python3-colcon-common-extensions</span><br></pre></td></tr></table></figure>

<h3 id="Build"><a href="#Build" class="headerlink" title="Build"></a>Build</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">colcon build --packages-select mbot_description</span><br><span class="line">colcon build --packages-select mbot_bringup</span><br><span class="line">colcon build --packages-select sllidar_ros2</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ros2 launch mbot_description gazebo.launch</span></span><br><span class="line">source ~/ros2_ws/install/setup.bash</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ubuntu@ubuntu:~/ros2_ws$ colcon build --packages-select sllidar_ros2</span></span><br><span class="line">[3.464s] WARNING:colcon.colcon_cmake.package_identification.cmake:Ignoring &#x27;src/CMakeLists.txt&#x27; since it seems to be a toplevel CMake file generated by &#x27;catkin_make&#x27;</span><br><span class="line">Starting &gt;&gt;&gt; sllidar_ros2</span><br><span class="line">Finished &lt;&lt;&lt; sllidar_ros2 [2.22s]                     </span><br><span class="line"></span><br><span class="line">Summary: 1 package finished [4.26s]</span><br><span class="line">ubuntu@ubuntu:~/ros2_ws$ </span><br><span class="line">ubuntu@ubuntu:~/ros2_ws$ colcon build --packages-select mbot_description</span><br><span class="line">[3.425s] WARNING:colcon.colcon_cmake.package_identification.cmake:Ignoring &#x27;src/CMakeLists.txt&#x27; since it seems to be a toplevel CMake file generated by &#x27;catkin_make&#x27;</span><br><span class="line">Starting &gt;&gt;&gt; mbot_description</span><br><span class="line">Finished &lt;&lt;&lt; mbot_description [10.8s]            </span><br><span class="line"></span><br><span class="line">Summary: 1 package finished [12.8s]</span><br><span class="line">ubuntu@ubuntu:~/ros2_ws$ </span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install software-properties-common</span><br><span class="line">sudo add-apt-repository universe</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">&quot;deb http://packages.ros.org/ros2/ubuntu <span class="subst">$(lsb_release -cs)</span> main&quot;</span></span></span><br><span class="line">sudo add-apt-repository &quot;deb http://packages.ros.org/ros2/ubuntu $(lsb_release -cs) main&quot;</span><br><span class="line">sudo apt install curl</span><br><span class="line">curl -s https://raw.githubusercontent.com/ros/rosdistro/master/ros.asc | sudo apt-key add -</span><br></pre></td></tr></table></figure>

<h4 id="BUG-思路-foxy"><a href="#BUG-思路-foxy" class="headerlink" title="BUG 思路 (foxy)"></a>BUG 思路 (foxy)</h4><p>1、报错日志，百度+通义千问，给出了解决方案（但是代码实现跟本地不一致，硬套失败）</p>
<p>2、AI给的解决方案，都是成员函数的bind，没转换过来思路（总以为是参数的原因）</p>
<ul>
<li><code>cmdCallback3</code>函数不是一个类成员函数，因此不能使用<code>std::bind</code>与<code>this</code>结合的方式绑定到订阅器上。如果<code>cmdCallback3</code>确实是类的成员函数，那么它应该被声明为该类的一个成员，并且需要使用正确的绑定方式。</li>
<li>实际上，不需要bind，就是原本的参数方式！！！！！！</li>
</ul>
<p>3、阅读源码，（确认了calback3的参数与回调函数的模板一致）<br>&#x2F;opt&#x2F;ros&#x2F;foxy&#x2F;include&#x2F;rclcpp&#x2F;rclcpp.hpp</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* - Subscription</span><br><span class="line">*   - rclcpp::Node::create_subscription()</span><br><span class="line">*   - rclcpp::Subscription</span><br><span class="line">*   - rclcpp/subscription.hpp</span><br></pre></td></tr></table></figure>

<p>查到实现subscribe的代码：</p>
<p> &#x2F;opt&#x2F;ros&#x2F;foxy&#x2F;include&#x2F;rclcpp&#x2F;subscription.hpp</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// Default constructor.</span></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * The constructor for a subscription is almost never called directly.</span></span><br><span class="line"><span class="comment">   * Instead, subscriptions should be instantiated through the function</span></span><br><span class="line"><span class="comment">   * rclcpp::create_subscription().</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line">Subscription(</span><br><span class="line">    rclcpp::node_interfaces::NodeBaseInterface * node_base,</span><br><span class="line">    <span class="type">const</span> <span class="type">rosidl_message_type_support_t</span> &amp; type_support_handle,</span><br><span class="line">    <span class="type">const</span> <span class="built_in">std</span>::<span class="built_in">string</span> &amp; topic_name,</span><br><span class="line">    <span class="type">const</span> rclcpp::QoS &amp; qos,</span><br><span class="line">    AnySubscriptionCallback&lt;CallbackMessageT, AllocatorT&gt; callback,</span><br><span class="line">    <span class="type">const</span> rclcpp::SubscriptionOptionsWithAllocator&lt;AllocatorT&gt; &amp; options,</span><br><span class="line">    typename MessageMemoryStrategyT::SharedPtr message_memory_strategy,</span><br><span class="line">    SubscriptionTopicStatisticsSharedPtr subscription_topic_statistics = nullptr)</span><br><span class="line"></span><br><span class="line">确认回调入口：AnySubscriptionCallback</span><br><span class="line"></span><br><span class="line">AnySubscriptionCallback&lt;CallbackMessageT, AllocatorT&gt; any_callback_;</span><br></pre></td></tr></table></figure>

<p>    vim &#x2F;opt&#x2F;ros&#x2F;foxy&#x2F;include&#x2F;rclcpp&#x2F;any_subscription_callback.hpp</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">AnySubscriptionCallback</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  using SharedPtrCallback = <span class="built_in">std</span>::function&lt;<span class="type">void</span> (<span class="type">const</span> <span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;MessageT&gt;)&gt;;</span><br><span class="line">  using SharedPtrWithInfoCallback =</span><br><span class="line">   <span class="built_in">std</span>::function&lt;<span class="type">void</span> (<span class="type">const</span> <span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;MessageT&gt;, <span class="type">const</span> rclcpp::MessageInfo &amp;)&gt;;</span><br><span class="line">   <span class="comment">// const 单个参数的，就这个了！！！！！！！！</span></span><br><span class="line">  using ConstSharedPtrCallback = <span class="built_in">std</span>::function&lt;<span class="type">void</span> (<span class="type">const</span> <span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;<span class="type">const</span> MessageT&gt;)&gt;;</span><br><span class="line">  using ConstSharedPtrWithInfoCallback =</span><br><span class="line">    <span class="built_in">std</span>::function&lt;<span class="type">void</span> (<span class="type">const</span> <span class="built_in">std</span>::<span class="built_in">shared_ptr</span>&lt;<span class="type">const</span> MessageT&gt;, <span class="type">const</span> rclcpp::MessageInfo &amp;)&gt;;</span><br><span class="line">  using UniquePtrCallback = <span class="built_in">std</span>::function&lt;<span class="type">void</span> (MessageUniquePtr)&gt;;</span><br><span class="line">  using UniquePtrWithInfoCallback =</span><br><span class="line">    <span class="built_in">std</span>::function&lt;<span class="type">void</span> (MessageUniquePtr, <span class="type">const</span> rclcpp::MessageInfo &amp;)&gt;;</span><br></pre></td></tr></table></figure>

<p>4、Finally</p>
<p>Build  PASS</p>
<h2 id="RUN"><a href="#RUN" class="headerlink" title="RUN"></a>RUN</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$</span><span class="language-bash">ros2 launch mbot_bringup mbot_with_lidar_launch.py</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://novav.github.io/2024/08/26/AI_ROBOT/ROS_Ackerman/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Simon Shi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Simon Shi的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/08/26/AI_ROBOT/ROS_Ackerman/" class="post-title-link" itemprop="url">ROS2 Ackerman Car (小白学移动机器人)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-08-26 19:00:00" itemprop="dateCreated datePublished" datetime="2024-08-26T19:00:00+00:00">2024-08-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-06 08:16:38" itemprop="dateModified" datetime="2025-08-06T08:16:38+00:00">2025-08-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>car  code</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">└──src</span><br><span class="line">    ├── mbot_bringup</span><br><span class="line">    ├── mbot_description</span><br><span class="line">    └──sllidar_ros2-humble</span><br></pre></td></tr></table></figure>

<h4 id="编译"><a href="#编译" class="headerlink" title="编译"></a>编译</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd ~/ros2_ws</span><br><span class="line">colcon build # 一起编译，若出现编译错误，可以单个单个编译功能包</span><br><span class="line">colcon build --packages-select mbot_description</span><br><span class="line">colcon build --packages-select mbot_bringup</span><br><span class="line">colcon build --packages-select sllidar_ros2</span><br></pre></td></tr></table></figure>

<h4 id="刷新"><a href="#刷新" class="headerlink" title="刷新"></a>刷新</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">source ~/ros2_ws/install/setup.bash</span><br><span class="line">or</span><br><span class="line">echo &quot;source ~/ros2_ws/install/setup.bash&quot; &gt;&gt; ~/.bashrc</span><br></pre></td></tr></table></figure>

<h4 id="端口配置"><a href="#端口配置" class="headerlink" title="端口配置"></a>端口配置</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/udev/rules.d/</span><br><span class="line">sudo vi 99-robot-usb.rules</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">KERNELS==&quot;1-1&quot;, ATTRS&#123;idVendor&#125;==&quot;1a86&quot;, ATTRS&#123;idProduct&#125;==&quot;7523&quot;,</span><br><span class="line">SYMLINK+=&quot;mbot&quot;,MODE:=&quot;0777&quot;</span><br><span class="line">KERNELS==&quot;6-1&quot;, ATTRS&#123;idVendor&#125;==&quot;10c4&quot;, ATTRS&#123;idProduct&#125;==&quot;ea60&quot;,</span><br><span class="line">SYMLINK+=&quot;lidar&quot;,MODE:=&quot;0777&quot;</span><br><span class="line">KERNELS==&quot;5-1&quot;, ATTRS&#123;idVendor&#125;==&quot;10c4&quot;, ATTRS&#123;idProduct&#125;==&quot;ea60&quot;,</span><br><span class="line">SYMLINK+=&quot;camera&quot;,MODE:=&quot;0777&quot;</span><br></pre></td></tr></table></figure>

<p>查看串口设备</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">udevadm info -a -p $(udevadm info -q path -n /dev/ttyUSB0)</span><br><span class="line"></span><br><span class="line">ls /dev | grep ttyUSB</span><br></pre></td></tr></table></figure>

<p><img src="/2024/08/26/AI_ROBOT/ROS_Ackerman/2024-08-26-20-48-04-image.png"></p>
<h5 id="Serial"><a href="#Serial" class="headerlink" title="Serial"></a>Serial</h5><blockquote>
<p>&#x2F;dev&#x2F;serial</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">looking at parent device &#x27;/devices/platform/scb/fd500000.pcie/pci0000:00/0000:00:00.0/0000:01:00.0/usb1/1-1/1-1.2&#x27;:</span><br><span class="line">    KERNELS==&quot;1-1.2&quot;</span><br><span class="line">    ATTRS&#123;idVendor&#125;==&quot;1a86&quot;</span><br><span class="line">    ATTRS&#123;devspec&#125;==&quot;(null)&quot;</span><br><span class="line">    ATTRS&#123;devpath&#125;==&quot;1.2&quot;</span><br><span class="line">    ATTRS&#123;idProduct&#125;==&quot;7523&quot;</span><br><span class="line"></span><br><span class="line">KERNELS==&quot;1-1.2&quot;,ATTRS&#123;idVendor&#125;==&quot;1a86&quot;, ATTRS&#123;idProduct&#125;==&quot;7523&quot;,SYMLINK+=&quot;mbot&quot;, MODE:=&quot;0777&quot;</span><br></pre></td></tr></table></figure>

<h5 id="Lidar"><a href="#Lidar" class="headerlink" title="Lidar"></a>Lidar</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">KERNELS==&quot;1-1.1&quot;, ATTRS&#123;idVendor&#125;==&quot;10c4&quot;, ATTRS&#123;idProduct&#125;==&quot;ea60&quot;, SYMLINK+=&quot;lidar&quot;, MODE:=&quot;0777&quot;</span><br><span class="line"></span><br><span class="line">KERNELS==&quot;1-1&quot;, ATTRS&#123;idVendor&#125;==&quot;2109&quot;, ATTRS&#123;idProduct&#125;==&quot;3431&quot;, SYMLINK+=&quot;lidar&quot;, MODE:=&quot;0777&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">looking at parent device &#x27;/devices/platform/scb/fd500000.pcie/pci0000:00/0000:00:00.0/0000:01:00.0/usb1/1-1&#x27;:</span><br><span class="line">    KERNELS==&quot;1-1&quot;</span><br><span class="line">    SUBSYSTEMS==&quot;usb&quot;</span><br><span class="line">    DRIVERS==&quot;usb&quot;</span><br><span class="line">    ATTRS&#123;speed&#125;==&quot;480&quot;</span><br><span class="line">    ATTRS&#123;authorized&#125;==&quot;1&quot;</span><br><span class="line">    ATTRS&#123;bMaxPower&#125;==&quot;100mA&quot;</span><br><span class="line">    ATTRS&#123;devspec&#125;==&quot;(null)&quot;</span><br><span class="line">    ATTRS&#123;product&#125;==&quot;USB2.0 Hub&quot;</span><br><span class="line">    ATTRS&#123;busnum&#125;==&quot;1&quot;</span><br><span class="line">    ATTRS&#123;ltm_capable&#125;==&quot;no&quot;</span><br><span class="line">    ATTRS&#123;avoid_reset_quirk&#125;==&quot;0&quot;</span><br><span class="line">    ATTRS&#123;bDeviceSubClass&#125;==&quot;00&quot;</span><br><span class="line">    ATTRS&#123;idVendor&#125;==&quot;2109&quot;</span><br><span class="line">    ATTRS&#123;bConfigurationValue&#125;==&quot;1&quot;</span><br><span class="line">    ATTRS&#123;rx_lanes&#125;==&quot;1&quot;</span><br><span class="line">    ATTRS&#123;tx_lanes&#125;==&quot;1&quot;</span><br><span class="line">    ATTRS&#123;quirks&#125;==&quot;0x0&quot;</span><br><span class="line">    ATTRS&#123;bcdDevice&#125;==&quot;0421&quot;</span><br><span class="line">    ATTRS&#123;bDeviceProtocol&#125;==&quot;01&quot;</span><br><span class="line">    ATTRS&#123;bmAttributes&#125;==&quot;e0&quot;</span><br><span class="line">    ATTRS&#123;configuration&#125;==&quot;&quot;</span><br><span class="line">    ATTRS&#123;devnum&#125;==&quot;2&quot;</span><br><span class="line">    ATTRS&#123;devpath&#125;==&quot;1&quot;</span><br><span class="line">    ATTRS&#123;bDeviceClass&#125;==&quot;09&quot;</span><br><span class="line">    ATTRS&#123;urbnum&#125;==&quot;38&quot;</span><br><span class="line">    ATTRS&#123;version&#125;==&quot; 2.10&quot;</span><br><span class="line">    ATTRS&#123;maxchild&#125;==&quot;4&quot;</span><br><span class="line">    ATTRS&#123;idProduct&#125;==&quot;3431&quot;</span><br><span class="line">    ATTRS&#123;removable&#125;==&quot;unknown&quot;</span><br><span class="line">    ATTRS&#123;bNumConfigurations&#125;==&quot;1&quot;</span><br><span class="line">    ATTRS&#123;bMaxPacketSize0&#125;==&quot;64&quot;</span><br><span class="line">    ATTRS&#123;bNumInterfaces&#125;==&quot; 1&quot;</span><br></pre></td></tr></table></figure>

<h3 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h3><p>1.线路都链接正确且正常（单片机-&gt;香橙派）(激光雷达-&gt;香橙派)<br>2.单片机正常且烧录好程序</p>
<h4 id="mbot-with-lidar-launch-py"><a href="#mbot-with-lidar-launch-py" class="headerlink" title="mbot_with_lidar_launch.py"></a>mbot_with_lidar_launch.py</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ros2 launch mbot_bringup mbot_with_lidar_launch.py</span><br></pre></td></tr></table></figure>

<p>[mbot_bringup-1] [INFO] [1666446425.232926736] [mbot_bringup]: y_:-0.006942<br>[mbot_bringup-1]<br>[mbot_bringup-1] [INFO] [1666446425.233090570] [mbot_bringup]: th_:338.204911<br>[mbot_bringup-1]<br>[mbot_bringup-1] [INFO] [1666446425.253658500] [mbot_bringup]: dt:0.021006<br>[mbot_bringup-1]<br>[mbot_bringup-1] [INFO] [1666446425.253865001] [mbot_bringup]: x_:-0.004255<br>[mbot_bringup-1]<br>[mbot_bringup-1] [INFO] [1666446425.253914877] [mbot_bringup]: y_:-0.006942</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">ubuntu@ubuntu:~/ros2_ws$ ros2 launch mbot_bringup mbot_with_lidar_launch.py</span><br><span class="line">[INFO] [launch]: All log files can be found below /home/ubuntu/.ros/log/2024-08-26-14-58-42-813855-ubuntu-2195</span><br><span class="line">[INFO] [launch]: Default logging verbosity is set to INFO</span><br><span class="line">[INFO] [mbot_bringup-1]: process started with pid [2197]</span><br><span class="line">[INFO] [robot_state_publisher-2]: process started with pid [2199]</span><br><span class="line">[INFO] [joint_state_publisher-3]: process started with pid [2201]</span><br><span class="line">[INFO] [sllidar_node-4]: process started with pid [2203]</span><br><span class="line">[robot_state_publisher-2] Parsing robot urdf xml string.</span><br><span class="line">[robot_state_publisher-2] The root link base_link has an inertia specified in the URDF, but KDL does not support a root link with an inertia.  As a w you can add an extra dummy link to your URDF.</span><br><span class="line">[robot_state_publisher-2] Link lidar_link had 0 children</span><br><span class="line">[robot_state_publisher-2] Link right_back_wheel had 0 children</span><br><span class="line">[robot_state_publisher-2] Link left_back_wheel had 0 children</span><br><span class="line">[robot_state_publisher-2] [INFO] [1724684323.340970547] [robot_state_publisher]: got segment base_link</span><br><span class="line">[robot_state_publisher-2] [INFO] [1724684323.341309405] [robot_state_publisher]: got segment left_back_wheel</span><br><span class="line">[robot_state_publisher-2] [INFO] [1724684323.341378643] [robot_state_publisher]: got segment lidar_link</span><br><span class="line">[robot_state_publisher-2] [INFO] [1724684323.341410586] [robot_state_publisher]: got segment right_back_wheel</span><br><span class="line">[sllidar_node-4] [INFO] [1724684323.348386895] [sllidar_node]: SLLidar running on ROS2 package SLLidar.ROS2 SDK Version:1.0.1, SLLIDAR SDK Version:2.</span><br><span class="line">[sllidar_node-4] [INFO] [1724684323.402525357] [sllidar_node]: SLLidar S/N: DCA19DF1C3E39AC4C3E698F92C76340D</span><br><span class="line">[sllidar_node-4] [INFO] [1724684323.402664611] [sllidar_node]: Firmware Ver: 1.27</span><br><span class="line">[sllidar_node-4] [INFO] [1724684323.402700369] [sllidar_node]: Hardware Rev: 5</span><br><span class="line">[sllidar_node-4] [INFO] [1724684323.454031586] [sllidar_node]: SLLidar health status : 0</span><br><span class="line">[sllidar_node-4] [INFO] [1724684323.454176081] [sllidar_node]: SLLidar health status : OK.</span><br><span class="line">[joint_state_publisher-3] [INFO] [1724684324.977991460] [joint_state_publisher]: Waiting for robot_description to be published on the robot_descripti.</span><br><span class="line">[sllidar_node-4] [ERROR] [1724684327.485681561] [sllidar_node]: Can not start scan: 80008000!</span><br><span class="line">^C[WARNING] [launch]: user interrupted with ctrl-c (SIGINT)</span><br><span class="line">[mbot_bringup-1] [INFO] [1724684379.574944583] [rclcpp]: signal_handler(signal_value=2)</span><br><span class="line">[mbot_bringup-1] [INFO] [1724684379.575556968] [mbot_bringup]: dt:56.246054</span><br><span class="line">[mbot_bringup-1] </span><br><span class="line">[mbot_bringup-1] [INFO] [1724684379.575648558] [mbot_bringup]: x_:0.000000</span><br><span class="line">[mbot_bringup-1] </span><br><span class="line">[mbot_bringup-1] [INFO] [1724684379.575687038] [mbot_bringup]: y_:0.000000</span><br><span class="line">[mbot_bringup-1] </span><br><span class="line">[mbot_bringup-1] [INFO] [1724684379.575721333] [mbot_bringup]: th_:0.000000</span><br><span class="line">[mbot_bringup-1] </span><br><span class="line">[robot_state_publisher-2] [INFO] [1724684379.576430992] [rclcpp]: signal_handler(signal_value=2)</span><br><span class="line">[INFO] [robot_state_publisher-2]: process has finished cleanly [pid 2199]</span><br><span class="line">[INFO] [mbot_bringup-1]: process has finished cleanly [pid 2197]</span><br><span class="line">[INFO] [joint_state_publisher-3]: process has finished cleanly [pid 2201]</span><br><span class="line">[sllidar_node-4] [INFO] [1724684381.596310322] [sllidar_node]: Stop motor</span><br><span class="line">[INFO] [sllidar_node-4]: process has finished cleanly [pid 2203]</span><br></pre></td></tr></table></figure>

<h4 id="mob-launch-py"><a href="#mob-launch-py" class="headerlink" title="mob_launch.py"></a>mob_launch.py</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$</span><span class="language-bash">ros2 launch mbot_bringup mbot_launch.py</span></span><br></pre></td></tr></table></figure>

<p>log</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[INFO] [launch]: All log files can be found below /home/ubuntu/.ros/log/2024-08-26-14-59-50-148695-ubuntu-2270</span><br><span class="line">[INFO] [launch]: Default logging verbosity is set to INFO</span><br><span class="line">[INFO] [mbot_bringup-1]: process started with pid [2272]</span><br><span class="line">[INFO] [robot_state_publisher-2]: process started with pid [2274]</span><br><span class="line">[INFO] [joint_state_publisher-3]: process started with pid [2276]</span><br><span class="line">[robot_state_publisher-2] Parsing robot urdf xml string.</span><br><span class="line">[robot_state_publisher-2] The root link base_link has an inertia specified in the URDF, but KDL does not support a root link with an inertia.  As a w you can add an extra dummy link to your URDF.</span><br><span class="line">[robot_state_publisher-2] Link lidar_link had 0 children</span><br><span class="line">[robot_state_publisher-2] Link right_back_wheel had 0 children</span><br><span class="line">[robot_state_publisher-2] Link left_back_wheel had 0 children</span><br><span class="line">[robot_state_publisher-2] [INFO] [1724684390.636906578] [robot_state_publisher]: got segment base_link</span><br><span class="line">[robot_state_publisher-2] [INFO] [1724684390.637204512] [robot_state_publisher]: got segment left_back_wheel</span><br><span class="line">[robot_state_publisher-2] [INFO] [1724684390.637258713] [robot_state_publisher]: got segment lidar_link</span><br><span class="line">[robot_state_publisher-2] [INFO] [1724684390.637289175] [robot_state_publisher]: got segment right_back_wheel</span><br><span class="line">[joint_state_publisher-3] [INFO] [1724684392.267731058] [joint_state_publisher]: Waiting for robot_description to be published on the robot_descripti.</span><br></pre></td></tr></table></figure>

<h3 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h3><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/6wIrOa3bejXq2fGDoDy_nA">Wexin 搭建ROS小车文章汇总 白茶 l 清欢 小白学移动机器人</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/682575096"># ros2-control系列教程(4) 控制管理器-运行整个框架</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/6wIrOa3bejXq2fGDoDy_nA"># 搭建ROS小车文章汇总</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/gewT1cz8vF0H3pM7wN72Aw"># ROS机器人启动功能包</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/dHlX8NFlXx49lfMMkprQVQ"># ROS机器人建图导航测试</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzIwOTc5Njg2Mg==&mid=2247486840&idx=1&sn=628322bb9912c66dccb813167815c946&chksm=976f26e9a018afffb921521b24e209b30fe6603bd078e2bf4a65a6dd7be8ad5c4a87f6298be7&scene=21#wechat_redirect"># ROS机器人建图导航测试</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zhao_ke_xue/article/details/107086517">ros app 下载、ros android app下载、ROS机器人控制app下载-CSDN博客</a></p>
<p>开源：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/ROS-Mobile/ROS-Mobile-Android/releases">Releases · ROS-Mobile&#x2F;ROS-Mobile-Android · GitHub</a></p>
<p>Other People:</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38988221/article/details/131377444">android app控制ros机器人一_ros 机器人手机app-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zhao_ke_xue/article/details/108700080?spm=1001.2014.3001.5501">linux系统下串口设备和串口号绑定_linux串口号重启后就会变-CSDN博客</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://novav.github.io/2024/08/22/AI_ROBOT/ROS_/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Simon Shi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Simon Shi的小站">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/08/22/AI_ROBOT/ROS_/" class="post-title-link" itemprop="url">ROS 入门介绍</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-08-22 12:00:00" itemprop="dateCreated datePublished" datetime="2024-08-22T12:00:00+00:00">2024-08-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-06 08:16:38" itemprop="dateModified" datetime="2025-08-06T08:16:38+00:00">2025-08-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ROS/" itemprop="url" rel="index"><span itemprop="name">ROS</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ROS (Robot Operating System) 是一套用于机器人软件开发的框架，它并不是一个真正的操作系统，而是一套中间件。ROS 的第一个版本 ROS 1（通常简称为 ROS）是在 2010 年左右发布的，而 ROS 2 则是在 ROS 1 的基础上进行了重大的改进和重构，于 2015 年开始发布早期版本，并逐步发展成熟。</p>
<p>下面列出了 ROS 1 和 ROS 2 之间的一些主要区别：</p>
<h3 id="1-分布式通信模型"><a href="#1-分布式通信模型" class="headerlink" title="1. 分布式通信模型"></a>1. 分布式通信模型</h3><ul>
<li><strong>ROS 1</strong> 使用了基于 TCP&#x2F;IP 的节点间通信方式，其中主要的通信机制包括：<ul>
<li><strong>Topics</strong> (主题): 发布&#x2F;订阅模式。</li>
<li><strong>Services</strong> (服务): 请求&#x2F;响应模式。</li>
<li><strong>Parameters</strong> (参数): 全局参数服务器。</li>
<li><strong>Actions</strong> (动作): 长期任务的请求&#x2F;响应模式。</li>
</ul>
</li>
<li><strong>ROS 2</strong> 也采用了类似的通信机制，但是底层通信协议从 ROS 1 的 TCP&#x2F;IP 改为了 <strong>DDS (Data Distribution Service)</strong>，这是一种更为先进的实时数据传输协议。DDS 的使用使得 ROS 2 能够更好地支持实时性要求高的场景，并且能够更轻松地跨越不同的网络拓扑结构。</li>
</ul>
<h3 id="2-多线程支持"><a href="#2-多线程支持" class="headerlink" title="2. 多线程支持"></a>2. 多线程支持</h3><ul>
<li><strong>ROS 1</strong> 主要依赖于单线程模型，尽管可以通过多进程或多节点的方式来实现并发处理，但在单个节点内部实现多线程支持比较困难。</li>
<li><strong>ROS 2</strong> 改进了对多线程的支持，使得在同一节点内可以更方便地利用多核处理器的能力。</li>
</ul>
<h3 id="3-安全性和可靠性"><a href="#3-安全性和可靠性" class="headerlink" title="3. 安全性和可靠性"></a>3. 安全性和可靠性</h3><ul>
<li><strong>ROS 1</strong> 在安全方面存在一些限制，例如没有内置的安全认证机制。</li>
<li><strong>ROS 2</strong> 强化了安全特性，提供了认证、加密等机制，增强了系统的安全性。</li>
</ul>
<h3 id="4-实时支持"><a href="#4-实时支持" class="headerlink" title="4. 实时支持"></a>4. 实时支持</h3><ul>
<li><strong>ROS 1</strong> 在实时性方面有所欠缺，尤其是在网络延迟和确定性方面。</li>
<li><strong>ROS 2</strong> 通过采用 DDS 作为通信基础，并且在设计上考虑了实时性需求，因此更适合于实时系统。</li>
</ul>
<h3 id="5-语言支持"><a href="#5-语言支持" class="headerlink" title="5. 语言支持"></a>5. 语言支持</h3><ul>
<li><strong>ROS 1</strong> 主要支持 C++ 和 Python，但大部分核心功能都是用 C++ 编写的。</li>
<li><strong>ROS 2</strong> 同样支持 C++ 和 Python，但在设计上更加灵活，理论上可以支持更多的编程语言。</li>
</ul>
<h3 id="6-系统架构"><a href="#6-系统架构" class="headerlink" title="6. 系统架构"></a>6. 系统架构</h3><ul>
<li><strong>ROS 1</strong> 有一个名为 <code>master</code> 的中心节点来协调各个节点之间的通信。</li>
<li><strong>ROS 2</strong> 采用了无中心节点的设计，所有节点都可以直接互相通信。</li>
</ul>
<h3 id="7-内存管理"><a href="#7-内存管理" class="headerlink" title="7. 内存管理"></a>7. 内存管理</h3><ul>
<li><strong>ROS 1</strong> 在内存管理和生命周期管理方面有一些局限性。</li>
<li><strong>ROS 2</strong> 改进了这些方面，提供了更好的内存管理策略，比如自动垃圾回收。</li>
</ul>
<h3 id="8-社区和支持"><a href="#8-社区和支持" class="headerlink" title="8. 社区和支持"></a>8. 社区和支持</h3><ul>
<li><strong>ROS 1</strong> 有着庞大的用户基础和丰富的软件包库。</li>
<li><strong>ROS 2</strong> 的社区正在不断成长，虽然初期可能软件包较少，但随着 ROS 2 的成熟，越来越多的开发者和组织转向 ROS 2，它的生态系统也在迅速扩大。</li>
</ul>
<h3 id="9-生命周期"><a href="#9-生命周期" class="headerlink" title="9. 生命周期"></a>9. 生命周期</h3><ul>
<li><strong>ROS 1</strong> 已经停止官方支持和开发，但仍有一些社区支持的版本。</li>
<li><strong>ROS 2</strong> 是目前 ROS 社区发展的重点方向，有长期的支持计划和稳定的版本更新。</li>
</ul>
<h3 id="10-跨平台能力"><a href="#10-跨平台能力" class="headerlink" title="10. 跨平台能力"></a>10. 跨平台能力</h3><ul>
<li><strong>ROS 1</strong> 支持多种操作系统，但主要针对 Linux。</li>
<li><strong>ROS 2</strong> 在设计上更加注重跨平台兼容性，支持 Windows、macOS 和多种 Linux 发行版。</li>
</ul>
<p>综上所述，ROS 2 是对 ROS 1 的全面升级，旨在解决 ROS 1 存在的问题，并增强其在现代机器人开发中的适用性和灵活性。如果您正计划新的机器人项目或者需要更高级的功能，建议选择 ROS 2。而对于已经使用 ROS 1 的项目，如果不需要上述提到的新特性，则可以继续使用 ROS 1，同时考虑未来的迁移计划。</p>
<h3 id="ROS-区别"><a href="#ROS-区别" class="headerlink" title="ROS 区别"></a>ROS 区别</h3><p>ROS Noetic中确实没有使用ament作为构建系统，而是使用了catkin工具。因此，您遇到的问题可能与ROS 2相关，而ROS Noetic则使用了不同的方法来处理订阅和回调函数。</p>
<ul>
<li><strong>对于ROS Noetic</strong>：使用<code>ros::NodeHandle</code>、<code>ros::Subscriber</code>和<code>boost::function</code>。</li>
<li><strong>对于ROS 2</strong>：使用<code>rclcpp::Node</code>、<code>rclcpp::Subscription</code>和<code>std::bind</code>。</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/33/">33</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Simon Shi</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">322</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">142</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">269</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:yourname@gmail.com" title="E-Mail → mailto:yourname@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Simon Shi</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  

</body>
</html>
