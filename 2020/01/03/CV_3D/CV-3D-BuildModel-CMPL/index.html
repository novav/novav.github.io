<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"novav.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="[TOC] 人体3D建模: 均是蒙皮模型，没有纹理  SMPL 2015《A Skinned Multi-Person Linear Model》 Loper, Matthew and Mahmood, Naureen and Romero, Javier and Pons-Moll, Gerard and Black, Michael J.  参数人体建模  Officialhttps:&#x2F;&#x2F;sm">
<meta property="og:type" content="article">
<meta property="og:title" content="CV_3D_BuildModel_SMPL">
<meta property="og:url" content="https://novav.github.io/2020/01/03/CV_3D/CV-3D-BuildModel-CMPL/index.html">
<meta property="og:site_name" content="Simon Shi的小站">
<meta property="og:description" content="[TOC] 人体3D建模: 均是蒙皮模型，没有纹理  SMPL 2015《A Skinned Multi-Person Linear Model》 Loper, Matthew and Mahmood, Naureen and Romero, Javier and Pons-Moll, Gerard and Black, Michael J.  参数人体建模  Officialhttps:&#x2F;&#x2F;sm">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://novav.github.io/2020/01/03/CV_3D/CV-3D-BuildModel-CMPL/5e0697acaa6695d3b54f35923fe644df.png">
<meta property="article:published_time" content="2020-01-03T17:32:43.000Z">
<meta property="article:modified_time" content="2025-08-06T08:16:38.341Z">
<meta property="article:author" content="Simon Shi">
<meta property="article:tag" content="3D Body">
<meta property="article:tag" content="SMPL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://novav.github.io/2020/01/03/CV_3D/CV-3D-BuildModel-CMPL/5e0697acaa6695d3b54f35923fe644df.png">

<link rel="canonical" href="https://novav.github.io/2020/01/03/CV_3D/CV-3D-BuildModel-CMPL/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>CV_3D_BuildModel_SMPL | Simon Shi的小站</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Simon Shi的小站</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">人工智能，机器学习， 强化学习，大模型，自动驾驶</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://novav.github.io/2020/01/03/CV_3D/CV-3D-BuildModel-CMPL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Simon Shi">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Simon Shi的小站">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          CV_3D_BuildModel_SMPL
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-01-03 17:32:43" itemprop="dateCreated datePublished" datetime="2020-01-03T17:32:43+00:00">2020-01-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-08-06 08:16:38" itemprop="dateModified" datetime="2025-08-06T08:16:38+00:00">2025-08-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CV-3D/" itemprop="url" rel="index"><span itemprop="name">CV_3D</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CV-3D/3D-Body/" itemprop="url" rel="index"><span itemprop="name">3D Body</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>[TOC]</p>
<h2 id="人体3D建模"><a href="#人体3D建模" class="headerlink" title="人体3D建模:"></a>人体3D建模:</h2><ul>
<li>均是蒙皮模型，没有纹理</li>
</ul>
<h3 id="SMPL-2015"><a href="#SMPL-2015" class="headerlink" title="SMPL 2015"></a>SMPL 2015</h3><p>《A Skinned Multi-Person Linear Model》</p>
<p>Loper, Matthew and Mahmood, Naureen and Romero, Javier and Pons-Moll, Gerard and Black, Michael J.</p>
<ul>
<li>参数人体建模</li>
</ul>
<h4 id="Official"><a href="#Official" class="headerlink" title="Official"></a>Official</h4><p><a target="_blank" rel="noopener" href="https://smpl.is.tue.mpg.de/">https://smpl.is.tue.mpg.de/</a></p>
<h4 id="SMPL"><a href="#SMPL" class="headerlink" title="SMPL"></a>SMPL</h4><p><a target="_blank" rel="noopener" href="https://github.com/CalciferZh/SMPL">https://github.com/CalciferZh/SMPL</a></p>
<ul>
<li>Numpy, TF and PyTorch implementation of human body SMPL model and infant body SMIL model.</li>
</ul>
<p>参数化的人体3D模型生成工具</p>
<h3 id="SMPLify-2016"><a href="#SMPLify-2016" class="headerlink" title="SMPLify 2016"></a>SMPLify 2016</h3><p>论文：《Keep it SMPL: Automatic Estimation of 3D Human Pose and Shape from a Single Image》</p>
<p>官网：<a target="_blank" rel="noopener" href="http://smplify.is.tue.mpg.de/">http://smplify.is.tue.mpg.de/</a></p>
<p>github: <a target="_blank" rel="noopener" href="https://github.com/vchoutas/smplify-x">https://github.com/vchoutas/smplify-x</a></p>
<p>论文解读: <a target="_blank" rel="noopener" href="https://eros-l.github.io/weekly/2018/11/28/weekly5/">https://eros-l.github.io/weekly/2018/11/28/weekly5/</a></p>
<ul>
<li>根据单张照片生成3D模型</li>
</ul>
<h4 id="项目实践："><a href="#项目实践：" class="headerlink" title="项目实践："></a>项目实践：</h4><p>官网数据：</p>
<p>smplify_code_v2.zip</p>
<p>lsp_results.tar.gz</p>
<p>human_eva_results.tar.gz</p>
<p>h36M_results_wtout_plytar.gz</p>
<p>常见问题：</p>
<p>—–自定义自己的数据集</p>
<ul>
<li>使用经过LSP训练过的关节检测器CPM&#x2F;DeepCut</li>
<li>fit_3d.py 的<code>run_sigle_fit</code></li>
</ul>
<p>Ubuntu下python3环境：</p>
<ol>
<li>下载lsp数据集。</li>
<li>DeepCut 提取lsp数据集2D Pose特征点 （DeepCut 提取的 lsp dataset 的二维特征点）</li>
<li>SMPLify fit_3d.py 转换人体3D Pose的模型截图jpg和pkl格式。</li>
<li>pkl 文件来生成对应的 obj 文件或者其他格式的 mesh（未完成）</li>
</ol>
<p>参考文档：</p>
<p>​    1.<a target="_blank" rel="noopener" href="https://eros-l.github.io/weekly/2018/11/28/weekly5/">学习报告(week 5)</a></p>
<p>​    2.<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_36595565/article/details/88929575">（week 2）【经验教训】如何将CPM和SMPL的输入替换成任意图片并得到人体三维模型</a></p>
<h3 id="SMPL-H（mano）-2017"><a href="#SMPL-H（mano）-2017" class="headerlink" title="SMPL-H（mano） 2017"></a>SMPL-H（mano） 2017</h3><p>官网：<a target="_blank" rel="noopener" href="https://mano.is.tue.mpg.de/">https://mano.is.tue.mpg.de/</a></p>
<p>论文：《Embodied Hands: Modeling and Capturing Hands and Bodies Together》 2017</p>
<p>Javier Romero*, Dimitrios Tzionas* and Michael J Black</p>
<p><em>SIGGRAPH ASIA 2017, BANGKOK, THAILAND</em></p>
<ul>
<li>增加了对手的部分的细节的还原</li>
</ul>
<h3 id="SMPLX-2019"><a href="#SMPLX-2019" class="headerlink" title="SMPLX 2019"></a>SMPLX 2019</h3><p>官网：<a target="_blank" rel="noopener" href="https://smpl-x.is.tue.mpg.de/">https://smpl-x.is.tue.mpg.de/</a></p>
<p>github: <a target="_blank" rel="noopener" href="https://github.com/vchoutas/smplx">https://github.com/vchoutas/smplx</a></p>
<p>《Expressive Body Capture: 3D Hands, Face, and Body from a Single Image》</p>
<p><a target="_blank" rel="noopener" href="https://ps.is.tuebingen.mpg.de/person/gpavlakos">G. Pavlakos*</a>, <a target="_blank" rel="noopener" href="https://ps.is.tuebingen.mpg.de/person/vchoutas">V. Choutas*</a>, <a target="_blank" rel="noopener" href="https://ps.is.tuebingen.mpg.de/person/nghorbani">N. Ghorbani</a>, <a target="_blank" rel="noopener" href="https://ps.is.tuebingen.mpg.de/person/tbolkart">T. Bolkart</a>, <a target="_blank" rel="noopener" href="https://ps.is.tuebingen.mpg.de/person/aosman">A. A. A. Osman</a>, <a target="_blank" rel="noopener" href="https://ps.is.tuebingen.mpg.de/person/dtzionas">D. Tzionas</a> and <a target="_blank" rel="noopener" href="https://ps.is.tuebingen.mpg.de/person/black">M. J. Black</a></p>
<p>CVPR 2019</p>
<ul>
<li><p>增加了对手，脸部，身体的细节的完善</p>
</li>
<li><p>pytorch实现，摈弃了chumpy</p>
</li>
</ul>
<h4 id="SMPLify-X"><a href="#SMPLify-X" class="headerlink" title="SMPLify-X"></a>SMPLify-X</h4><p><a target="_blank" rel="noopener" href="https://github.com/vchoutas/smplify-x">https://github.com/vchoutas/smplify-x</a></p>
<p>从单张图片的3D人体复原</p>
<h3 id="AMASS-dataset"><a href="#AMASS-dataset" class="headerlink" title="AMASS dataset"></a>AMASS dataset</h3><p><a target="_blank" rel="noopener" href="https://amass.is.tuebingen.mpg.de/">https://amass.is.tuebingen.mpg.de/</a></p>
<p>AMASS is a large database of human motion unifying different optical marker-based motion capture datasets by representing them within a common framework and parameterization. AMASS is readily useful for animation, visualization, and generating training data for deep learning.</p>
<p>AMASS是一个大型的人类运动数据库，通过在共同的框架和参数化中表示不同的基于光学标记的运动捕获数据集来统一这些数据。AMASS对于动画，可视化以及生成用于深度学习的训练数据非常有用。</p>
<h2 id="SMPL模型源码-项目介绍"><a href="#SMPL模型源码-项目介绍" class="headerlink" title="SMPL模型源码&#x2F;项目介绍"></a><a target="_blank" rel="noopener" href="https://52zju.cn/?p=471">SMPL模型源码&#x2F;项目介绍</a></h2><p>SMPL源码下载：<a target="_blank" rel="noopener" href="http://smpl.is.tue.mpg.de/downloads">http://smpl.is.tue.mpg.de/downloads</a>   需要注册</p>
<p>本文主要讨论SMPL源码核心代码。需要储备的知识还有：三维重建基础知识，以及<a target="_blank" rel="noopener" href="http://52zju.cn/2018/11/13/%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA2-%E6%B8%B2%E6%9F%93%E5%B7%A5%E5%85%B7opendr%E8%AE%BA%E6%96%87%E5%92%8C%E6%BA%90%E7%A0%81%E9%83%A8%E5%88%86%E9%98%85%E8%AF%BB-2/"> chumpy阅读</a>以及<a target="_blank" rel="noopener" href="http://52zju.cn/2018/11/13/%E4%B8%89%E7%BB%B4%E9%87%8D%E5%BB%BA2-%E6%B8%B2%E6%9F%93%E5%B7%A5%E5%85%B7opendr%E8%AE%BA%E6%96%87%E5%92%8C%E6%BA%90%E7%A0%81%E9%83%A8%E5%88%86%E9%98%85%E8%AF%BB-2/">opendr阅读</a>，<a target="_blank" rel="noopener" href="https://52zju.cn/?p=474">LBS DQS</a>等</p>
<p>SMPL文件主要包括 vert.py serialization.py lbs.py。下面将逐一说说明。</p>
<p>0、关节位置</p>
<p>SMPL模型关节点名称</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">self.j_names = &#123;</span><br><span class="line">0: ‘Pelvis’,</span><br><span class="line">1: ‘L_Hip’,</span><br><span class="line">2: ‘R_Hip’,</span><br><span class="line">3:  ‘Spine1’,</span><br><span class="line">4: ‘L_Knee’,</span><br><span class="line">5:  ‘R_Knee’,</span><br><span class="line">6:  ‘Spine2’,</span><br><span class="line">7:  ‘L_Ankle’,</span><br><span class="line">8:  ‘R_Ankle’,</span><br><span class="line">9:  ‘Spine3’,</span><br><span class="line">10: ‘L_Foot’,</span><br><span class="line">11: ‘R_Foot’,</span><br><span class="line">12: ‘Neck’,</span><br><span class="line">13: ‘L_Collar’,</span><br><span class="line">14: ‘R_Collar’,</span><br><span class="line">15: ‘Head’,</span><br><span class="line">16: ‘L_Shoulder’,</span><br><span class="line">17: ‘R_Shoulder’,</span><br><span class="line">18: ‘L_Elbow’,</span><br><span class="line">19: ‘R_Elbow’,</span><br><span class="line">20: ‘L_Wrist’,</span><br><span class="line">21: ‘R_Wrist’,</span><br><span class="line">22: ‘L_Hand’,</span><br><span class="line">23: ‘R_Hand’, &#125;</span><br></pre></td></tr></table></figure>

<p>关节树图形：</p>
<p><img src="/2020/01/03/CV_3D/CV-3D-BuildModel-CMPL/5e0697acaa6695d3b54f35923fe644df.png" alt="img"></p>
<h3 id="1、posemapper-py"><a href="#1、posemapper-py" class="headerlink" title="1、posemapper.py"></a>1、posemapper.py</h3><p>主要是实现关节角度到姿势混合形状的映射。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> chumpy <span class="keyword">as</span> ch</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Rodrigues</span>(ch.Ch):  <span class="comment">#创建函数类</span></span><br><span class="line">    dterms = <span class="string">&#x27;rt&#x27;</span>  <span class="comment">#可微变量旋度</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">compute_r</span>(<span class="params">self</span>):  <span class="comment">#计算旋转矩阵</span></span><br><span class="line">        <span class="keyword">return</span> cv2.Rodrigues(<span class="variable language_">self</span>.rt.r)[<span class="number">0</span>] </span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">compute_dr_wrt</span>(<span class="params">self, wrt</span>): <span class="comment"># 计算旋度</span></span><br><span class="line">        <span class="keyword">if</span> wrt <span class="keyword">is</span> <span class="variable language_">self</span>.rt:</span><br><span class="line">            <span class="keyword">return</span> cv2.Rodrigues(<span class="variable language_">self</span>.rt.r)[<span class="number">1</span>].T <span class="comment">#返回旋度的转置</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lrotmin</span>(<span class="params">p</span>): </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(p, np.ndarray): <span class="comment"># 判断p的类型是不是np，基本上都不是，跳过</span></span><br><span class="line">        p = p.ravel()[<span class="number">3</span>:] <span class="comment"># 转化成3*n矩阵</span></span><br><span class="line">        <span class="keyword">return</span> np.concatenate([(cv2.Rodrigues(np.array(pp))[<span class="number">0</span>]-np.eye(<span class="number">3</span>)).ravel() <span class="keyword">for</span> pp <span class="keyword">in</span> p.reshape((-<span class="number">1</span>,<span class="number">3</span>))]).ravel()        </span><br><span class="line">    <span class="keyword">if</span> p.ndim != <span class="number">2</span> <span class="keyword">or</span> p.shape[<span class="number">1</span>] != <span class="number">3</span>: <span class="comment"># 判断姿势的维度，如果不是2维或第二维shape不为3</span></span><br><span class="line">        p = p.reshape((-<span class="number">1</span>,<span class="number">3</span>)) <span class="comment"># 将pose转换成（24,3）的形式</span></span><br><span class="line">    p = p[<span class="number">1</span>:]  <span class="comment"># 去掉root出，提取23个关节处</span></span><br><span class="line">    <span class="keyword">return</span> ch.concatenate([(Rodrigues(pp)-ch.eye(<span class="number">3</span>)).ravel() <span class="keyword">for</span> pp <span class="keyword">in</span> p]).ravel()  <span class="comment"># 将旋转向量转化成旋转矩阵，并拼接在一起</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">posemap</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">if</span> s == <span class="string">&#x27;lrotmin&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> lrotmin</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;Unknown posemapping: %s&#x27;</span> % (<span class="built_in">str</span>(s),))</span><br></pre></td></tr></table></figure>

<h3 id="2、LBS-py"><a href="#2、LBS-py" class="headerlink" title="2、LBS.py"></a>2、LBS.py</h3><p>就是实现LBS</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> posemapper <span class="keyword">import</span> posemap</span><br><span class="line"><span class="keyword">import</span> chumpy</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment">#计算模型的全局刚体变换，包括旋度和平移量。实现论文里的公式4</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">global_rigid_transformation</span>(<span class="params">pose, J, kintree_table, xp</span>):</span><br><span class="line">    results = &#123;&#125;</span><br><span class="line">    <span class="comment"># 看了后面parents 终于知道这个kintree_table是干啥的了：关节树，可以理解为各个关节相互依赖的关系。</span></span><br><span class="line">    pose = pose.reshape((-<span class="number">1</span>,<span class="number">3</span>)) <span class="comment">#静止的姿势参数：shape=(24,3) 可能都是0向量</span></span><br><span class="line">    <span class="comment"># 下面两行主要是变换列表，并剔除[0,0]坐标的异常值（可以认为是root的方向异常）。kintree_table的shape=（2,24）</span></span><br><span class="line">    id_to_col = &#123;kintree_table[<span class="number">1</span>,i] : i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(kintree_table.shape[<span class="number">1</span>])&#125;</span><br><span class="line">    parent = &#123;i : id_to_col[kintree_table[<span class="number">0</span>,i]] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, kintree_table.shape[<span class="number">1</span>])&#125;</span><br><span class="line">    <span class="comment">#如果xp是chumpy类型</span></span><br><span class="line">    <span class="keyword">if</span> xp == chumpy:</span><br><span class="line">        <span class="keyword">from</span> posemapper <span class="keyword">import</span> Rodrigues <span class="comment"># 则引入posemapper的函数 </span></span><br><span class="line">        rodrigues = <span class="keyword">lambda</span> x : Rodrigues(x) <span class="comment"># 创建匿名类，ch对象</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">import</span> cv2</span><br><span class="line">        rodrigues = <span class="keyword">lambda</span> x : cv2.Rodrigues(x)[<span class="number">0</span>]  <span class="comment">#否则的话使用opencv的函数</span></span><br><span class="line">    <span class="comment"># stack纵向拼接，改变的是行数，类似于concat。xp在这里就相当于chumpy类</span></span><br><span class="line">    with_zeros = <span class="keyword">lambda</span> x : xp.vstack((x, xp.array([[<span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">1.0</span>]]))) </span><br><span class="line">    <span class="comment"># 先确定根关节的结果：目前还不知道这个result有什么用。</span></span><br><span class="line">    <span class="comment"># hstack横向拼接，改变的是列数。输入的是pose的root节点和关节的root节点，最后输出是主对角线为1的4*4矩阵 </span></span><br><span class="line">    <span class="comment"># pose[0] 表示静止姿势的根关节位置</span></span><br><span class="line">    results[<span class="number">0</span>] = with_zeros(xp.hstack((rodrigues(pose[<span class="number">0</span>,:]), J[<span class="number">0</span>,:].reshape((<span class="number">3</span>,<span class="number">1</span>))))) </span><br><span class="line">    <span class="comment"># 利用关节的依赖关系求得其他关节的result    </span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, kintree_table.shape[<span class="number">1</span>]): <span class="comment"># i从1到23，代表每个关节的编号</span></span><br><span class="line">        results[i] = results[parent[i]].dot(with_zeros(xp.hstack((  <span class="comment"># 父关节的轴角乘以关节相对旋度等于当前关节的轴角</span></span><br><span class="line">            rodrigues(pose[i,:]),</span><br><span class="line">            ((J[i,:] - J[parent[i],:]).reshape((<span class="number">3</span>,<span class="number">1</span>)))  <span class="comment"># 计算关节的相对位置</span></span><br><span class="line">            ))))</span><br><span class="line"></span><br><span class="line">    pack = <span class="keyword">lambda</span> x : xp.hstack([np.zeros((<span class="number">4</span>, <span class="number">3</span>)), x.reshape((<span class="number">4</span>,<span class="number">1</span>))])</span><br><span class="line"></span><br><span class="line">    results = [results[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">sorted</span>(results.keys())]</span><br><span class="line">    results_global = results</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="literal">True</span>:</span><br><span class="line">        results2 = [results[i] - (pack(</span><br><span class="line">            results[i].dot(xp.concatenate( ( (J[i,:]), <span class="number">0</span> ) )))</span><br><span class="line">            ) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(results))]</span><br><span class="line">        results = results2</span><br><span class="line">    result = xp.dstack(results)</span><br><span class="line">    <span class="keyword">return</span> result, results_global</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算每个顶点的关节影响度的混合 </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verts_core</span>(<span class="params">pose, v, J, weights, kintree_table, want_Jtr=<span class="literal">False</span>, xp=chumpy</span>):</span><br><span class="line">    A, A_global = global_rigid_transformation(pose, J, kintree_table, xp) <span class="comment">#调用函数，生成全局和局部的旋转矩阵。A.shape=[4,4,24] A_global.shape=[24,4,4]</span></span><br><span class="line">    T = A.dot(weights.T)  <span class="comment"># weight.shape=[6890,24],生成结果的shape=[4,4,6890]</span></span><br><span class="line"></span><br><span class="line">    rest_shape_h = xp.vstack((v.T, np.ones((<span class="number">1</span>, v.shape[<span class="number">0</span>]))))  <span class="comment"># 静止姿势的shape</span></span><br><span class="line"></span><br><span class="line">    v =(T[:,<span class="number">0</span>,:] * rest_shape_h[<span class="number">0</span>, :].reshape((<span class="number">1</span>, -<span class="number">1</span>)) +</span><br><span class="line">        T[:,<span class="number">1</span>,:] * rest_shape_h[<span class="number">1</span>, :].reshape((<span class="number">1</span>, -<span class="number">1</span>)) +</span><br><span class="line">        T[:,<span class="number">2</span>,:] * rest_shape_h[<span class="number">2</span>, :].reshape((<span class="number">1</span>, -<span class="number">1</span>)) +</span><br><span class="line">        T[:,<span class="number">3</span>,:] * rest_shape_h[<span class="number">3</span>, :].reshape((<span class="number">1</span>, -<span class="number">1</span>))).T <span class="comment"># 应用公式2</span></span><br><span class="line"></span><br><span class="line">    v = v[:,:<span class="number">3</span>] </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> want_Jtr:</span><br><span class="line">        <span class="keyword">return</span> v</span><br><span class="line">    Jtr = xp.vstack([g[:<span class="number">3</span>,<span class="number">3</span>] <span class="keyword">for</span> g <span class="keyword">in</span> A_global])</span><br><span class="line">    <span class="keyword">return</span> (v, Jtr)</span><br></pre></td></tr></table></figure>

<h3 id="3、vert-py"><a href="#3、vert-py" class="headerlink" title="3、vert.py"></a>3、vert.py</h3><p>verts_decorated函数没有被用到就不过多注释了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> chumpy</span><br><span class="line"><span class="keyword">import</span> lbs</span><br><span class="line"><span class="keyword">from</span> posemapper <span class="keyword">import</span> posemap</span><br><span class="line"><span class="keyword">import</span> scipy.sparse <span class="keyword">as</span> sp</span><br><span class="line"><span class="keyword">from</span> chumpy.ch <span class="keyword">import</span> MatVecMult</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ischumpy</span>(<span class="params">x</span>): <span class="keyword">return</span> <span class="built_in">hasattr</span>(x, <span class="string">&#x27;dterms&#x27;</span>) <span class="comment">#如果没有dterm属性就返回chumpy</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># verts_decorated函数：从另一个SMPL模型中参数来创建新的SMPL模型实例</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verts_decorated</span>(<span class="params">trans, pose,</span></span><br><span class="line"><span class="params">    v_template, J, weights, kintree_table, bs_style, f,</span></span><br><span class="line"><span class="params">    bs_type=<span class="literal">None</span>, posedirs=<span class="literal">None</span>, betas=<span class="literal">None</span>, shapedirs=<span class="literal">None</span>, want_Jtr=<span class="literal">False</span></span>):</span><br><span class="line">    <span class="comment">#各个参数的含义 </span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> which <span class="keyword">in</span> [trans, pose, v_template, weights, posedirs, betas, shapedirs]:</span><br><span class="line">        <span class="keyword">if</span> which <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">           <span class="keyword">assert</span> ischumpy(which)  <span class="comment">#判断是否是chumpy类型，如果不是则报错</span></span><br><span class="line"></span><br><span class="line">    v = v_template</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> shapedirs <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">       <span class="keyword">if</span> betas <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">          betas = chumpy.zeros(shapedirs.shape[-<span class="number">1</span>])</span><br><span class="line">       v_shaped = v + shapedirs.dot(betas)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">       v_shaped = v</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> posedirs <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">       v_posed = v_shaped + posedirs.dot(posemap(bs_type)(pose))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">       v_posed = v_shaped</span><br><span class="line"></span><br><span class="line">    v = v_posed</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> sp.issparse(J):</span><br><span class="line">       regressor = J</span><br><span class="line">       J_tmpx = MatVecMult(regressor, v_shaped[:,<span class="number">0</span>])</span><br><span class="line">       J_tmpy = MatVecMult(regressor, v_shaped[:,<span class="number">1</span>])</span><br><span class="line">       J_tmpz = MatVecMult(regressor, v_shaped[:,<span class="number">2</span>])</span><br><span class="line">       J = chumpy.vstack((J_tmpx, J_tmpy, J_tmpz)).T</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">       <span class="keyword">assert</span>(ischumpy(J))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span>(bs_style==<span class="string">&#x27;lbs&#x27;</span>)</span><br><span class="line">    result, Jtr = lbs.verts_core(pose, v, J, weights, kintree_table, want_Jtr=<span class="literal">True</span>, xp=chumpy)</span><br><span class="line"></span><br><span class="line">    tr = trans.reshape((<span class="number">1</span>,<span class="number">3</span>))</span><br><span class="line">    result = result + tr</span><br><span class="line">    Jtr = Jtr + tr</span><br><span class="line"></span><br><span class="line">    result.trans = trans</span><br><span class="line">    result.f = f</span><br><span class="line">    result.pose = pose</span><br><span class="line">    result.v_template = v_template</span><br><span class="line">    result.J = J</span><br><span class="line">    result.weights = weights</span><br><span class="line">    result.kintree_table = kintree_table</span><br><span class="line">    result.bs_style = bs_style</span><br><span class="line">    result.bs_type =bs_type</span><br><span class="line">    <span class="keyword">if</span> posedirs <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">       result.posedirs = posedirs</span><br><span class="line">       result.v_posed = v_posed</span><br><span class="line">    <span class="keyword">if</span> shapedirs <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">       result.shapedirs = shapedirs</span><br><span class="line">       result.betas = betas</span><br><span class="line">       result.v_shaped = v_shaped</span><br><span class="line">    <span class="keyword">if</span> want_Jtr:</span><br><span class="line">       result.J_transformed = Jtr</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="comment"># verts_core ：overloaded function inherited by lbs.verts_core</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verts_core</span>(<span class="params">pose, v, J, weights, kintree_table, bs_style, want_Jtr=<span class="literal">False</span>, xp=chumpy</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> xp == chumpy:</span><br><span class="line">       <span class="keyword">assert</span>(<span class="built_in">hasattr</span>(pose, <span class="string">&#x27;dterms&#x27;</span>))</span><br><span class="line">       <span class="keyword">assert</span>(<span class="built_in">hasattr</span>(v, <span class="string">&#x27;dterms&#x27;</span>))</span><br><span class="line">       <span class="keyword">assert</span>(<span class="built_in">hasattr</span>(J, <span class="string">&#x27;dterms&#x27;</span>))</span><br><span class="line">       <span class="keyword">assert</span>(<span class="built_in">hasattr</span>(weights, <span class="string">&#x27;dterms&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span>(bs_style==<span class="string">&#x27;lbs&#x27;</span>)</span><br><span class="line">    result = lbs.verts_core(pose, v, J, weights, kintree_table, want_Jtr, xp)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>

<h3 id="4、serialization-py"><a href="#4、serialization-py" class="headerlink" title="4、serialization.py"></a>4、serialization.py</h3><p>SMPL模型的序列化函数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">save_model</span>(<span class="params">model, fname</span>): <span class="comment"># 保存模型model到文件名fname中</span></span><br><span class="line">    m0 = model</span><br><span class="line">    <span class="comment"># 将模型参数存入字典。各个模型参数的含义：</span></span><br><span class="line">    <span class="comment"># v_template：顶点模板 J：关节坐标，weight：关节权重，kintree_table：关节树，f:相机参数，bs_type：蒙皮方法LBS还是DQBS</span></span><br><span class="line">    trainer_dict = &#123;<span class="string">&#x27;v_template&#x27;</span>: np.asarray(m0.v_template),<span class="string">&#x27;J&#x27;</span>: np.asarray(m0.J),<span class="string">&#x27;weights&#x27;</span>: np.asarray(m0.weights),<span class="string">&#x27;kintree_table&#x27;</span>: m0.kintree_table,<span class="string">&#x27;f&#x27;</span>: m0.f, <span class="string">&#x27;bs_type&#x27;</span>: m0.bs_type, <span class="string">&#x27;posedirs&#x27;</span>: np.asarray(m0.posedirs)&#125;    </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hasattr</span>(model, <span class="string">&#x27;J_regressor&#x27;</span>):</span><br><span class="line">        trainer_dict[<span class="string">&#x27;J_regressor&#x27;</span>] = m0.J_regressor</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hasattr</span>(model, <span class="string">&#x27;J_regressor_prior&#x27;</span>):</span><br><span class="line">        trainer_dict[<span class="string">&#x27;J_regressor_prior&#x27;</span>] = m0.J_regressor_prior</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hasattr</span>(model, <span class="string">&#x27;weights_prior&#x27;</span>):</span><br><span class="line">        trainer_dict[<span class="string">&#x27;weights_prior&#x27;</span>] = m0.weights_prior</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hasattr</span>(model, <span class="string">&#x27;shapedirs&#x27;</span>):</span><br><span class="line">        trainer_dict[<span class="string">&#x27;shapedirs&#x27;</span>] = m0.shapedirs</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hasattr</span>(model, <span class="string">&#x27;vert_sym_idxs&#x27;</span>):</span><br><span class="line">        trainer_dict[<span class="string">&#x27;vert_sym_idxs&#x27;</span>] = m0.vert_sym_idxs</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hasattr</span>(model, <span class="string">&#x27;bs_style&#x27;</span>):</span><br><span class="line">        trainer_dict[<span class="string">&#x27;bs_style&#x27;</span>] = model.bs_style</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        trainer_dict[<span class="string">&#x27;bs_style&#x27;</span>] = <span class="string">&#x27;lbs&#x27;</span></span><br><span class="line">    pickle.dump(trainer_dict, <span class="built_in">open</span>(fname, <span class="string">&#x27;w&#x27;</span>), -<span class="number">1</span>) <span class="comment">#写入文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载model时更改参数名称</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">backwards_compatibility_replacements</span>(<span class="params">dd</span>):</span><br><span class="line"></span><br><span class="line">    <span class="comment"># replacements</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;default_v&#x27;</span> <span class="keyword">in</span> dd:</span><br><span class="line">        dd[<span class="string">&#x27;v_template&#x27;</span>] = dd[<span class="string">&#x27;default_v&#x27;</span>]</span><br><span class="line">        <span class="keyword">del</span> dd[<span class="string">&#x27;default_v&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;template_v&#x27;</span> <span class="keyword">in</span> dd:</span><br><span class="line">        dd[<span class="string">&#x27;v_template&#x27;</span>] = dd[<span class="string">&#x27;template_v&#x27;</span>]</span><br><span class="line">        <span class="keyword">del</span> dd[<span class="string">&#x27;template_v&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;joint_regressor&#x27;</span> <span class="keyword">in</span> dd:</span><br><span class="line">        dd[<span class="string">&#x27;J_regressor&#x27;</span>] = dd[<span class="string">&#x27;joint_regressor&#x27;</span>]</span><br><span class="line">        <span class="keyword">del</span> dd[<span class="string">&#x27;joint_regressor&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;blendshapes&#x27;</span> <span class="keyword">in</span> dd:</span><br><span class="line">        dd[<span class="string">&#x27;posedirs&#x27;</span>] = dd[<span class="string">&#x27;blendshapes&#x27;</span>]</span><br><span class="line">        <span class="keyword">del</span> dd[<span class="string">&#x27;blendshapes&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;J&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> dd:</span><br><span class="line">        dd[<span class="string">&#x27;J&#x27;</span>] = dd[<span class="string">&#x27;joints&#x27;</span>]</span><br><span class="line">        <span class="keyword">del</span> dd[<span class="string">&#x27;joints&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># defaults</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;bs_style&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> dd:</span><br><span class="line">        dd[<span class="string">&#x27;bs_style&#x27;</span>] = <span class="string">&#x27;lbs&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 准备参数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ready_arguments</span>(<span class="params">fname_or_dict</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(fname_or_dict, <span class="built_in">dict</span>):</span><br><span class="line">        dd = pickle.load(<span class="built_in">open</span>(fname_or_dict))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        dd = fname_or_dict</span><br><span class="line"></span><br><span class="line">    backwards_compatibility_replacements(dd)</span><br><span class="line"></span><br><span class="line">    want_shapemodel = <span class="string">&#x27;shapedirs&#x27;</span> <span class="keyword">in</span> dd</span><br><span class="line">    nposeparms = dd[<span class="string">&#x27;kintree_table&#x27;</span>].shape[<span class="number">1</span>]*<span class="number">3</span> <span class="comment"># 这些不是pose的变量，是关节树</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;trans&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> dd:</span><br><span class="line">        dd[<span class="string">&#x27;trans&#x27;</span>] = np.zeros(<span class="number">3</span>) <span class="comment"># 定义平移量为0 </span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;pose&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> dd:</span><br><span class="line">        dd[<span class="string">&#x27;pose&#x27;</span>] = np.zeros(nposeparms) <span class="comment"># 定义姿势为 0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;shapedirs&#x27;</span> <span class="keyword">in</span> dd <span class="keyword">and</span> <span class="string">&#x27;betas&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> dd:</span><br><span class="line">        dd[<span class="string">&#x27;betas&#x27;</span>] = np.zeros(dd[<span class="string">&#x27;shapedirs&#x27;</span>].shape[-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> [<span class="string">&#x27;v_template&#x27;</span>, <span class="string">&#x27;weights&#x27;</span>, <span class="string">&#x27;posedirs&#x27;</span>, <span class="string">&#x27;pose&#x27;</span>, <span class="string">&#x27;trans&#x27;</span>, <span class="string">&#x27;shapedirs&#x27;</span>, <span class="string">&#x27;betas&#x27;</span>, <span class="string">&#x27;J&#x27;</span>]:</span><br><span class="line">        <span class="keyword">if</span> (s <span class="keyword">in</span> dd) <span class="keyword">and</span> <span class="keyword">not</span> <span class="built_in">hasattr</span>(dd[s], <span class="string">&#x27;dterms&#x27;</span>):</span><br><span class="line">            dd[s] = ch.array(dd[s])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> want_shapemodel: <span class="comment"># 需要形状模型</span></span><br><span class="line">        dd[<span class="string">&#x27;v_shaped&#x27;</span>] = dd[<span class="string">&#x27;shapedirs&#x27;</span>].dot(dd[<span class="string">&#x27;betas&#x27;</span>])+dd[<span class="string">&#x27;v_template&#x27;</span>]</span><br><span class="line">        v_shaped = dd[<span class="string">&#x27;v_shaped&#x27;</span>]</span><br><span class="line">        J_tmpx = MatVecMult(dd[<span class="string">&#x27;J_regressor&#x27;</span>], v_shaped[:,<span class="number">0</span>])        </span><br><span class="line">        J_tmpy = MatVecMult(dd[<span class="string">&#x27;J_regressor&#x27;</span>], v_shaped[:,<span class="number">1</span>])        </span><br><span class="line">        J_tmpz = MatVecMult(dd[<span class="string">&#x27;J_regressor&#x27;</span>], v_shaped[:,<span class="number">2</span>])        </span><br><span class="line">        dd[<span class="string">&#x27;J&#x27;</span>] = ch.vstack((J_tmpx, J_tmpy, J_tmpz)).T    </span><br><span class="line">        dd[<span class="string">&#x27;v_posed&#x27;</span>] = v_shaped + dd[<span class="string">&#x27;posedirs&#x27;</span>].dot(posemap(dd[<span class="string">&#x27;bs_type&#x27;</span>])(dd[<span class="string">&#x27;pose&#x27;</span>]))</span><br><span class="line">    <span class="keyword">else</span>:    </span><br><span class="line">        dd[<span class="string">&#x27;v_posed&#x27;</span>] = dd[<span class="string">&#x27;v_template&#x27;</span>] + dd[<span class="string">&#x27;posedirs&#x27;</span>].dot(posemap(dd[<span class="string">&#x27;bs_type&#x27;</span>])(dd[<span class="string">&#x27;pose&#x27;</span>]))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> dd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_model</span>(<span class="params">fname_or_dict</span>):</span><br><span class="line">    dd = ready_arguments(fname_or_dict)</span><br><span class="line"></span><br><span class="line">    args = &#123;</span><br><span class="line">        <span class="string">&#x27;pose&#x27;</span>: dd[<span class="string">&#x27;pose&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;v&#x27;</span>: dd[<span class="string">&#x27;v_posed&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;J&#x27;</span>: dd[<span class="string">&#x27;J&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;weights&#x27;</span>: dd[<span class="string">&#x27;weights&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;kintree_table&#x27;</span>: dd[<span class="string">&#x27;kintree_table&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;xp&#x27;</span>: ch,</span><br><span class="line">        <span class="string">&#x27;want_Jtr&#x27;</span>: <span class="literal">True</span>,</span><br><span class="line">        <span class="string">&#x27;bs_style&#x27;</span>: dd[<span class="string">&#x27;bs_style&#x27;</span>]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    result, Jtr = verts_core(**args)</span><br><span class="line">    result = result + dd[<span class="string">&#x27;trans&#x27;</span>].reshape((<span class="number">1</span>,<span class="number">3</span>))</span><br><span class="line">    result.J_transformed = Jtr + dd[<span class="string">&#x27;trans&#x27;</span>].reshape((<span class="number">1</span>,<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> dd.items():</span><br><span class="line">        <span class="built_in">setattr</span>(result, k, v)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>

<h2 id="环境配置-SMPL"><a href="#环境配置-SMPL" class="headerlink" title="环境配置(SMPL)"></a>环境配置(SMPL)</h2><p><strong>chumpy安装</strong></p>
<p>pip install chumpy (0.86的chumpy已经支持python3 不需要特别修改代码安装)</p>
<p><strong>python2和python3一些库的名字不同：</strong></p>
<p>例如：no module named cPickle</p>
<p>pickle模块，在ython3中为import pickle，python2中为import cPickle as pickle</p>
<p><strong>opendr 安装</strong></p>
<p><a target="_blank" rel="noopener" href="https://codeload.github.com/polmorenoc/opendr/zip/master">https://codeload.github.com/polmorenoc/opendr/zip/master</a></p>
<ul>
<li>1 python setup.py build</li>
<li>2 python setup.py install</li>
</ul>
<p><strong>OPENGL-python 安装</strong></p>
<p><a target="_blank" rel="noopener" href="https://files.pythonhosted.org/packages/d7/8a/5db9096aa6506e405309c400bd0feb41997689cbba30683479c30dba6355/PyOpenGL-3.1.4.tar.gz">https://files.pythonhosted.org/packages/d7/8a/5db9096aa6506e405309c400bd0feb41997689cbba30683479c30dba6355/PyOpenGL-3.1.4.tar.gz</a></p>
<ul>
<li>1- 解压</li>
<li>2- python setup.py build</li>
<li>3- python setup.py install</li>
</ul>
<h2 id="环境配置Ubuntu（SMPL）"><a href="#环境配置Ubuntu（SMPL）" class="headerlink" title="环境配置Ubuntu（SMPL）"></a>环境配置Ubuntu（SMPL）</h2><p><strong>opendr</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install opendr</span><br></pre></td></tr></table></figure>

<p><strong>Mesa 3D Graphics Library</strong></p>
<p><a target="_blank" rel="noopener" href="https://www.mesa3d.org/osmesa.html">https://www.mesa3d.org/osmesa.html</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install libosmesa6-dev</span><br><span class="line">pip3 install opendr</span><br></pre></td></tr></table></figure>

<p>PyOpenGL </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install  PyOpenGL PyOpenGL_accelerate</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install Bottleneck</span><br></pre></td></tr></table></figure>

<h2 id="c参考资料："><a href="#c参考资料：" class="headerlink" title="c参考资料："></a>c参考资料：</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_28660035/article/details/81319055">SMPL模型改用python3+numpy计算</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/6305f1da8f2d">SMPL: A Skinned Multi-Person Linear Model</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/RdxmOi75glQBKMhKD-APNg">人体模型介绍 - SMPL</a></p>
<h2 id="3D相关学术人员及Blog"><a href="#3D相关学术人员及Blog" class="headerlink" title="3D相关学术人员及Blog"></a>3D相关学术人员及Blog</h2><p>浙大博士 <a target="_blank" rel="noopener" href="https://52zju.cn/?paged=2">https://52zju.cn/?paged=2</a> 三维重建</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/3D-Body/" rel="tag"># 3D Body</a>
              <a href="/tags/SMPL/" rel="tag"># SMPL</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/01/03/CV/CV-Algorithm-SIFT/" rel="prev" title="CV_Algorithm_SIFT">
      <i class="fa fa-chevron-left"></i> CV_Algorithm_SIFT
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/01/07/Paper/Paper-CV-GAN/" rel="next" title="Paper-CV-GAN">
      Paper-CV-GAN <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%BA%E4%BD%933D%E5%BB%BA%E6%A8%A1"><span class="nav-number">1.</span> <span class="nav-text">人体3D建模:</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SMPL-2015"><span class="nav-number">1.1.</span> <span class="nav-text">SMPL 2015</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Official"><span class="nav-number">1.1.1.</span> <span class="nav-text">Official</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SMPL"><span class="nav-number">1.1.2.</span> <span class="nav-text">SMPL</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SMPLify-2016"><span class="nav-number">1.2.</span> <span class="nav-text">SMPLify 2016</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5%EF%BC%9A"><span class="nav-number">1.2.1.</span> <span class="nav-text">项目实践：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SMPL-H%EF%BC%88mano%EF%BC%89-2017"><span class="nav-number">1.3.</span> <span class="nav-text">SMPL-H（mano） 2017</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SMPLX-2019"><span class="nav-number">1.4.</span> <span class="nav-text">SMPLX 2019</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SMPLify-X"><span class="nav-number">1.4.1.</span> <span class="nav-text">SMPLify-X</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AMASS-dataset"><span class="nav-number">1.5.</span> <span class="nav-text">AMASS dataset</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SMPL%E6%A8%A1%E5%9E%8B%E6%BA%90%E7%A0%81-%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D"><span class="nav-number">2.</span> <span class="nav-text">SMPL模型源码&#x2F;项目介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1%E3%80%81posemapper-py"><span class="nav-number">2.1.</span> <span class="nav-text">1、posemapper.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2%E3%80%81LBS-py"><span class="nav-number">2.2.</span> <span class="nav-text">2、LBS.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3%E3%80%81vert-py"><span class="nav-number">2.3.</span> <span class="nav-text">3、vert.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4%E3%80%81serialization-py"><span class="nav-number">2.4.</span> <span class="nav-text">4、serialization.py</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE-SMPL"><span class="nav-number">3.</span> <span class="nav-text">环境配置(SMPL)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AEUbuntu%EF%BC%88SMPL%EF%BC%89"><span class="nav-number">4.</span> <span class="nav-text">环境配置Ubuntu（SMPL）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#c%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99%EF%BC%9A"><span class="nav-number">5.</span> <span class="nav-text">c参考资料：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3D%E7%9B%B8%E5%85%B3%E5%AD%A6%E6%9C%AF%E4%BA%BA%E5%91%98%E5%8F%8ABlog"><span class="nav-number">6.</span> <span class="nav-text">3D相关学术人员及Blog</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Simon Shi</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">322</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">142</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">269</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="mailto:yourname@gmail.com" title="E-Mail → mailto:yourname@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Simon Shi</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  

</body>
</html>
